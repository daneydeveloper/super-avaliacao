/* Minification failed. Returning unminified contents.
(3338,21): run-time error JS1004: Expected ';'
(3338,31-33): run-time error JS1195: Expected expression: ||
(3338,57): run-time error JS1004: Expected ';'
 */
/**----creating head object of name-space----**/

// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site.Config) com.site.Config = {}
else if (typeof com.site.Config != "object")
    throw new Error("com.site.Config already exists and is not an object");

/**----creating head object of name-space end----**/


/**----config URLs starts ----**/
com.site.Config.RequestHandlerUrl = "/RequestHandler.ashx";
com.site.Config.PutRequestHandlerUrl = "/PutRequestHandler.ashx";
com.site.Config.PutRequestHandlerReadUrl = "/PutRRequestHandler.ashx";
com.site.Config.LoginRequestHandlerUrlForBuyer = "/buyer/LoginHandler.ashx";
com.site.Config.LoginRequestHandlerUrlForCharity = "/charity/request/Login";
com.site.Config.OfferIdHashName = "offer";  // hash name for instant offer URL
com.site.Config.MaxMessageLength = 500;   // maximum message length in popup
com.site.Config.MaxVINLength = 17;   // maximum VIN length
com.site.Config.IsConditionModalEnable = true;
com.site.Config.DefaultSellerTimeZone = "CST";  // Set default time-zone as CST. i.e Central Time Zone.
com.site.Config.ENTER_KEY_CODE = 13;
com.site.Config.MakeImagePath = "/Images/carLogo/";
com.site.Config.DefaultMakeImagePath = "/Images/carLogo/car-logo_placeholder.png";
com.site.Config.FacebookAppId = "235924363213204";
com.site.Config.GoogleClientId = "998360456556-4h5vc9kigg5cimq0misnqr0rhogn545b.apps.googleusercontent.com";

// Agent session time out
com.site.Config.AgentSellerSessionTimeout = 15; // Session Time out in Minutes
com.site.Config.TimeOfDisplayWindowBeforeSessionTimeout = 10; // Time in Minutes which display Pop-up window to continue session
com.site.Config.AgentSellerTimeForCheckPerSecond = 60; 
com.site.Config.WindowOpenTime = com.site.Config.AgentSellerSessionTimeout - com.site.Config.TimeOfDisplayWindowBeforeSessionTimeout;
com.site.Config.AgentSessionTimeoutWindowOpen = ""; // This is to hold return value of setTimeout method of JavaScript
com.site.Config.AgentSessionTimeout = "";  // This is to hold return value of setTimeout method of JavaScript
com.site.Config.SellerSessionActive = false;  // This is to set active session of seller when agent is log in as seller.
com.site.Config.AgentSessionTimeoutWindow = "/agent-session-timeout-window";


com.site.Config.PeddleDomainUrl = "www.peddle.com";
com.site.Config.HomeLink = "/";
com.site.Config.VehicleInfoLink = "/sell-car";
com.site.Config.AcceptOfferLink = "/accept-offer";
com.site.Config.CustomerHandlerURL = "/CustomerLogin.ashx";
com.site.Config.LogInLink = "/login";
com.site.Config.CreateAccountLink = "/create-account";
com.site.Config.ForgotPasswordLink = "/forgot-password";
com.site.Config.OfferStatusLink = "/offer-status";
com.site.Config.MyOffersLink = "/my-offers";
com.site.Config.EmailHandlerURL = "/EmailHandler.ashx";
com.site.Config.DocumentGuideLink = "http://guide.peddle.com/home/";
com.site.Config.PartnerLoginURL = "http://www.peddle.com/buyer/login";
com.site.Config.CharityLoginURL = "/charity/login";
com.site.Config.LogoutLink = "/Logout.ashx";
com.site.Config.FacebookURLLink = "//www.facebook.com/peddlepowered";
com.site.Config.TwitterURLLink = "//twitter.com/peddle";
com.site.Config.HelpURLLink = "//help.peddle.com";
com.site.Config.ImageUploadURLLink = "/add-photos";
com.site.Config.VehicleAlreadyExistHandlerURLLink = "/VehicleAlreadyExistHandler.ashx";

com.site.Config.SalesForceURL = "https://na3.salesforce.com/";
com.site.Config.MannualAssignURL = "https://c.na3.visual.force.com/apex/ManualAssignmentFormNavigator";

com.site.Config.SmsParameter = "utm_source=twilio&utm_medium=sms&utm_campaign=seller-sms";
com.site.Config.ShortVINHelpUrl = "http://bit.ly/1v3yQ9U";

com.site.Config.PhoneNumber = "(877) 586-5692";
com.site.Config.AdwordsCTCPeddlePhoneNumber = "(877) 959-6645";
com.site.Config.BingCTCPeddlePhoneNumber = "(877) 958-7911";
com.site.Config.AdwordsCTCJMCPhoneNumber = "(877) 808-5997";
com.site.Config.BingCTCJMCPhoneNumber = "(877) 958-8985â€‹";

/**----config URLs ends ----**/

com.site.Config.colors = [
    "White", "Silver", "Gray", "Charcoal", "Black", "Cream", "Tan", "Beige", "Gold", "Brown", "Yellow", "Orange", "Pink", "Red", "Burgundy", "Maroon", "Purple", "Blue", "Turquoise",
    "Teal", "Green"
];

com.site.Config.OptionalTrimAndVINForPreYear = 1981;
com.site.Config.IsConditionModalForTiresRemovedEnable = true;
com.site.Config.OptimizelyVINExperimentId = 4653392152;
com.site.Config.ExitIntentModalDelay = 0;
com.site.Config.DisplayAddPhotoInManageListing = false;
com.site.Config.DisplayChatIcon = true;
;
/*
 *  jQuery Email Autocomplete - v0.0.2
 *  A jQuery plugin that suggests and autocompletes the domain in email fields.
 *  https://github.com/yzlow/email-autocomplete
 *
 *  Made by Low Yong Zhen <cephyz@gmail.com>
 *  Under MIT License < http://yzlow.mit-license.org>
 */
//"use strict";

(function ($, window, document, undefined) {

  var pluginName = "emailautocomplete";
  var defaults = {
    suggClass: "eac-sugg",
    domains: ["gmail.com" ,"me.com" ,"aol.com" ,"mac.com" ,"live.com" ,"comcast.net" ,"msn.com" ,"facebook.com" ,"verizon.net" ,"sbcglobal.net" ,"att.net"]
  };

  function Plugin(elem, options) {
    this.$field = $(elem);
    this.options = $.extend(true, {}, defaults, options); //we want deep extend
    this._defaults = defaults;
    this._domains = this.options.domains;
    this.init();
  }

  Plugin.prototype = {
	
	resetFieldLeftOffset: function(){
		//get input padding,border and margin to offset text
		this.fieldLeftOffset = (this.$field.outerWidth(true) - this.$field.width()) / 2;
	},
	
    init: function () {

      //shim indexOf
      if (!Array.prototype.indexOf) {
        this.doIndexOf();
      }

      //get input padding,border and margin to offset text
      this.fieldLeftOffset = (this.$field.outerWidth(true) - this.$field.width()) / 2;
		//console.log("this.$field.outerWidth: "+ this.$field.outerWidth(true)+" + this.$field.width(): "+this.$field.width())
      //wrap our field
      var $wrap = $("<div class='eac-input-wrap' />").css({
        display: this.$field.css("display"),
        position: "relative",
        fontSize: this.$field.css("fontSize")
      });
      this.$field.wrap($wrap);

      //create container to test width of current val
      this.$cval = $("<span class='eac-cval' />").css({
        visibility: "hidden",
        position: "absolute",
        display: "inline-block",
        fontFamily: this.$field.css("fontFamily"),
        fontWeight: this.$field.css("fontWeight"),
        letterSpacing: this.$field.css("letterSpacing")
      }).insertAfter(this.$field);

      //create the suggestion overlay
      /* touchstart jquery 1.7+ */
      var heightPad = (this.$field.outerHeight(true) - this.$field.height()) / 2; //padding+border
	  var top = 0;
	  if( (navigator.platform.indexOf("iPhone") != -1) || (navigator.platform.indexOf("iPod") != -1) || (navigator.platform.indexOf("iPad") != -1) || (navigator.platform.indexOf("MacIntel") != -1) ){
		top = -1;
	  }
      this.$suggOverlay = $("<span class='"+this.options.suggClass+"' />").css({
        display: "block",
        "box-sizing": "content-box", //standardize
        lineHeight: this.$field.css('lineHeight'),
        paddingTop: heightPad + "px",
        paddingBottom: heightPad + "px",
        fontFamily: this.$field.css("fontFamily"),
        fontWeight: this.$field.css("fontWeight"),
        letterSpacing: this.$field.css("letterSpacing"),
        position: "absolute",
        top: top,
        left: 0
      }).insertAfter(this.$field);

      //bind events and handlers
      this.$field.on("keyup.eac", $.proxy(this.displaySuggestion, this));

      this.$field.on("keydown.eac", $.proxy(function(e){
        if(e.which === 39 || e.which === 9){
          this.autocomplete();
        }
      }, this));

      this.$suggOverlay.on("mousedown.eac touchstart.eac", $.proxy(this.autocomplete, this));
    },

    suggest: function (str) {
      var str_arr = str.split("@");
      if (str_arr.length > 1) {
        str = str_arr.pop();
        if (!str.length) {
          return "";
        }
      } else {
        return "";
      }
	  str = str.toLowerCase();
      var match = this._domains.filter(function (domain) {
        return 0 === domain.indexOf(str);
      }).shift() || "";

      return match.replace(str, "");
    },

    autocomplete: function () {
      if(typeof this.suggestion === "undefined" || this.suggestion.length < 1){
        return false;
      }
      this.$field.val(this.val + this.suggestion);
      this.$suggOverlay.text("");
      this.$cval.text("");
    },

    /**
     * Displays the suggestion, handler for field keyup event
     */
    displaySuggestion: function (e) {
      this.val = this.$field.val();
      this.suggestion = this.suggest(this.val);

      if (!this.suggestion.length) {
        this.$suggOverlay.text("");
      } else {
        e.preventDefault();
      }

      //update with new suggestion
      this.$suggOverlay.text(this.suggestion);
      this.$cval.text(this.val);

      //find width of current input val so we can offset the suggestion text
      var cvalWidth = this.$cval.width() - 17;

      if(this.$field.outerWidth() > cvalWidth){
        //offset our suggestion container
        this.$suggOverlay.css('left', this.fieldLeftOffset + cvalWidth + "px");
		//console.log('left: fieldLeftOffset' + this.fieldLeftOffset + " + cvalWidth" + cvalWidth );
      }
    },

    /**
     * indexof polyfill
     * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill
    */
    doIndexOf: function(){

        Array.prototype.indexOf = function (searchElement, fromIndex) {
          if ( this === undefined || this === null ) {
            throw new TypeError( '"this" is null or not defined' );
          }

          var length = this.length >>> 0; // Hack to convert object.length to a UInt32

          fromIndex = +fromIndex || 0;

          if (Math.abs(fromIndex) === Infinity) {
            fromIndex = 0;
          }

          if (fromIndex < 0) {
            fromIndex += length;
            if (fromIndex < 0) {
              fromIndex = 0;
            }
          }

          for (;fromIndex < length; fromIndex++) {
            if (this[fromIndex] === searchElement) {
              return fromIndex;
            }
          }

          return -1;
        };
      }
  };

  $.fn[pluginName] = function (options) {
    return this.each(function () {
      if (!$.data(this, "yz_" + pluginName)) {
        $.data(this, "yz_" + pluginName, new Plugin(this, options));
      }
    });
  };

})(jQuery, window, document);
;
/*
* jQuery BlockUI; v20131009
* http://jquery.malsup.com/block/
* Copyright (c) 2013 M. Alsup; Dual licensed: MIT/GPL
*/
(function(){"use strict";function e(e){function o(o,i){var s,h,k=o==window,v=i&&void 0!==i.message?i.message:void 0;if(i=e.extend({},e.blockUI.defaults,i||{}),!i.ignoreIfBlocked||!e(o).data("blockUI.isBlocked")){if(i.overlayCSS=e.extend({},e.blockUI.defaults.overlayCSS,i.overlayCSS||{}),s=e.extend({},e.blockUI.defaults.css,i.css||{}),i.onOverlayClick&&(i.overlayCSS.cursor="pointer"),h=e.extend({},e.blockUI.defaults.themedCSS,i.themedCSS||{}),v=void 0===v?i.message:v,k&&b&&t(window,{fadeOut:0}),v&&"string"!=typeof v&&(v.parentNode||v.jquery)){var y=v.jquery?v[0]:v,m={};e(o).data("blockUI.history",m),m.el=y,m.parent=y.parentNode,m.display=y.style.display,m.position=y.style.position,m.parent&&m.parent.removeChild(y)}e(o).data("blockUI.onUnblock",i.onUnblock);var g,I,w,U,x=i.baseZ;g=r||i.forceIframe?e('<iframe class="blockUI" style="z-index:'+x++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+i.iframeSrc+'"></iframe>'):e('<div class="blockUI" style="display:none"></div>'),I=i.theme?e('<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+x++ +';display:none"></div>'):e('<div class="blockUI blockOverlay" style="z-index:'+x++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),i.theme&&k?(U='<div class="blockUI '+i.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(x+10)+';display:none;position:fixed">',i.title&&(U+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(i.title||"&nbsp;")+"</div>"),U+='<div class="ui-widget-content ui-dialog-content"></div>',U+="</div>"):i.theme?(U='<div class="blockUI '+i.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(x+10)+';display:none;position:absolute">',i.title&&(U+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(i.title||"&nbsp;")+"</div>"),U+='<div class="ui-widget-content ui-dialog-content"></div>',U+="</div>"):U=k?'<div class="blockUI '+i.blockMsgClass+' blockPage" style="z-index:'+(x+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+i.blockMsgClass+' blockElement" style="z-index:'+(x+10)+';display:none;position:absolute"></div>',w=e(U),v&&(i.theme?(w.css(h),w.addClass("ui-widget-content")):w.css(s)),i.theme||I.css(i.overlayCSS),I.css("position",k?"fixed":"absolute"),(r||i.forceIframe)&&g.css("opacity",0);var C=[g,I,w],S=k?e("body"):e(o);e.each(C,function(){this.appendTo(S)}),i.theme&&i.draggable&&e.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var O=f&&(!e.support.boxModel||e("object,embed",k?null:o).length>0);if(u||O){if(k&&i.allowBodyStretch&&e.support.boxModel&&e("html,body").css("height","100%"),(u||!e.support.boxModel)&&!k)var E=d(o,"borderTopWidth"),T=d(o,"borderLeftWidth"),M=E?"(0 - "+E+")":0,B=T?"(0 - "+T+")":0;e.each(C,function(e,o){var t=o[0].style;if(t.position="absolute",2>e)k?t.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+i.quirksmodeOffsetHack+') + "px"'):t.setExpression("height",'this.parentNode.offsetHeight + "px"'),k?t.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):t.setExpression("width",'this.parentNode.offsetWidth + "px"'),B&&t.setExpression("left",B),M&&t.setExpression("top",M);else if(i.centerY)k&&t.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),t.marginTop=0;else if(!i.centerY&&k){var n=i.css&&i.css.top?parseInt(i.css.top,10):0,s="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+n+') + "px"';t.setExpression("top",s)}})}if(v&&(i.theme?w.find(".ui-widget-content").append(v):w.append(v),(v.jquery||v.nodeType)&&e(v).show()),(r||i.forceIframe)&&i.showOverlay&&g.show(),i.fadeIn){var j=i.onBlock?i.onBlock:c,H=i.showOverlay&&!v?j:c,z=v?j:c;i.showOverlay&&I._fadeIn(i.fadeIn,H),v&&w._fadeIn(i.fadeIn,z)}else i.showOverlay&&I.show(),v&&w.show(),i.onBlock&&i.onBlock();if(n(1,o,i),k?(b=w[0],p=e(i.focusableElements,b),i.focusInput&&setTimeout(l,20)):a(w[0],i.centerX,i.centerY),i.timeout){var W=setTimeout(function(){k?e.unblockUI(i):e(o).unblock(i)},i.timeout);e(o).data("blockUI.timeout",W)}}}function t(o,t){var s,l=o==window,a=e(o),d=a.data("blockUI.history"),c=a.data("blockUI.timeout");c&&(clearTimeout(c),a.removeData("blockUI.timeout")),t=e.extend({},e.blockUI.defaults,t||{}),n(0,o,t),null===t.onUnblock&&(t.onUnblock=a.data("blockUI.onUnblock"),a.removeData("blockUI.onUnblock"));var r;r=l?e("body").children().filter(".blockUI").add("body > .blockUI"):a.find(">.blockUI"),t.cursorReset&&(r.length>1&&(r[1].style.cursor=t.cursorReset),r.length>2&&(r[2].style.cursor=t.cursorReset)),l&&(b=p=null),t.fadeOut?(s=r.length,r.stop().fadeOut(t.fadeOut,function(){0===--s&&i(r,d,t,o)})):i(r,d,t,o)}function i(o,t,i,n){var s=e(n);if(!s.data("blockUI.isBlocked")){o.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),t&&t.el&&(t.el.style.display=t.display,t.el.style.position=t.position,t.parent&&t.parent.appendChild(t.el),s.removeData("blockUI.history")),s.data("blockUI.static")&&s.css("position","static"),"function"==typeof i.onUnblock&&i.onUnblock(n,i);var l=e(document.body),a=l.width(),d=l[0].style.width;l.width(a-1).width(a),l[0].style.width=d}}function n(o,t,i){var n=t==window,l=e(t);if((o||(!n||b)&&(n||l.data("blockUI.isBlocked")))&&(l.data("blockUI.isBlocked",o),n&&i.bindEvents&&(!o||i.showOverlay))){var a="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";o?e(document).bind(a,i,s):e(document).unbind(a,s)}}function s(o){if("keydown"===o.type&&o.keyCode&&9==o.keyCode&&b&&o.data.constrainTabKey){var t=p,i=!o.shiftKey&&o.target===t[t.length-1],n=o.shiftKey&&o.target===t[0];if(i||n)return setTimeout(function(){l(n)},10),!1}var s=o.data,a=e(o.target);return a.hasClass("blockOverlay")&&s.onOverlayClick&&s.onOverlayClick(o),a.parents("div."+s.blockMsgClass).length>0?!0:0===a.parents().children().filter("div.blockUI").length}function l(e){if(p){var o=p[e===!0?p.length-1:0];o&&o.focus()}}function a(e,o,t){var i=e.parentNode,n=e.style,s=(i.offsetWidth-e.offsetWidth)/2-d(i,"borderLeftWidth"),l=(i.offsetHeight-e.offsetHeight)/2-d(i,"borderTopWidth");o&&(n.left=s>0?s+"px":"0"),t&&(n.top=l>0?l+"px":"0")}function d(o,t){return parseInt(e.css(o,t),10)||0}e.fn._fadeIn=e.fn.fadeIn;var c=e.noop||function(){},r=/MSIE/.test(navigator.userAgent),u=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);document.documentMode||0;var f=e.isFunction(document.createElement("div").style.setExpression);e.blockUI=function(e){o(window,e)},e.unblockUI=function(e){t(window,e)},e.growlUI=function(o,t,i,n){var s=e('<div class="growlUI"></div>');o&&s.append("<h1>"+o+"</h1>"),t&&s.append("<h2>"+t+"</h2>"),void 0===i&&(i=3e3);var l=function(o){o=o||{},e.blockUI({message:s,fadeIn:o.fadeIn!==void 0?o.fadeIn:700,fadeOut:o.fadeOut!==void 0?o.fadeOut:1e3,timeout:o.timeout!==void 0?o.timeout:i,centerY:!1,showOverlay:!1,onUnblock:n,css:e.blockUI.defaults.growlCSS})};l(),s.css("opacity"),s.mouseover(function(){l({fadeIn:0,timeout:3e4});var o=e(".blockMsg");o.stop(),o.fadeTo(300,1)}).mouseout(function(){e(".blockMsg").fadeOut(1e3)})},e.fn.block=function(t){if(this[0]===window)return e.blockUI(t),this;var i=e.extend({},e.blockUI.defaults,t||{});return this.each(function(){var o=e(this);i.ignoreIfBlocked&&o.data("blockUI.isBlocked")||o.unblock({fadeOut:0})}),this.each(function(){"static"==e.css(this,"position")&&(this.style.position="relative",e(this).data("blockUI.static",!0)),this.style.zoom=1,o(this,t)})},e.fn.unblock=function(o){return this[0]===window?(e.unblockUI(o),this):this.each(function(){t(this,o)})},e.blockUI.version=2.66,e.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var b=null,p=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],e):e(jQuery)})();;
/*!
 * iCheck v0.9.1 jQuery plugin, http://git.io/uhUPMA
 */
(function(f){function C(a,c,d){var b=a[0],e=/er/.test(d)?k:/bl/.test(d)?u:j;active=d==E?{checked:b[j],disabled:b[u],indeterminate:"true"==a.attr(k)||"false"==a.attr(v)}:b[e];if(/^(ch|di|in)/.test(d)&&!active)p(a,e);else if(/^(un|en|de)/.test(d)&&active)w(a,e);else if(d==E)for(var e in active)active[e]?p(a,e,!0):w(a,e,!0);else if(!c||"toggle"==d){if(!c)a[r]("ifClicked");active?b[l]!==x&&w(a,e):p(a,e)}}function p(a,c,d){var b=a[0],e=a.parent(),g=c==j,H=c==k,m=H?v:g?I:"enabled",r=h(b,m+y(b[l])),L=h(b,
c+y(b[l]));if(!0!==b[c]){if(!d&&c==j&&b[l]==x&&b.name){var p=a.closest("form"),s='input[name="'+b.name+'"]',s=p.length?p.find(s):f(s);s.each(function(){this!==b&&f.data(this,n)&&w(f(this),c)})}H?(b[c]=!0,b[j]&&w(a,j,"force")):(d||(b[c]=!0),g&&b[k]&&w(a,k,!1));J(a,g,c,d)}b[u]&&h(b,z,!0)&&e.find("."+F).css(z,"default");e[t](L||h(b,c));e[A](r||h(b,m)||"")}function w(a,c,d){var b=a[0],e=a.parent(),g=c==j,f=c==k,m=f?v:g?I:"enabled",n=h(b,m+y(b[l])),p=h(b,c+y(b[l]));if(!1!==b[c]){if(f||!d||"force"==d)b[c]=
!1;J(a,g,m,d)}!b[u]&&h(b,z,!0)&&e.find("."+F).css(z,"pointer");e[A](p||h(b,c)||"");e[t](n||h(b,m))}function K(a,c){if(f.data(a,n)){var d=f(a);d.parent().html(d.attr("style",f.data(a,n).s||"")[r](c||""));d.off(".i").unwrap();f(D+'[for="'+a.id+'"]').add(d.closest(D)).off(".i")}}function h(a,c,d){if(f.data(a,n))return f.data(a,n).o[c+(d?"":"Class")]}function y(a){return a.charAt(0).toUpperCase()+a.slice(1)}function J(a,c,d,b){if(!b){if(c)a[r]("ifToggled");a[r]("ifChanged")[r]("if"+y(d))}}var n="iCheck",
F=n+"-helper",x="radio",j="checked",I="un"+j,u="disabled",v="determinate",k="in"+v,E="update",l="type",t="addClass",A="removeClass",r="trigger",D="label",z="cursor",G=/ipad|iphone|ipod|android|blackberry|windows phone|opera mini/i.test(navigator.userAgent);f.fn[n]=function(a,c){var d=":checkbox, :"+x,b=f(),e=function(a){a.each(function(){var a=f(this);b=a.is(d)?b.add(a):b.add(a.find(d))})};if(/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(a))return a=a.toLowerCase(),
e(this),b.each(function(){"destroy"==a?K(this,"ifDestroyed"):C(f(this),!0,a);f.isFunction(c)&&c()});if("object"==typeof a||!a){var g=f.extend({checkedClass:j,disabledClass:u,indeterminateClass:k,labelHover:!0},a),h=g.handle,m=g.hoverClass||"hover",y=g.focusClass||"focus",v=g.activeClass||"active",z=!!g.labelHover,s=g.labelHoverClass||"hover",B=(""+g.increaseArea).replace("%","")|0;if("checkbox"==h||h==x)d=":"+h;-50>B&&(B=-50);e(this);return b.each(function(){K(this);var a=f(this),b=this,c=b.id,d=
-B+"%",e=100+2*B+"%",e={position:"absolute",top:d,left:d,display:"block",width:e,height:e,margin:0,padding:0,background:"#fff",border:0,opacity:0},d=G?{position:"absolute",visibility:"hidden"}:B?e:{position:"absolute",opacity:0},h="checkbox"==b[l]?g.checkboxClass||"icheckbox":g.radioClass||"i"+x,k=f(D+'[for="'+c+'"]').add(a.closest(D)),q=a.wrap('<div class="'+h+'"/>')[r]("ifCreated").parent().append(g.insert),e=f('<ins class="'+F+'"/>').css(e).appendTo(q);a.data(n,{o:g,s:a.attr("style")}).css(d);
g.inheritClass&&q[t](b.className);g.inheritID&&c&&q.attr("id",n+"-"+c);"static"==q.css("position")&&q.css("position","relative");C(a,!0,E);if(k.length)k.on("click.i mouseenter.i mouseleave.i touchbegin.i touchend.i",function(c){var d=c[l],e=f(this);if(!b[u])if("click"==d?C(a,!1,!0):z&&(/ve|nd/.test(d)?(q[A](m),e[A](s)):(q[t](m),e[t](s))),G)c.stopPropagation();else return!1});a.on("click.i focus.i blur.i keyup.i keydown.i keypress.i",function(c){var d=c[l];c=c.keyCode;if("click"==d)return!1;if("keydown"==
d&&32==c)return b[l]==x&&b[j]||(b[j]?w(a,j):p(a,j)),!1;if("keyup"==d&&b[l]==x)!b[j]&&p(a,j);else if(/us|ur/.test(d))q["blur"==d?A:t](y)});e.on("click mousedown mouseup mouseover mouseout touchbegin.i touchend.i",function(d){var c=d[l],e=/wn|up/.test(c)?v:m;if(!b[u]){if("click"==c)C(a,!1,!0);else{if(/wn|er|in/.test(c))q[t](e);else q[A](e+" "+v);if(k.length&&z&&e==m)k[/ut|nd/.test(c)?A:t](s)}if(G)d.stopPropagation();else return!1}})})}return this}})(jQuery);;
(function($,window,document){"use strict";var BROWSER_IS_IE7,BROWSER_SCROLLBAR_WIDTH,DOMSCROLL,DOWN,DRAG,KEYDOWN,KEYUP,MOUSEDOWN,MOUSEMOVE,MOUSEUP,MOUSEWHEEL,NanoScroll,PANEDOWN,RESIZE,SCROLL,SCROLLBAR,TOUCHMOVE,UP,WHEEL,cAF,defaults,getBrowserScrollbarWidth,hasTransform,isFFWithBuggyScrollbar,rAF,transform,_elementStyle,_prefixStyle,_vendor;defaults={paneClass:'pane',sliderClass:'slider',contentClass:'content',iOSNativeScrolling:false,preventPageScrolling:false,disableResize:false,alwaysVisible:false,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null};SCROLLBAR='scrollbar';SCROLL='scroll';MOUSEDOWN='mousedown';MOUSEMOVE='mousemove';MOUSEWHEEL='mousewheel';MOUSEUP='mouseup';RESIZE='resize';DRAG='drag';UP='up';PANEDOWN='panedown';DOMSCROLL='DOMMouseScroll';DOWN='down';WHEEL='wheel';KEYDOWN='keydown';KEYUP='keyup';TOUCHMOVE='touchmove';BROWSER_IS_IE7=window.navigator.appName==='Microsoft Internet Explorer'&&/msie 7./i.test(window.navigator.appVersion)&&window.ActiveXObject;BROWSER_SCROLLBAR_WIDTH=null;rAF=window.requestAnimationFrame;cAF=window.cancelAnimationFrame;_elementStyle=document.createElement('div').style;_vendor=(function(){var i,transform,vendor,vendors,_i,_len;vendors=['t','webkitT','MozT','msT','OT'];for(i=_i=0,_len=vendors.length;_i<_len;i=++_i){vendor=vendors[i];transform=vendors[i]+'ransform';if(transform in _elementStyle){return vendors[i].substr(0,vendors[i].length-1);}}
return false;})();_prefixStyle=function(style){if(_vendor===false){return false;}
if(_vendor===''){return style;}
return _vendor+style.charAt(0).toUpperCase()+style.substr(1);};transform=_prefixStyle('transform');hasTransform=transform!==false;getBrowserScrollbarWidth=function(){var outer,outerStyle,scrollbarWidth;outer=document.createElement('div');outerStyle=outer.style;outerStyle.position='absolute';outerStyle.width='100px';outerStyle.height='100px';outerStyle.overflow=SCROLL;outerStyle.top='-9999px';document.body.appendChild(outer);scrollbarWidth=outer.offsetWidth-outer.clientWidth;document.body.removeChild(outer);return scrollbarWidth;};isFFWithBuggyScrollbar=function(){var isOSXFF,ua,version;ua=window.navigator.userAgent;isOSXFF=/(?=.+Mac OS X)(?=.+Firefox)/.test(ua);if(!isOSXFF){return false;}
version=/Firefox\/\d{2}\./.exec(ua);if(version){version=version[0].replace(/\D+/g,'');}
return isOSXFF&&+version>23;};NanoScroll=(function(){function NanoScroll(el,options){this.el=el;this.options=options;BROWSER_SCROLLBAR_WIDTH||(BROWSER_SCROLLBAR_WIDTH=getBrowserScrollbarWidth());this.$el=$(this.el);this.doc=$(this.options.documentContext||document);this.win=$(this.options.windowContext||window);this.$content=this.$el.children("."+options.contentClass);this.$content.attr('tabindex',this.options.tabIndex||0);this.content=this.$content[0];if(this.options.iOSNativeScrolling&&(this.el.style.WebkitOverflowScrolling!=null)){this.nativeScrolling();}else{this.generate();}
this.createEvents();this.addEvents();this.reset();}
NanoScroll.prototype.preventScrolling=function(e,direction){if(!this.isActive){return;}
if(e.type===DOMSCROLL){if(direction===DOWN&&e.originalEvent.detail>0||direction===UP&&e.originalEvent.detail<0){e.preventDefault();}}else if(e.type===MOUSEWHEEL){if(!e.originalEvent||!e.originalEvent.wheelDelta){return;}
if(direction===DOWN&&e.originalEvent.wheelDelta<0||direction===UP&&e.originalEvent.wheelDelta>0){e.preventDefault();}}};NanoScroll.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:'touch'});this.iOSNativeScrolling=true;this.isActive=true;};NanoScroll.prototype.updateScrollValues=function(){var content;content=this.content;this.maxScrollTop=content.scrollHeight-content.clientHeight;this.prevScrollTop=this.contentScrollTop||0;this.contentScrollTop=content.scrollTop;if(!this.iOSNativeScrolling){this.maxSliderTop=this.paneHeight-this.sliderHeight;this.sliderTop=this.maxScrollTop===0?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop;}};NanoScroll.prototype.setOnScrollStyles=function(){var cssValue,_this=this;if(hasTransform){cssValue={};cssValue[transform]="translate(0, "+this.sliderTop+"px)";}else{cssValue={top:this.sliderTop};}
if(rAF){if(!this.scrollRAF){this.scrollRAF=rAF(function(){_this.scrollRAF=null;_this.slider.css(cssValue);});}}else{this.slider.css(cssValue);}};NanoScroll.prototype.createEvents=function(){var _this=this;this.events={down:function(e){_this.isBeingDragged=true;_this.offsetY=e.pageY-_this.slider.offset().top;_this.pane.addClass('active');_this.doc.bind(MOUSEMOVE,_this.events[DRAG]).bind(MOUSEUP,_this.events[UP]);return false;},drag:function(e){_this.sliderY=e.pageY-_this.$el.offset().top-_this.offsetY;_this.scroll();_this.updateScrollValues();if(_this.contentScrollTop>=_this.maxScrollTop&&_this.prevScrollTop!==_this.maxScrollTop){_this.$el.trigger('scrollend');}else if(_this.contentScrollTop===0&&_this.prevScrollTop!==0){_this.$el.trigger('scrolltop');}
return false;},up:function(e){_this.isBeingDragged=false;_this.pane.removeClass('active');_this.doc.unbind(MOUSEMOVE,_this.events[DRAG]).unbind(MOUSEUP,_this.events[UP]);return false;},resize:function(e){_this.reset();},panedown:function(e){_this.sliderY=(e.offsetY||e.originalEvent.layerY)-(_this.sliderHeight*0.5);_this.scroll();_this.events.down(e);return false;},scroll:function(e){if(_this.isBeingDragged){return;}
_this.updateScrollValues();if(!_this.iOSNativeScrolling){_this.sliderY=_this.sliderTop;_this.setOnScrollStyles();}
if(e==null){return;}
if(_this.contentScrollTop>=_this.maxScrollTop){if(_this.options.preventPageScrolling){_this.preventScrolling(e,DOWN);}
if(_this.prevScrollTop!==_this.maxScrollTop){_this.$el.trigger('scrollend');}}else if(_this.contentScrollTop===0){if(_this.options.preventPageScrolling){_this.preventScrolling(e,UP);}
if(_this.prevScrollTop!==0){_this.$el.trigger('scrolltop');}}
if(_this.contentScrollTop<=_this.maxScrollTop){_this.$el.trigger('scrolling',{scroll:_this.contentScrollTop,maxScroll:_this.maxScrollTop,prevScroll:_this.prevScrollTop});}},wheel:function(e){var delta;if(e==null){return;}
delta=e.delta||e.wheelDelta||(e.originalEvent&&e.originalEvent.wheelDelta)||-e.detail||(e.originalEvent&&-e.originalEvent.detail);if(delta){_this.sliderY+=-delta/3;}
_this.scroll();return false;}};};NanoScroll.prototype.addEvents=function(){var events;this.removeEvents();events=this.events;if(!this.options.disableResize){this.win.bind(RESIZE,events[RESIZE]);}
if(!this.iOSNativeScrolling){this.slider.bind(MOUSEDOWN,events[DOWN]);this.pane.bind(MOUSEDOWN,events[PANEDOWN]).bind(""+MOUSEWHEEL+" "+DOMSCROLL,events[WHEEL]);}
this.$content.bind(""+SCROLL+" "+MOUSEWHEEL+" "+DOMSCROLL+" "+TOUCHMOVE,events[SCROLL]);};NanoScroll.prototype.removeEvents=function(){var events;events=this.events;this.win.unbind(RESIZE,events[RESIZE]);if(!this.iOSNativeScrolling){this.slider.unbind();this.pane.unbind();}
this.$content.unbind(""+SCROLL+" "+MOUSEWHEEL+" "+DOMSCROLL+" "+TOUCHMOVE,events[SCROLL]);};NanoScroll.prototype.generate=function(){var contentClass,cssRule,currentPadding,options,paneClass,sliderClass;options=this.options;paneClass=options.paneClass,sliderClass=options.sliderClass,contentClass=options.contentClass;if(!this.$el.find("."+paneClass).length&&!this.$el.find("."+sliderClass).length){this.$el.append("<div class=\""+paneClass+"\"><div class=\""+sliderClass+"\" /></div>");}
this.pane=this.$el.children("."+paneClass);this.slider=this.pane.find("."+sliderClass);if(BROWSER_SCROLLBAR_WIDTH===0&&isFFWithBuggyScrollbar()){currentPadding=window.getComputedStyle(this.content,null).getPropertyValue('padding-right').replace(/\D+/g,'');cssRule={right:-14,paddingRight:+currentPadding+14};}else if(BROWSER_SCROLLBAR_WIDTH){cssRule={right:-BROWSER_SCROLLBAR_WIDTH};this.$el.addClass('has-scrollbar');}
if(cssRule!=null){this.$content.css(cssRule);}
return this;};NanoScroll.prototype.restore=function(){this.stopped=false;if(!this.iOSNativeScrolling){this.pane.show();}
this.addEvents();};NanoScroll.prototype.reset=function(){var content,contentHeight,contentStyle,contentStyleOverflowY,paneBottom,paneHeight,paneOuterHeight,paneTop,parentMaxHeight,sliderHeight;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return;}
if(!this.$el.find("."+this.options.paneClass).length){this.generate().stop();}
if(this.stopped){this.restore();}
content=this.content;contentStyle=content.style;contentStyleOverflowY=contentStyle.overflowY;if(BROWSER_IS_IE7){this.$content.css({height:this.$content.height()});}
contentHeight=content.scrollHeight+BROWSER_SCROLLBAR_WIDTH;parentMaxHeight=parseInt(this.$el.css("max-height"),10);if(parentMaxHeight>0){this.$el.height("");this.$el.height(content.scrollHeight>parentMaxHeight?parentMaxHeight:content.scrollHeight);}
paneHeight=this.pane.outerHeight(false);paneTop=parseInt(this.pane.css('top'),10);paneBottom=parseInt(this.pane.css('bottom'),10);paneOuterHeight=paneHeight+paneTop+paneBottom;sliderHeight=Math.round(paneOuterHeight/contentHeight*paneOuterHeight);if(sliderHeight<this.options.sliderMinHeight){sliderHeight=this.options.sliderMinHeight;}else if((this.options.sliderMaxHeight!=null)&&sliderHeight>this.options.sliderMaxHeight){sliderHeight=this.options.sliderMaxHeight;}
if(contentStyleOverflowY===SCROLL&&contentStyle.overflowX!==SCROLL){sliderHeight+=BROWSER_SCROLLBAR_WIDTH;}
this.maxSliderTop=paneOuterHeight-sliderHeight;this.contentHeight=contentHeight;this.paneHeight=paneHeight;this.paneOuterHeight=paneOuterHeight;this.sliderHeight=sliderHeight;this.slider.height(sliderHeight);this.events.scroll();this.pane.show();this.isActive=true;if((content.scrollHeight===content.clientHeight)||(this.pane.outerHeight(true)>=content.scrollHeight&&contentStyleOverflowY!==SCROLL)){this.pane.hide();this.isActive=false;}else if(this.el.clientHeight===content.scrollHeight&&contentStyleOverflowY===SCROLL){this.slider.hide();}else{this.slider.show();}
this.pane.css({opacity:(this.options.alwaysVisible?1:''),visibility:(this.options.alwaysVisible?'visible':'')});return this;};NanoScroll.prototype.scroll=function(){if(!this.isActive){return;}
this.sliderY=Math.max(0,this.sliderY);this.sliderY=Math.min(this.maxSliderTop,this.sliderY);this.$content.scrollTop((this.paneHeight-this.contentHeight+BROWSER_SCROLLBAR_WIDTH)*this.sliderY/this.maxSliderTop*-1);if(!this.iOSNativeScrolling){this.updateScrollValues();this.setOnScrollStyles();}
return this;};NanoScroll.prototype.scrollBottom=function(offsetY){if(!this.isActive){return;}
this.reset();this.$content.scrollTop(this.contentHeight-this.$content.height()-offsetY).trigger(MOUSEWHEEL);return this;};NanoScroll.prototype.scrollTop=function(offsetY){if(!this.isActive){return;}
this.reset();this.$content.scrollTop(+offsetY).trigger(MOUSEWHEEL);return this;};NanoScroll.prototype.scrollTo=function(node){if(!this.isActive){return;}
this.reset();this.scrollTop($(node).get(0).offsetTop);return this;};NanoScroll.prototype.stop=function(){if(cAF){cAF(this.scrollRAF);}
this.stopped=true;this.removeEvents();if(!this.iOSNativeScrolling){this.pane.hide();}
return this;};NanoScroll.prototype.destroy=function(){if(!this.stopped){this.stop();}
if(!this.iOSNativeScrolling&&this.pane.length){this.pane.remove();}
if(BROWSER_IS_IE7){this.$content.height('');}
this.$content.removeAttr('tabindex');if(this.$el.hasClass('has-scrollbar')){this.$el.removeClass('has-scrollbar');this.$content.css({right:''});}
return this;};NanoScroll.prototype.flash=function(){var _this=this;if(this.iOSNativeScrolling){return;}
if(!this.isActive){return;}
this.reset();this.pane.addClass('flashed');setTimeout(function(){_this.pane.removeClass('flashed');},this.options.flashDelay);return this;};return NanoScroll;})();$.fn.nanoScroller=function(settings){return this.each(function(){var options,scrollbar;if(!(scrollbar=this.nanoscroller)){options=$.extend({},defaults,settings);this.nanoscroller=scrollbar=new NanoScroll(this,options);}
if(settings&&typeof settings==="object"){$.extend(scrollbar.options,settings);if(settings.scrollBottom){return scrollbar.scrollBottom(settings.scrollBottom);}
if(settings.scrollTop){return scrollbar.scrollTop(settings.scrollTop);}
if(settings.scrollTo){return scrollbar.scrollTo(settings.scrollTo);}
if(settings.scroll==='bottom'){return scrollbar.scrollBottom(0);}
if(settings.scroll==='top'){return scrollbar.scrollTop(0);}
if(settings.scroll&&settings.scroll instanceof $){return scrollbar.scrollTo(settings.scroll);}
if(settings.stop){return scrollbar.stop();}
if(settings.destroy){return scrollbar.destroy();}
if(settings.flash){return scrollbar.flash();}}
return scrollbar.reset();});};$.fn.nanoScroller.Constructor=NanoScroll;})(jQuery,window,document);;
  /**
 * Display interactive character limit feedback for text field or text area.
 * see https://github.com/ndp/show_char_limit
 * License: apache 2.0
 */
(function($) {

  function ensureElementHasId($this) {
    if ($this.attr('id') == '') {
      var id = "" + Math.floor(Math.random() * 9999999999);
      $this.attr('id', id);
    }
  }

  // Allows individual elements to override a provided default
  function calcMaxLength($this, defaultMaxLength) {
    var maxLen = $this.attr('maxlength');
    if (!maxLen || maxLen == "" || maxLen == -1 || maxLen > 500000) {
      maxLen = defaultMaxLength;
    }
    return maxLen;
  }


  function generateMessage(style, currLen, charsLeft) {
    var msg;
    if (style == 'chars_typed') {
      msg = "" + currLen;
    } else if (style == 'chars_left') {
      msg = "" + charsLeft;
    } else {
  
      // var status = charsLeft >= 0 ? 'remaining' : 'over';
      // var unit = (Math.abs(charsLeft) != 1 ? "Characters" : "Character");
      // msg =  unit + " " + status + ": " + com.site.Util.add_commas(Math.abs(charsLeft));
      msg =  com.site.Util.add_commas(Math.abs(charsLeft));
    
    }
    return msg;
  }


  $.fn.showCharLimit = function(limitOrOptions, options) {

    if (!options) options = {};

    // if provided max_length, save it
    if (typeof limitOrOptions === 'number') {
      options['maxlength'] = limitOrOptions
    } else {
      options = limitOrOptions || {}
    }

    var o = $.extend({
      error_class: 'error',
      status_style: 'text',
      status_element_suffix: '__status'
    }, options);


    $(this).bind('showLimit', function() {

      var $this = $(this);

      var currLen = $this.val().length;

      var maxLen = calcMaxLength($this, o['maxlength']);
      var charsLeft = maxLen - currLen;

      var statusElem = o.status_element ? o.status_element : ("#" + $this.attr('id') + o.status_element_suffix);
      if ($(statusElem).size() == 0) {
        ensureElementHasId($this);
        statusElem = '#' + $this.attr('id') + o.status_element_suffix;
        $this.after('<span class="status" id="' + $this.attr('id') + o.status_element_suffix + '"></span>');
      }
      $(statusElem).html(generateMessage(o.status_style, currLen, charsLeft));

      if (o.error_element || o.error_element_suffix) {
        var e = o.error_element ? o.error_element : ("#" + $this.attr('id') + o.error_element_suffix);
        $(e).toggleClass(o.error_class, charsLeft < 0);
      }
      $this.trigger((charsLeft < 0) ? 'validationError' : 'validationOk');
    });

    return this.each(function() {
      $(this).trigger('showLimit');
      $(this).keyup(function() {
        $(this).trigger('showLimit');
      });
    });
  };

  $.fn.show_char_limit = $.fn.showCharLimit; // backward compatible


})(jQuery);;
/* ===========================================================
 * bootstrap-modalmanager.js v2.2.0
 * ===========================================================
 * Copyright 2012 Jordan Schroter.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

!function ($) {

	"use strict"; // jshint ;_;

	/* MODAL MANAGER CLASS DEFINITION
	* ====================== */

	var ModalManager = function (element, options) {
		this.init(element, options);
	};

	ModalManager.prototype = {

		constructor: ModalManager,

		init: function (element, options) {
			this.$element = $(element);
			this.options = $.extend({}, $.fn.modalmanager.defaults, this.$element.data(), typeof options == 'object' && options);
			this.stack = [];
			this.backdropCount = 0;

			if (this.options.resize) {
				var resizeTimeout,
					that = this;

				$(window).on('resize.modal', function(){
					resizeTimeout && clearTimeout(resizeTimeout);
					resizeTimeout = setTimeout(function(){
						for (var i = 0; i < that.stack.length; i++){
							that.stack[i].isShown && that.stack[i].layout();
						}
					}, 10);
				});
			}
		},

		createModal: function (element, options) {
			$(element).modal($.extend({ manager: this }, options));
		},

		appendModal: function (modal) {
			this.stack.push(modal);

			var that = this;

			modal.$element.on('show.modalmanager', targetIsSelf(function (e) {

				var showModal = function(){
					modal.isShown = true;

					var transition = $.support.transition && modal.$element.hasClass('fade');

					that.$element
						.toggleClass('modal-open', that.hasOpenModal())
						.toggleClass('page-overflow', $(window).height() < that.$element.height());

					modal.$parent = modal.$element.parent();

					modal.$container = that.createContainer(modal);

					modal.$element.appendTo(modal.$container);

					that.backdrop(modal, function () {
						modal.$element.show();

						if (transition) {       
							//modal.$element[0].style.display = 'run-in';       
							modal.$element[0].offsetWidth;
							//modal.$element.one($.support.transition.end, function () { modal.$element[0].style.display = 'block' });  
						}
						
						modal.layout();

						modal.$element
							.addClass('in')
							.attr('aria-hidden', false);

						var complete = function () {
							that.setFocus();
							modal.$element.trigger('shown');
						};

						transition ?
							modal.$element.one($.support.transition.end, complete) :
							complete();
					});
				};

				modal.options.replace ?
					that.replace(showModal) :
					showModal();
			}));

			modal.$element.on('hidden.modalmanager', targetIsSelf(function (e) {

				that.backdrop(modal);
				if (modal.$backdrop){
					var transition = $.support.transition && modal.$element.hasClass('fade');

					// trigger a relayout due to firebox's buggy transition end event 
					if (transition) { modal.$element[0].offsetWidth; }

					$.support.transition && modal.$element.hasClass('fade') ?
						modal.$backdrop.one($.support.transition.end, function () { that.destroyModal(modal) }) :
						that.destroyModal(modal);
				} else {
					that.destroyModal(modal);
				}

			}));

			modal.$element.on('destroy.modalmanager', targetIsSelf(function (e) {
				that.removeModal(modal);
			}));

		},

		destroyModal: function (modal) {
			modal.destroy();

			var hasOpenModal = this.hasOpenModal();

			this.$element.toggleClass('modal-open', hasOpenModal);

			if (!hasOpenModal){
				this.$element.removeClass('page-overflow');
			}

			this.removeContainer(modal);

			this.setFocus();
		},

		getOpenModals: function () {
			var openModals = [];
			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) openModals.push(this.stack[i]);
			}

			return openModals;
		},

		hasOpenModal: function () {
			return this.getOpenModals().length > 0;
		},

		setFocus: function () {
			var topModal;

			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) topModal = this.stack[i];
			}

			if (!topModal) return;

			topModal.focus();

		},

		removeModal: function (modal) {
			modal.$element.off('.modalmanager');
			if (modal.$backdrop) this.removeBackdrop(modal);
			this.stack.splice(this.getIndexOfModal(modal), 1);
		},

		getModalAt: function (index) {
			return this.stack[index];
		},

		getIndexOfModal: function (modal) {
			for (var i = 0; i < this.stack.length; i++){
				if (modal === this.stack[i]) return i;
			}
		},

		replace: function (callback) {
			var topModal;

			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) topModal = this.stack[i];
			}

			if (topModal) {
				this.$backdropHandle = topModal.$backdrop;
				topModal.$backdrop = null;

				callback && topModal.$element.one('hidden',
					targetIsSelf( $.proxy(callback, this) ));

				topModal.hide();
			} else if (callback) {
				callback();
			}
		},

		removeBackdrop: function (modal) {
			modal.$backdrop.remove();
			modal.$backdrop = null;
		},

		createBackdrop: function (animate, tmpl) {
			var $backdrop;

			if (!this.$backdropHandle) {
				$backdrop = $(tmpl)
					.addClass(animate)
					.appendTo(this.$element);
			} else {
				$backdrop = this.$backdropHandle;
				$backdrop.off('.modalmanager');
				this.$backdropHandle = null;
				this.isLoading && this.removeSpinner();
			}

			return $backdrop;
		},

		removeContainer: function (modal) {
			modal.$container.remove();
			modal.$container = null;
		},

		createContainer: function (modal) {
			var $container;

			$container = $('<div class="modal-scrollable">')
				.css('z-index', getzIndex('modal', this.getOpenModals().length))
				.appendTo(this.$element);

			if (modal && modal.options.backdrop != 'static') {
				$container.on('click.modal', targetIsSelf(function (e) {
					modal.hide();
				}));
			} else if (modal) {
				$container.on('click.modal', targetIsSelf(function (e) {
					modal.attention();
				}));
			}

			return $container;

		},

		backdrop: function (modal, callback) {
			var animate = modal.$element.hasClass('fade') ? 'fade' : '',
				showBackdrop = modal.options.backdrop &&
					this.backdropCount < this.options.backdropLimit;

			if (modal.isShown && showBackdrop) {
				var doAnimate = $.support.transition && animate && !this.$backdropHandle;

				modal.$backdrop = this.createBackdrop(animate, modal.options.backdropTemplate);

				modal.$backdrop.css('z-index', getzIndex( 'backdrop', this.getOpenModals().length ));

				if (doAnimate) modal.$backdrop[0].offsetWidth; // force reflow

				modal.$backdrop.addClass('in');

				this.backdropCount += 1;

				doAnimate ?
					modal.$backdrop.one($.support.transition.end, callback) :
					callback();

			} else if (!modal.isShown && modal.$backdrop) {
				modal.$backdrop.removeClass('in');

				this.backdropCount -= 1;

				var that = this;

				$.support.transition && modal.$element.hasClass('fade')?
					modal.$backdrop.one($.support.transition.end, function () { that.removeBackdrop(modal) }) :
					that.removeBackdrop(modal);

			} else if (callback) {
				callback();
			}
		},

		removeSpinner: function(){
			this.$spinner && this.$spinner.remove();
			this.$spinner = null;
			this.isLoading = false;
		},

		removeLoading: function () {
			this.$backdropHandle && this.$backdropHandle.remove();
			this.$backdropHandle = null;
			this.removeSpinner();
		},

		loading: function (callback) {
			callback = callback || function () { };

			this.$element
				.toggleClass('modal-open', !this.isLoading || this.hasOpenModal())
				.toggleClass('page-overflow', $(window).height() < this.$element.height());

			if (!this.isLoading) {

				this.$backdropHandle = this.createBackdrop('fade', this.options.backdropTemplate);

				this.$backdropHandle[0].offsetWidth; // force reflow

				var openModals = this.getOpenModals();

				this.$backdropHandle
					.css('z-index', getzIndex('backdrop', openModals.length + 1))
					.addClass('in');

				var $spinner = $(this.options.spinner)
					.css('z-index', getzIndex('modal', openModals.length + 1))
					.appendTo(this.$element)
					.addClass('in');

				this.$spinner = $(this.createContainer())
					.append($spinner)
					.on('click.modalmanager', $.proxy(this.loading, this));

				this.isLoading = true;

				$.support.transition ?
					this.$backdropHandle.one($.support.transition.end, callback) :
					callback();

			} else if (this.isLoading && this.$backdropHandle) {
				this.$backdropHandle.removeClass('in');

				var that = this;
				$.support.transition ?
					this.$backdropHandle.one($.support.transition.end, function () { that.removeLoading() }) :
					that.removeLoading();

			} else if (callback) {
				callback(this.isLoading);
			}
		}
	};

	/* PRIVATE METHODS
	* ======================= */

	// computes and caches the zindexes
	var getzIndex = (function () {
		var zIndexFactor,
			baseIndex = {};

		return function (type, pos) {

			if (typeof zIndexFactor === 'undefined'){
				var $baseModal = $('<div class="modal hide" />').appendTo('body'),
					$baseBackdrop = $('<div class="modal-backdrop hide" />').appendTo('body');

				baseIndex['modal'] = +$baseModal.css('z-index');
				baseIndex['backdrop'] = +$baseBackdrop.css('z-index');
				zIndexFactor = baseIndex['modal'] - baseIndex['backdrop'];

				$baseModal.remove();
				$baseBackdrop.remove();
				$baseBackdrop = $baseModal = null;
			}

			return baseIndex[type] + (zIndexFactor * pos);

		}
	}());

	// make sure the event target is the modal itself in order to prevent
	// other components such as tabsfrom triggering the modal manager.
	// if Boostsrap namespaced events, this would not be needed.
	function targetIsSelf(callback){
		return function (e) {
			if (this === e.target){
				return callback.apply(this, arguments);
			}
		}
	}


	/* MODAL MANAGER PLUGIN DEFINITION
	* ======================= */

	$.fn.modalmanager = function (option, args) {
		return this.each(function () {
			var $this = $(this),
				data = $this.data('modalmanager');

			if (!data) $this.data('modalmanager', (data = new ModalManager(this, option)));
			if (typeof option === 'string') data[option].apply(data, [].concat(args))
		})
	};

	$.fn.modalmanager.defaults = {
		backdropLimit: 999,
		resize: true,
		spinner: '<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',
		backdropTemplate: '<div class="modal-backdrop" />'
	};

	$.fn.modalmanager.Constructor = ModalManager

}(jQuery);
;
/* ===========================================================
 * bootstrap-modal.js v2.2.0
 * ===========================================================
 * Copyright 2012 Jordan Schroter
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

	"use strict"; // jshint ;_;

	/* MODAL CLASS DEFINITION
	* ====================== */

	var Modal = function (element, options) {
		this.init(element, options);
	};

	Modal.prototype = {

		constructor: Modal,

		init: function (element, options) {
			var that = this;

			this.options = options;

			this.$element = $(element)
				.delegate('[data-dismiss="modal"]', 'click.dismiss.modal', $.proxy(this.hide, this));

			this.options.remote && this.$element.find('.modal-body').load(this.options.remote, function () {
				var e = $.Event('loaded');
				that.$element.trigger(e);
			});

			var manager = typeof this.options.manager === 'function' ?
				this.options.manager.call(this) : this.options.manager;

			manager = manager.appendModal ?
				manager : $(manager).modalmanager().data('modalmanager');

			manager.appendModal(this);
		},

		toggle: function () {
			return this[!this.isShown ? 'show' : 'hide']();
		},

		show: function () {
			var e = $.Event('show');

			if (this.isShown) return;

			this.$element.trigger(e);

			if (e.isDefaultPrevented()) return;

			this.escape();

			this.tab();

			this.options.loading && this.loading();
		},

		hide: function (e) {
			e && e.preventDefault();

			e = $.Event('hide');

			this.$element.trigger(e);

			if (!this.isShown || e.isDefaultPrevented()) return (this.isShown = false);

			this.isShown = false;

			this.escape();

			this.tab();

			this.isLoading && this.loading();

			$(document).off('focusin.modal');

			this.$element
				.removeClass('in')
				.removeClass('animated')
				.removeClass(this.options.attentionAnimation)
				.removeClass('modal-overflow')
				.attr('aria-hidden', true);

			$.support.transition && this.$element.hasClass('fade') ?
				this.hideWithTransition() :
				this.hideModal();
		},

		layout: function () {
			var prop = this.options.height ? 'height' : 'max-height',
				value = this.options.height || this.options.maxHeight;

			if (this.options.width){
				this.$element.css('width', this.options.width);

				var that = this;
				this.$element.css('margin-left', function () {
					if (/%/ig.test(that.options.width)){
						return -(parseInt(that.options.width) / 2) + '%';
					} else {
						return -($(this).width() / 2) + 'px';
					}
				});
			} else {
				this.$element.css('width', '');
				this.$element.css('margin-left', '');
			}

			this.$element.find('.modal-body')
				.css('overflow', '')
				.css(prop, '');

			if (value){
				this.$element.find('.modal-body')
					.css('overflow', 'auto')
					.css(prop, value);
			}

			var modalOverflow = $(window).height() - 10 < this.$element.height();
            
			if (modalOverflow || this.options.modalOverflow) {
				this.$element
					.css('margin-top', 0)
					.addClass('modal-overflow');
			} else {
				this.$element
					.css('margin-top', 0 - this.$element.height() / 2)
					.removeClass('modal-overflow');
			}
		},

		tab: function () {
			var that = this;

			if (this.isShown && this.options.consumeTab) {
				this.$element.on('keydown.tabindex.modal', '[data-tabindex]', function (e) {
			    	if (e.keyCode && e.keyCode == 9){
						var $next = $(this),
							$rollover = $(this);

						that.$element.find('[data-tabindex]:enabled:not([readonly])').each(function (e) {
							if (!e.shiftKey){
						 		$next = $next.data('tabindex') < $(this).data('tabindex') ?
									$next = $(this) :
									$rollover = $(this);
							} else {
								$next = $next.data('tabindex') > $(this).data('tabindex') ?
									$next = $(this) :
									$rollover = $(this);
							}
						});

						$next[0] !== $(this)[0] ?
							$next.focus() : $rollover.focus();

						e.preventDefault();
					}
				});
			} else if (!this.isShown) {
				this.$element.off('keydown.tabindex.modal');
			}
		},

		escape: function () {
			var that = this;
			if (this.isShown && this.options.keyboard) {
				if (!this.$element.attr('tabindex')) this.$element.attr('tabindex', -1);

				this.$element.on('keyup.dismiss.modal', function (e) {
					e.which == 27 && that.hide();
				});
			} else if (!this.isShown) {
				this.$element.off('keyup.dismiss.modal')
			}
		},

		hideWithTransition: function () {
			var that = this
				, timeout = setTimeout(function () {
					that.$element.off($.support.transition.end);
					that.hideModal();
				}, 500);

			this.$element.one($.support.transition.end, function () {
				clearTimeout(timeout);
				that.hideModal();
			});
		},

		hideModal: function () {
			var prop = this.options.height ? 'height' : 'max-height';
			var value = this.options.height || this.options.maxHeight;

			if (value){
				this.$element.find('.modal-body')
					.css('overflow', '')
					.css(prop, '');
			}

			this.$element
				.hide()
				.trigger('hidden');
		},

		removeLoading: function () {
			this.$loading.remove();
			this.$loading = null;
			this.isLoading = false;
		},

		loading: function (callback) {
			callback = callback || function () {};

			var animate = this.$element.hasClass('fade') ? 'fade' : '';

			if (!this.isLoading) {
				var doAnimate = $.support.transition && animate;

				this.$loading = $('<div class="loading-mask ' + animate + '">')
					.append(this.options.spinner)
					.appendTo(this.$element);

				if (doAnimate) this.$loading[0].offsetWidth; // force reflow

				this.$loading.addClass('in');

				this.isLoading = true;

				doAnimate ?
					this.$loading.one($.support.transition.end, callback) :
					callback();

			} else if (this.isLoading && this.$loading) {
				this.$loading.removeClass('in');

				var that = this;
				$.support.transition && this.$element.hasClass('fade')?
					this.$loading.one($.support.transition.end, function () { that.removeLoading() }) :
					that.removeLoading();

			} else if (callback) {
				callback(this.isLoading);
			}
		},

		focus: function () {
			var $focusElem = this.$element.find(this.options.focusOn);

			$focusElem = $focusElem.length ? $focusElem : this.$element;

			$focusElem.focus();
		},

		attention: function (){
			// NOTE: transitionEnd with keyframes causes odd behaviour

			if (this.options.attentionAnimation){
				this.$element
					.removeClass('animated')
					.removeClass(this.options.attentionAnimation);

				var that = this;

				setTimeout(function () {
					that.$element
						.addClass('animated')
						.addClass(that.options.attentionAnimation);
				}, 0);
			}


			this.focus();
		},


		destroy: function () {
			var e = $.Event('destroy');
			this.$element.trigger(e);
			if (e.isDefaultPrevented()) return;

			this.teardown();
		},

		teardown: function () {
			if (!this.$parent.length){
				this.$element.remove();
				this.$element = null;
				return;
			}

			if (this.$parent !== this.$element.parent()){
				this.$element.appendTo(this.$parent);
			}

			this.$element.off('.modal');
			this.$element.removeData('modal');
			this.$element
				.removeClass('in')
				.attr('aria-hidden', true);
		}
	};


	/* MODAL PLUGIN DEFINITION
	* ======================= */

	$.fn.modal = function (option, args) {
		return this.each(function () {
			var $this = $(this),
				data = $this.data('modal'),
				options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option);

			if (!data) $this.data('modal', (data = new Modal(this, options)));
			if (typeof option == 'string') data[option].apply(data, [].concat(args));
			else if (options.show) data.show()
		})
	};

	$.fn.modal.defaults = {
		keyboard: true,
		backdrop: true,
		loading: false,
		show: true,
		width: null,
		height: null,
		maxHeight: null,
		modalOverflow: false,
		consumeTab: true,
		focusOn: null,
		replace: false,
		resize: false,
		attentionAnimation: 'shake',
		manager: 'body',
		spinner: '<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',
		backdropTemplate: '<div class="modal-backdrop" />'
	};

	$.fn.modal.Constructor = Modal;


	/* MODAL DATA-API
	* ============== */

	$(function () {
		$(document).off('click.modal').on('click.modal.data-api', '[data-toggle="modal"]', function ( e ) {
			var $this = $(this),
				href = $this.attr('href'),
				$target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\s]+$)/, ''))), //strip for ie7
				option = $target.data('modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data());

			e.preventDefault();
			$target
				.modal(option)
				.one('hide', function () {
					$this.focus();
				})
		});
	});

}(window.jQuery);
;
/*! Overthrow. An overflow:auto polyfill for responsive design. (c) 2012: Scott Jehl, Filament Group, Inc. http://filamentgroup.github.com/Overthrow/license.txt */
(function( w, undefined ){
	
	var doc = w.document,
		docElem = doc.documentElement,
		enabledClassName = "overthrow-enabled",

		// Touch events are used in the polyfill, and thus are a prerequisite
		canBeFilledWithPoly = "ontouchmove" in doc,
		
		// The following attempts to determine whether the browser has native overflow support
		// so we can enable it but not polyfill
		nativeOverflow = 
			// Features-first. iOS5 overflow scrolling property check - no UA needed here. thanks Apple :)
			"WebkitOverflowScrolling" in docElem.style ||
			// Test the windows scrolling property as well
			"msOverflowStyle" in docElem.style ||
			// Touch events aren't supported and screen width is greater than X
			// ...basically, this is a loose "desktop browser" check. 
			// It may wrongly opt-in very large tablets with no touch support.
			( !canBeFilledWithPoly && w.screen.width > 800 ) ||
			// Hang on to your hats.
			// Whitelist some popular, overflow-supporting mobile browsers for now and the future
			// These browsers are known to get overlow support right, but give us no way of detecting it.
			(function(){
				var ua = w.navigator.userAgent,
					// Webkit crosses platforms, and the browsers on our list run at least version 534
					webkit = ua.match( /AppleWebKit\/([0-9]+)/ ),
					wkversion = webkit && webkit[1],
					wkLte534 = webkit && wkversion >= 534;
					
				return (
					/* Android 3+ with webkit gte 534
					~: Mozilla/5.0 (Linux; U; Android 3.0; en-us; Xoom Build/HRI39) AppleWebKit/534.13 (KHTML, like Gecko) Version/4.0 Safari/534.13 */
					ua.match( /Android ([0-9]+)/ ) && RegExp.$1 >= 3 && wkLte534 ||
					/* Blackberry 7+ with webkit gte 534
					~: Mozilla/5.0 (BlackBerry; U; BlackBerry 9900; en-US) AppleWebKit/534.11+ (KHTML, like Gecko) Version/7.0.0 Mobile Safari/534.11+ */
					ua.match( / Version\/([0-9]+)/ ) && RegExp.$1 >= 0 && w.blackberry && wkLte534 ||
					/* Blackberry Playbook with webkit gte 534
					~: Mozilla/5.0 (PlayBook; U; RIM Tablet OS 1.0.0; en-US) AppleWebKit/534.8+ (KHTML, like Gecko) Version/0.0.1 Safari/534.8+ */   
					ua.indexOf( "PlayBook" ) > -1 && wkLte534 && !ua.indexOf( "Android 2" ) === -1 ||
					/* Firefox Mobile (Fennec) 4 and up
					~: Mozilla/5.0 (Mobile; rv:15.0) Gecko/15.0 Firefox/15.0 */
					ua.match(/Firefox\/([0-9]+)/) && RegExp.$1 >= 4 ||
					/* WebOS 3 and up (TouchPad too)
					~: Mozilla/5.0 (hp-tablet; Linux; hpwOS/3.0.0; U; en-US) AppleWebKit/534.6 (KHTML, like Gecko) wOSBrowser/233.48 Safari/534.6 TouchPad/1.0 */
					ua.match( /wOSBrowser\/([0-9]+)/ ) && RegExp.$1 >= 233 && wkLte534 ||
					/* Nokia Browser N8
					~: Mozilla/5.0 (Symbian/3; Series60/5.2 NokiaN8-00/012.002; Profile/MIDP-2.1 Configuration/CLDC-1.1 ) AppleWebKit/533.4 (KHTML, like Gecko) NokiaBrowser/7.3.0 Mobile Safari/533.4 3gpp-gba 
					~: Note: the N9 doesn't have native overflow with one-finger touch. wtf */
					ua.match( /NokiaBrowser\/([0-9\.]+)/ ) && parseFloat(RegExp.$1) === 7.3 && webkit && wkversion >= 533
				);
			})();

	// Expose overthrow API
	w.overthrow = {};

	w.overthrow.enabledClassName = enabledClassName;

	w.overthrow.addClass = function(){
		if( docElem.className.indexOf( w.overthrow.enabledClassName ) === -1 ){
			docElem.className += " " + w.overthrow.enabledClassName;
		}
	};

	w.overthrow.removeClass = function(){
		docElem.className = docElem.className.replace( w.overthrow.enabledClassName, "" );
	};

	// Enable and potentially polyfill overflow
	w.overthrow.set = function(){
			
		// If nativeOverflow or at least the element canBeFilledWithPoly, add a class to cue CSS that assumes overflow scrolling will work (setting height on elements and such)
		if( nativeOverflow ){
			w.overthrow.addClass();
		}

	};

	// expose polyfillable 
	w.overthrow.canBeFilledWithPoly = canBeFilledWithPoly;

	// Destroy everything later. If you want to.
	w.overthrow.forget = function(){

		w.overthrow.removeClass();
		
	};
		
	// Expose overthrow API
	w.overthrow.support = nativeOverflow ? "native" : "none";
		
})( this );
;
/*! Overthrow. An overflow:auto polyfill for responsive design. (c) 2012: Scott Jehl, Filament Group, Inc. http://filamentgroup.github.com/Overthrow/license.txt */
(function( w, o, undefined ){

	// o is overthrow reference from overthrow-polyfill.js
	if( o === undefined ){
		return;
	}

	o.scrollIndicatorClassName = "overthrow";
	
	var doc = w.document,
		docElem = doc.documentElement,
		// o api
		nativeOverflow = o.support === "native",
		canBeFilledWithPoly = o.canBeFilledWithPoly,
		configure = o.configure,
		set = o.set,
		forget = o.forget,
		scrollIndicatorClassName = o.scrollIndicatorClassName;

	// find closest overthrow (elem or a parent)
	o.closest = function( target, ascend ){
		return !ascend && target.className && target.className.indexOf( scrollIndicatorClassName ) > -1 && target || o.closest( target.parentNode );
	};
		
	// polyfill overflow
	var enabled = false;
	o.set = function(){
			
		set();

		// If nativeOverflow or it doesn't look like the browser canBeFilledWithPoly, our job is done here. Exit viewport left.
		if( enabled || nativeOverflow || !canBeFilledWithPoly ){
			return;
		}

		w.overthrow.addClass();

		enabled = true;

		o.support = "polyfilled";

		o.forget = function(){
			forget();
			enabled = false;
			// Remove touch binding (check for method support since this part isn't qualified by touch support like the rest)
			if( doc.removeEventListener ){
				doc.removeEventListener( "touchstart", start, false );
			}
		};

		// Fill 'er up!
		// From here down, all logic is associated with touch scroll handling
			// elem references the overthrow element in use
		var elem,
			
			// The last several Y values are kept here
			lastTops = [],
	
			// The last several X values are kept here
			lastLefts = [],
			
			// lastDown will be true if the last scroll direction was down, false if it was up
			lastDown,
			
			// lastRight will be true if the last scroll direction was right, false if it was left
			lastRight,
			
			// For a new gesture, or change in direction, reset the values from last scroll
			resetVertTracking = function(){
				lastTops = [];
				lastDown = null;
			},
			
			resetHorTracking = function(){
				lastLefts = [];
				lastRight = null;
			},
		
			// On webkit, touch events hardly trickle through textareas and inputs
			// Disabling CSS pointer events makes sure they do, but it also makes the controls innaccessible
			// Toggling pointer events at the right moments seems to do the trick
			// Thanks Thomas Bachem http://stackoverflow.com/a/5798681 for the following
			inputs,
			setPointers = function( val ){
				inputs = elem.querySelectorAll( "textarea, input" );
				for( var i = 0, il = inputs.length; i < il; i++ ) {
					inputs[ i ].style.pointerEvents = val;
				}
			},
			
			// For nested overthrows, changeScrollTarget restarts a touch event cycle on a parent or child overthrow
			changeScrollTarget = function( startEvent, ascend ){
				if( doc.createEvent ){
					var newTarget = ( !ascend || ascend === undefined ) && elem.parentNode || elem.touchchild || elem,
						tEnd;
							
					if( newTarget !== elem ){
						tEnd = doc.createEvent( "HTMLEvents" );
						tEnd.initEvent( "touchend", true, true );
						elem.dispatchEvent( tEnd );
						newTarget.touchchild = elem;
						elem = newTarget;
						newTarget.dispatchEvent( startEvent );
					}
				}
			},
			
			// Touchstart handler
			// On touchstart, touchmove and touchend are freshly bound, and all three share a bunch of vars set by touchstart
			// Touchend unbinds them again, until next time
			start = function( e ){

				// Stop any throw in progress
				if( o.intercept ){
					o.intercept();
				}
				
				// Reset the distance and direction tracking
				resetVertTracking();
				resetHorTracking();
				
				elem = o.closest( e.target );
					
				if( !elem || elem === docElem || e.touches.length > 1 ){
					return;
				}			

				setPointers( "none" );
				var touchStartE = e,
					scrollT = elem.scrollTop,
					scrollL = elem.scrollLeft,
					height = elem.offsetHeight,
					width = elem.offsetWidth,
					startY = e.touches[ 0 ].pageY,
					startX = e.touches[ 0 ].pageX,
					scrollHeight = elem.scrollHeight,
					scrollWidth = elem.scrollWidth,
				
					// Touchmove handler
					move = function( e ){
					
						var ty = scrollT + startY - e.touches[ 0 ].pageY,
							tx = scrollL + startX - e.touches[ 0 ].pageX,
							down = ty >= ( lastTops.length ? lastTops[ 0 ] : 0 ),
							right = tx >= ( lastLefts.length ? lastLefts[ 0 ] : 0 );
							
						// If there's room to scroll the current container, prevent the default window scroll
						if( ( ty > 0 && ty < scrollHeight - height ) || ( tx > 0 && tx < scrollWidth - width ) ){
							e.preventDefault();
						}
						// This bubbling is dumb. Needs a rethink.
						else {
							changeScrollTarget( touchStartE );
						}
						
						// If down and lastDown are inequal, the y scroll has changed direction. Reset tracking.
						if( lastDown && down !== lastDown ){
							resetVertTracking();
						}
						
						// If right and lastRight are inequal, the x scroll has changed direction. Reset tracking.
						if( lastRight && right !== lastRight ){
							resetHorTracking();
						}
						
						// remember the last direction in which we were headed
						lastDown = down;
						lastRight = right;							
						
						// set the container's scroll
						elem.scrollTop = ty;
						elem.scrollLeft = tx;
					
						lastTops.unshift( ty );
						lastLefts.unshift( tx );
					
						if( lastTops.length > 3 ){
							lastTops.pop();
						}
						if( lastLefts.length > 3 ){
							lastLefts.pop();
						}
					},
				
					// Touchend handler
					end = function( e ){

						// Bring the pointers back
						setPointers( "auto" );
						setTimeout( function(){
							setPointers( "none" );
						}, 450 );
						elem.removeEventListener( "touchmove", move, false );
						elem.removeEventListener( "touchend", end, false );
					};
				
				elem.addEventListener( "touchmove", move, false );
				elem.addEventListener( "touchend", end, false );
			};
			
		// Bind to touch, handle move and end within
		doc.addEventListener( "touchstart", start, false );
	};
		
})( this, this.overthrow );
;
/*! Overthrow. An overflow:auto polyfill for responsive design. (c) 2012: Scott Jehl, Filament Group, Inc. http://filamentgroup.github.com/Overthrow/license.txt */
(function( w, o, undefined ){

	// o is overthrow reference from overthrow-polyfill.js
	if( o === undefined ){
		return;
	}

	// Easing can use any of Robert Penner's equations (http://www.robertpenner.com/easing_terms_of_use.html). By default, overthrow includes ease-out-cubic
	// arguments: t = current iteration, b = initial value, c = end value, d = total iterations
	// use w.overthrow.easing to provide a custom function externally, or pass an easing function as a callback to the toss method
	o.easing = function (t, b, c, d) {
		return c*((t=t/d-1)*t*t + 1) + b;
	};

	// tossing property is true during a programatic scroll
	o.tossing = false;

	// Keeper of intervals
	var timeKeeper;

	/* toss scrolls and element with easing

	// elem is the element to scroll
	// options hash:
		* left is the desired horizontal scroll. Default is "+0". For relative distances, pass a string with "+" or "-" in front.
		* top is the desired vertical scroll. Default is "+0". For relative distances, pass a string with "+" or "-" in front.
		* duration is the number of milliseconds the throw will take. Default is 100.
		* easing is an optional custom easing function. Default is w.overthrow.easing. Must follow the easing function signature

	*/
	o.toss = function( elem, options ){
		o.intercept();
		var i = 0,
			sLeft = elem.scrollLeft,
			sTop = elem.scrollTop,
			// Toss defaults
			op = {
				top: "+0",
				left: "+0",
				duration: 50,
				easing: o.easing,
				finished: function() {}
			},
			endLeft, endTop, finished = false;

		// Mixin based on predefined defaults
		if( options ){
			for( var j in op ){
				if( options[ j ] !== undefined ){
					op[ j ] = options[ j ];
				}
			}
		}

		// Convert relative values to ints
		// First the left val
		if( typeof op.left === "string" ){
			op.left = parseFloat( op.left );
			endLeft = op.left + sLeft;
		}
		else {
			endLeft = op.left;
			op.left = op.left - sLeft;
		}
		// Then the top val
		if( typeof op.top === "string" ){

			op.top = parseFloat( op.top );
			endTop = op.top + sTop;
		}
		else {
			endTop = op.top;
			op.top = op.top - sTop;
		}

		o.tossing = true;
		timeKeeper = setInterval(function(){
			if( i++ < op.duration ){
				elem.scrollLeft = op.easing( i, sLeft, op.left, op.duration );
				elem.scrollTop = op.easing( i, sTop, op.top, op.duration );
			}
			else{
				if( endLeft !== elem.scrollLeft ){
					elem.scrollLeft = endLeft;
				} else {
					// if the end of the vertical scrolling has taken place
					// we know that we're done here call the callback
					// otherwise signal that horizontal scrolling is complete
					if( finished ) {
						op.finished();
					}
					finished = true;
				}

				if( endTop !== elem.scrollTop ){
					elem.scrollTop = endTop;
				} else {
					// if the end of the horizontal scrolling has taken place
					// we know that we're done here call the callback
					if( finished ) {
						op.finished();
					}
					finished = true;
				}

				o.intercept();
			}
		}, 1 );

		// Return the values, post-mixin, with end values specified
		return { top: endTop, left: endLeft, duration: o.duration, easing: o.easing };
	};

	// Intercept any throw in progress
	o.intercept = function(){
		clearInterval( timeKeeper );
		o.tossing = false;
	};

})( this, this.overthrow );
;
/*! Overthrow. An overflow:auto polyfill for responsive design. (c) 2012: Scott Jehl, Filament Group, Inc. http://filamentgroup.github.com/Overthrow/license.txt */
(function( w, undefined ){
	
	// Auto-init
	w.overthrow.set();

}( this ));;
/*! hashscroll overthrow.js extension:  scroll to elements via hashchange, within an overthrow element. (c) 2012: Scott Jehl, Filament Group, Inc. MIT license */
(function( w, undefined ){
	// set the hash-based links to scroll to a desired location
	if( w.overthrow && w.addEventListener ){
		
		function scrollToElem ( elem ){
		  overthrow.intercept();
			var throwParent = overthrow.closest( elem );
			if( throwParent ){
				overthrow.toss(
					throwParent,
					{ 
						left: elem.offsetLeft - throwParent.offsetLeft,
						top: elem.offsetTop - throwParent.offsetTop
					}
				);	
			}
		}
		
		w.document.addEventListener( "click", function( e ){
			var link = e.target;
			if( link && link.className.indexOf( "throw" ) > -1 && !!link.href){
				var hash = link.href.split( "#" )[ 1 ],
					elem = w.document.getElementById( hash );
					
				if( elem ){
					e.preventDefault();
					scrollToElem( elem );
					w.location.hash = hash;
				}	
			}	
		}, false);

	}		
})( this );;
/* Tooltipster v3.0.5 */;(function(e,t,n){function o(t,n){this.bodyOverflowX;this.checkInterval=null;this.content;this.$el=e(t);this.elProxyPosition;this.$elProxy;this.enabled=true;this.options=e.extend({},s,n);this.mouseIsOverProxy=false;this.namespace="tooltipster-"+Math.round(Math.random()*1e5);this.status="hidden";this.timerHide=null;this.timerShow=null;this.$tooltip;this.options.iconTheme=this.options.iconTheme.replace(".","");this.options.theme=this.options.theme.replace(".","");this.init()}function u(t,n){var r=true;e.each(t,function(e,i){if(typeof n[e]==="undefined"||t[e]!==n[e]){r=false;return false}});return r}function l(){return!f&&a}function c(){var e=n.body||n.documentElement,t=e.style,r="transition";if(typeof t[r]=="string"){return true}v=["Moz","Webkit","Khtml","O","ms"],r=r.charAt(0).toUpperCase()+r.substr(1);for(var i=0;i<v.length;i++){if(typeof t[v[i]+r]=="string"){return true}}return false}var r="tooltipster",s={animation:"fade",arrow:true,arrowColor:"",autoClose:true,content:null,contentAsHTML:false,contentCloning:true,delay:200,fixedWidth:0,maxWidth:0,functionInit:function(e,t){},functionBefore:function(e,t){t()},functionReady:function(e,t){},functionAfter:function(e){},icon:"(?)",iconCloning:true,iconDesktop:false,iconTouch:false,iconTheme:"tooltipster-icon",interactive:false,interactiveTolerance:350,offsetX:0,offsetY:0,onlyOne:false,position:"top",positionTracker:false,speed:350,timer:0,theme:"tooltipster-default",touchDevices:true,trigger:"hover",updateAnimation:true};o.prototype={init:function(){var t=this;if(n.querySelector){if(t.options.content!==null){t.setContent(t.options.content)}else{var r=t.$el.attr("title");if(typeof r==="undefined")r=null;t.setContent(r)}var i=t.options.functionInit(t.$el,t.content);if(typeof i!=="undefined")t.setContent(i);t.$el.removeAttr("title").addClass("tooltipstered");if(!a&&t.options.iconDesktop||a&&t.options.iconTouch){if(typeof t.options.icon==="string"){t.$elProxy=e('<span class="'+t.options.iconTheme+'"></span>');t.$elProxy.text(t.options.icon)}else{if(t.options.iconCloning)t.$elProxy=t.options.icon.clone(true);else t.$elProxy=t.options.icon}t.$elProxy.insertAfter(t.$el)}else{t.$elProxy=t.$el}if(t.options.trigger=="hover"){t.$elProxy.on("mouseenter."+t.namespace,function(){if(!l()||t.options.touchDevices){t.mouseIsOverProxy=true;t.showTooltip()}}).on("mouseleave."+t.namespace,function(){if(!l()||t.options.touchDevices){t.mouseIsOverProxy=false}});if(a&&t.options.touchDevices){t.$elProxy.on("touchstart."+t.namespace,function(){t.showTooltipNow()})}}else if(t.options.trigger=="click"){t.$elProxy.on("click."+t.namespace,function(){if(!l()||t.options.touchDevices){t.showTooltip()}})}}},showTooltip:function(){var e=this;if(e.status!="shown"&&e.status!="appearing"){if(e.options.delay){e.timerShow=setTimeout(function(){if(e.options.trigger=="click"||e.options.trigger=="hover"&&e.mouseIsOverProxy){e.showTooltipNow()}},e.options.delay)}else e.showTooltipNow()}},showTooltipNow:function(){var n=this;clearTimeout(n.timerShow);n.timerShow=null;clearTimeout(n.timerHide);n.timerHide=null;if(n.enabled&&n.content!==null){if(n.options.onlyOne){e(".tooltipstered").not(n.$el).each(function(t,n){var i=e(n),s=i[r]("status"),o=i[r]("option","autoClose");if(s!=="hidden"&&s!=="disappearing"&&o){i[r]("hide")}})}n.options.functionBefore(n.$elProxy,function(){if(n.status!=="hidden"){var r=0;if(n.status==="disappearing"){n.status="appearing";if(c()){n.$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-"+n.options.animation+"-show");if(n.options.speed>0)n.$tooltip.delay(n.options.speed);n.$tooltip.queue(function(){n.status="shown"})}else{n.$tooltip.stop().fadeIn(function(){n.status="shown"})}}}else{n.status="appearing";var r=n.options.speed;n.bodyOverflowX=e("body").css("overflow-x");e("body").css("overflow-x","hidden");var i="tooltipster-"+n.options.animation,s="-webkit-transition-duration: "+n.options.speed+"ms; -webkit-animation-duration: "+n.options.speed+"ms; -moz-transition-duration: "+n.options.speed+"ms; -moz-animation-duration: "+n.options.speed+"ms; -o-transition-duration: "+n.options.speed+"ms; -o-animation-duration: "+n.options.speed+"ms; -ms-transition-duration: "+n.options.speed+"ms; -ms-animation-duration: "+n.options.speed+"ms; transition-duration: "+n.options.speed+"ms; animation-duration: "+n.options.speed+"ms;",o=n.options.fixedWidth>0?"width:"+Math.round(n.options.fixedWidth)+"px;":"",u=n.options.maxWidth>0?"max-width:"+Math.round(n.options.maxWidth)+"px;":"",f=n.options.interactive?"pointer-events: auto;":"";n.$tooltip=e('<div class="tooltipster-base '+n.options.theme+'" style="'+o+" "+u+" "+f+" "+s+'"><div class="tooltipster-content"></div></div>');if(c())n.$tooltip.addClass(i);n.insertContent();n.$tooltip.appendTo("body");n.positionTooltip();n.options.functionReady(n.$el,n.$tooltip);if(c()){n.$tooltip.addClass(i+"-show");if(n.options.speed>0)n.$tooltip.delay(n.options.speed);n.$tooltip.queue(function(){n.status="shown"})}else{n.$tooltip.css("display","none").fadeIn(n.options.speed,function(){n.status="shown"})}n.setCheckInterval();e(t).on("scroll."+n.namespace+" resize."+n.namespace,function(){n.positionTooltip()});if(n.options.autoClose){e("body").off("."+n.namespace);if(n.options.trigger=="hover"){if(a){setTimeout(function(){e("body").on("touchstart."+n.namespace,function(){n.hideTooltip()})},0)}if(n.options.interactive){if(a){n.$tooltip.on("touchstart."+n.namespace,function(e){e.stopPropagation()})}var l=null;n.$elProxy.add(n.$tooltip).on("mouseleave."+n.namespace+"-autoClose",function(){clearTimeout(l);l=setTimeout(function(){n.hideTooltip()},n.options.interactiveTolerance)}).on("mouseenter."+n.namespace+"-autoClose",function(){clearTimeout(l)})}else{n.$elProxy.on("mouseleave."+n.namespace+"-autoClose",function(){n.hideTooltip()})}}else if(n.options.trigger=="click"){setTimeout(function(){e("body").on("click."+n.namespace+" touchstart."+n.namespace,function(){n.hideTooltip()})},0);if(n.options.interactive){n.$tooltip.on("click."+n.namespace+" touchstart."+n.namespace,function(e){e.stopPropagation()})}}}}if(n.options.timer>0){n.timerHide=setTimeout(function(){n.timerHide=null;n.hideTooltip()},n.options.timer+r)}})}},setCheckInterval:function(){var t=this;t.checkInterval=setInterval(function(){if(e("body").find(t.$el).length===0||e("body").find(t.$elProxy).length===0||t.status=="hidden"||e("body").find(t.$tooltip).length===0){if(t.status=="shown"||t.status=="appearing")t.hideTooltip();t.cancelCheckInterval()}else{if(t.options.positionTracker){var n=t.positionInfo(t.$elProxy),r=false;if(u(n.dimension,t.elProxyPosition.dimension)){if(t.$elProxy.css("position")==="fixed"){if(u(n.position,t.elProxyPosition.position))r=true}else{if(u(n.offset,t.elProxyPosition.offset))r=true}}if(!r){t.positionTooltip()}}}},200)},cancelCheckInterval:function(){clearInterval(this.checkInterval);this.checkInterval=null},hideTooltip:function(){var n=this;clearTimeout(n.timerShow);n.timerShow=null;clearTimeout(n.timerHide);n.timerHide=null;if(n.status=="shown"||n.status=="appearing"){n.status="disappearing";var r=function(){n.status="hidden";n.$tooltip.remove();n.$tooltip=null;e(t).off("."+n.namespace);e("body").off("."+n.namespace).css("overflow-x",n.bodyOverflowX);n.$elProxy.off("."+n.namespace+"-autoClose");n.options.functionAfter(n.$elProxy)};if(c()){n.$tooltip.clearQueue().removeClass("tooltipster-"+n.options.animation+"-show").addClass("tooltipster-dying");if(n.options.speed>0)n.$tooltip.delay(n.options.speed);n.$tooltip.queue(r)}else{n.$tooltip.stop().fadeOut(n.options.speed,r)}}},setContent:function(e){if(typeof e==="object"&&e!==null&&this.options.contentCloning){e=e.clone(true)}this.content=e},insertContent:function(){var e=this,t=this.$tooltip.find(".tooltipster-content");if(typeof e.content==="string"&&!e.options.contentAsHTML){t.text(e.content)}else{t.empty().append(e.content)}},updateTooltip:function(e){var t=this;t.setContent(e);if(t.content!==null){if(t.status!=="hidden"){t.insertContent();t.positionTooltip();if(t.options.updateAnimation){if(c()){t.$tooltip.css({width:"","-webkit-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-moz-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-o-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms","-ms-transition":"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms",transition:"all "+t.options.speed+"ms, width 0ms, height 0ms, left 0ms, top 0ms"}).addClass("tooltipster-content-changing");setTimeout(function(){if(t.status!="hidden"){t.$tooltip.removeClass("tooltipster-content-changing");setTimeout(function(){if(t.status!=="hidden"){t.$tooltip.css({"-webkit-transition":t.options.speed+"ms","-moz-transition":t.options.speed+"ms","-o-transition":t.options.speed+"ms","-ms-transition":t.options.speed+"ms",transition:t.options.speed+"ms"})}},t.options.speed)}},t.options.speed)}else{t.$tooltip.fadeTo(t.options.speed,.5,function(){if(t.status!="hidden"){t.$tooltip.fadeTo(t.options.speed,1)}})}}}}else{t.hideTooltip()}},positionInfo:function(e){return{dimension:{height:e.outerHeight(false),width:e.outerWidth(false)},offset:e.offset(),position:{left:parseInt(e.css("left")),top:parseInt(e.css("top"))}}},positionTooltip:function(){var n=this;if(e("body").find(n.$tooltip).length!==0){n.$tooltip.css("width","");n.elProxyPosition=n.positionInfo(n.$elProxy);var r=null,s=e(t).width(),o=n.elProxyPosition,u=n.$tooltip.outerWidth(false),a=n.$tooltip.innerWidth()+1,f=n.$tooltip.outerHeight(false),l=null;if(n.$elProxy.is("area")){var c=n.$elProxy.attr("shape"),h=n.$elProxy.parent().attr("name"),p=e('img[usemap="#'+h+'"]'),d=p.offset().left,v=p.offset().top,m=n.$elProxy.attr("coords")!==undefined?n.$elProxy.attr("coords").split(","):undefined;if(c=="circle"){var g=parseInt(m[0]),y=parseInt(m[1]),b=parseInt(m[2]);o.dimension.height=b*2;o.dimension.width=b*2;o.offset.top=v+y-b;o.offset.left=d+g-b}else if(c=="rect"){var g=parseInt(m[0]),y=parseInt(m[1]),w=parseInt(m[2]),E=parseInt(m[3]);o.dimension.height=E-y;o.dimension.width=w-g;o.offset.top=v+y;o.offset.left=d+g}else if(c=="poly"){var S=[],x=[],T=0,N=0,C=0,k=0,L="even";for(i=0;i<m.length;i++){var A=parseInt(m[i]);if(L=="even"){if(A>C){C=A;if(i===0){T=C}}if(A<T){T=A}L="odd"}else{if(A>k){k=A;if(i==1){N=k}}if(A<N){N=A}L="even"}}o.dimension.height=k-N;o.dimension.width=C-T;o.offset.top=v+N;o.offset.left=d+T}else{o.dimension.height=p.outerHeight(false);o.dimension.width=p.outerWidth(false);o.offset.top=v;o.offset.left=d}}if(n.options.fixedWidth===0){n.$tooltip.css({width:Math.round(a)+"px","padding-left":"0px","padding-right":"0px"})}var O=0,M=0,_=0,D=parseInt(n.options.offsetY),P=parseInt(n.options.offsetX),H=n.options.position;function B(){var n=e(t).scrollLeft();if(O-n<0){r=O-n;O=n}if(O+u-n>s){r=O-(s+n-u);O=s+n-u}}function j(n,r){if(o.offset.top-e(t).scrollTop()-f-D-12<0&&r.indexOf("top")>-1){H=n}if(o.offset.top+o.dimension.height+f+12+D>e(t).scrollTop()+e(t).height()&&r.indexOf("bottom")>-1){H=n;_=o.offset.top-f-D-12}}if(H=="top"){var F=o.offset.left+u-(o.offset.left+o.dimension.width);O=o.offset.left+P-F/2;_=o.offset.top-f-D-12;B();j("bottom","top")}if(H=="top-left"){O=o.offset.left+P;_=o.offset.top-f-D-12;B();j("bottom-left","top-left")}if(H=="top-right"){O=o.offset.left+o.dimension.width+P-u;_=o.offset.top-f-D-12;B();j("bottom-right","top-right")}if(H=="bottom"){var F=o.offset.left+u-(o.offset.left+o.dimension.width);O=o.offset.left-F/2+P;_=o.offset.top+o.dimension.height+D+12;B();j("top","bottom")}if(H=="bottom-left"){O=o.offset.left+P;_=o.offset.top+o.dimension.height+D+12;B();j("top-left","bottom-left")}if(H=="bottom-right"){O=o.offset.left+o.dimension.width+P-u;_=o.offset.top+o.dimension.height+D+12;B();j("top-right","bottom-right")}if(H=="left"){O=o.offset.left-P-u-12;M=o.offset.left+P+o.dimension.width+12;var I=o.offset.top+f-(o.offset.top+n.$elProxy.outerHeight(false));_=o.offset.top-I/2-D;if(O<0&&M+u>s){var q=parseFloat(n.$tooltip.css("border-width"))*2,R=u+O-q;n.$tooltip.css("width",R+"px");f=n.$tooltip.outerHeight(false);O=o.offset.left-P-R-12-q;I=o.offset.top+f-(o.offset.top+n.$elProxy.outerHeight(false));_=o.offset.top-I/2-D}else if(O<0){O=o.offset.left+P+o.dimension.width+12;r="left"}}if(H=="right"){O=o.offset.left+P+o.dimension.width+12;M=o.offset.left-P-u-12;var I=o.offset.top+f-(o.offset.top+n.$elProxy.outerHeight(false));_=o.offset.top-I/2-D;if(O+u>s&&M<0){var q=parseFloat(n.$tooltip.css("border-width"))*2,R=s-O-q;n.$tooltip.css("width",R+"px");f=n.$tooltip.outerHeight(false);I=o.offset.top+f-(o.offset.top+n.$elProxy.outerHeight(false));_=o.offset.top-I/2-D}else if(O+u>s){O=o.offset.left-P-u-12;r="right"}}if(n.options.arrow){var U="tooltipster-arrow-"+H;if(n.options.arrowColor.length<1){var z=n.$tooltip.css("background-color")}else{var z=n.options.arrowColor}if(!r){r=""}else if(r=="left"){U="tooltipster-arrow-right";r=""}else if(r=="right"){U="tooltipster-arrow-left";r=""}else{r="left:"+Math.round(r)+"px;"}if(H=="top"||H=="top-left"||H=="top-right"){var W=parseFloat(n.$tooltip.css("border-bottom-width")),X=n.$tooltip.css("border-bottom-color")}else if(H=="bottom"||H=="bottom-left"||H=="bottom-right"){var W=parseFloat(n.$tooltip.css("border-top-width")),X=n.$tooltip.css("border-top-color")}else if(H=="left"){var W=parseFloat(n.$tooltip.css("border-right-width")),X=n.$tooltip.css("border-right-color")}else if(H=="right"){var W=parseFloat(n.$tooltip.css("border-left-width")),X=n.$tooltip.css("border-left-color")}else{var W=parseFloat(n.$tooltip.css("border-bottom-width")),X=n.$tooltip.css("border-bottom-color")}if(W>1){W++}var V="";if(W!==0){var J="",K="border-color: "+X+";";if(U.indexOf("bottom")!==-1){J="margin-top: -"+Math.round(W)+"px;"}else if(U.indexOf("top")!==-1){J="margin-bottom: -"+Math.round(W)+"px;"}else if(U.indexOf("left")!==-1){J="margin-right: -"+Math.round(W)+"px;"}else if(U.indexOf("right")!==-1){J="margin-left: -"+Math.round(W)+"px;"}V='<span class="tooltipster-arrow-border" style="'+J+" "+K+';"></span>'}n.$tooltip.find(".tooltipster-arrow").remove();var Q='<div class="'+U+' tooltipster-arrow" style="'+r+'">'+V+'<span style="border-color:'+z+';"></span></div>';n.$tooltip.append(Q)}n.$tooltip.css({top:Math.round(_)+"px",left:Math.round(O)+"px"})}}};e.fn[r]=function(){var t=arguments;if(this.length===0){if(typeof t[0]==="string"){var n=true;switch(t[0]){case"setDefaults":e.extend(s,t[1]);break;default:n=false;break}if(n)return true;else return this}else{return this}}else{if(typeof t[0]==="string"){var r="#*$~&";this.each(function(){var n=e(this).data("tooltipster");if(n){switch(t[0]){case"content":case"update":if(typeof t[1]==="undefined"){r=n.content;return false}else{n.updateTooltip(t[1]);break};case"destroy":n.hideTooltip();if(n.$el[0]!==n.$elProxy[0])n.$elProxy.remove();var i=typeof n.content==="string"?n.content:e("<div></div>").append(n.content).html();n.$el.removeClass("tooltipstered").attr("title",i).removeData("tooltipster").off("."+n.namespace);break;case"disable":n.hideTooltip();n.enabled=false;break;case"elementIcon":r=n.$el[0]!==n.$elProxy[0]?n.$elProxy[0]:undefined;return false;case"elementTooltip":r=n.$tooltip?n.$tooltip[0]:undefined;return false;case"enable":n.enabled=true;break;case"hide":n.hideTooltip();break;case"option":r=n.options[t[1]];break;case"reposition":n.positionTooltip();break;case"show":n.showTooltipNow();break;case"status":r=n.status;return false;default:throw new Error('Unknown method .tooltipster("'+t[0]+'")');break}}else{throw new Error("You called Tooltipster's \""+t[0]+'" method on an uninitialized element')}});return r!=="#*$~&"?r:this}else{return this.each(function(){if(!e(this).data("tooltipster")){e(this).data("tooltipster",new o(this,t[0]))}})}}};var a=!!("ontouchstart"in t);var f=false;e("body").one("mousemove",function(){f=true})})(jQuery,window,document);;
/*	
 * jQuery mmenu v4.1.1
 * @requires jQuery 1.7.0 or later
 *
 * mmenu.frebsite.nl
 *	
 * Copyright (c) Fred Heusschen
 * www.frebsite.nl
 *
 * Dual licensed under the MIT and GPL licenses.
 * http://en.wikipedia.org/wiki/MIT_License
 * http://en.wikipedia.org/wiki/GNU_General_Public_License
 */


(function( $ ) {

	var _PLUGIN_	= 'mmenu',
		_VERSION_	= '4.1.1';


	//	Plugin already excists
	if ( $[ _PLUGIN_ ] )
	{
		return;
	}

	//	Global variables
	var glbl = {
		$wndw: null,
		$html: null,
		$body: null,
		$page: null,
		$blck: null,

		$allMenus: null,
		$scrollTopNode: null
	};

	var _c = {}, _e = {}, _d = {},
		_serialnr = 0;


	$[ _PLUGIN_ ] = function( $menu, opts, conf )
	{
		glbl.$allMenus = glbl.$allMenus.add( $menu );

		this.$menu = $menu;
		this.opts  = opts
		this.conf  = conf;

		this.serialnr = _serialnr++;

		this._init();

		return this;
	};

	$[ _PLUGIN_ ].prototype = {

		open: function()
		{
			this._openSetup();
			this._openFinish();
			return 'open';
		},
		_openSetup: function()
		{
			//	Find scrolltop
			var _scrollTop = findScrollTop();

			//	Set opened
			this.$menu.addClass( _c.current );

			//	Close others
			glbl.$allMenus.not( this.$menu ).trigger( _e.close );

			//	Store style and position
			glbl.$page
				.data( _d.style, glbl.$page.attr( 'style' ) || '' )
				.data( _d.scrollTop, _scrollTop )
				.data( _d.offetLeft, glbl.$page.offset().left );

			//	Resize page to window width
			var _w = 0;
			glbl.$wndw.off( _e.resize )
				.on( _e.resize,
					function( e, force )
					{
						if ( glbl.$html.hasClass( _c.opened ) || force )
						{
							var nw = glbl.$wndw.width();
							if ( nw != _w )
							{
								_w = nw;
								glbl.$page.width( nw - glbl.$page.data( _d.offetLeft ) );
							}
						}
					}
				)
				.trigger( _e.resize, [ true ] );

			//	Prevent tabbing out of the menu
			if ( this.conf.preventTabbing )
			{
				glbl.$wndw.off( _e.keydown )
					.on( _e.keydown,
						function( e )
						{
							if ( e.keyCode == 9 )
							{
								e.preventDefault();
								return false;
							}
						}
					);
			}

			//	Add options
			if ( this.opts.modal )
			{
				glbl.$html.addClass( _c.modal );
			}
			if ( this.opts.moveBackground )
			{
				glbl.$html.addClass( _c.background );
			}
			if ( this.opts.position != 'left' )
			{
				glbl.$html.addClass( _c.mm( this.opts.position ) );
			}
			if ( this.opts.zposition != 'back' )
			{
				glbl.$html.addClass( _c.mm( this.opts.zposition ) );
			}
			if ( this.opts.classes )
			{
				glbl.$html.addClass( this.opts.classes );
			}

			//	Open
			glbl.$html.addClass( _c.opened );
			this.$menu.addClass( _c.opened );

			//	Scroll page to scrolltop
			glbl.$page.scrollTop( _scrollTop );

			//	Scroll menu to top
			this.$menu.scrollTop( 0 );
		},
		_openFinish: function()
		{
			var that = this;

			//	Callback
			transitionend( glbl.$page,
				function()
				{
					that.$menu.trigger( _e.opened );
				}, this.conf.transitionDuration
			);

			//	Opening
			glbl.$html.addClass( _c.opening );
			this.$menu.trigger( _e.opening );

			//	Scroll window to top
			window.scrollTo( 0, 1 );
		},
		close: function()
		{
			var that = this;

			//	Callback
			transitionend( glbl.$page,
				function()
				{
					that.$menu
						.removeClass( _c.current )
						.removeClass( _c.opened );

					glbl.$html
						.removeClass( _c.opened )
						.removeClass( _c.modal )
						.removeClass( _c.background )
						.removeClass( _c.mm( that.opts.position ) )
						.removeClass( _c.mm( that.opts.zposition ) );

					if ( that.opts.classes )
					{
						glbl.$html.removeClass( that.opts.classes );
					}

					glbl.$wndw
						.off( _e.resize )
						.off( _e.keydown );

					//	Restore style and position
					glbl.$page.attr( 'style', glbl.$page.data( _d.style ) );

					if ( glbl.$scrollTopNode )
					{
						glbl.$scrollTopNode.scrollTop( glbl.$page.data( _d.scrollTop ) );
					}

					//	Closed
					that.$menu.trigger( _e.closed );
	
				}, this.conf.transitionDuration
			);

			//	Closing
			glbl.$html.removeClass( _c.opening );
			this.$menu.trigger( _e.closing );
	
			return 'close';
		},
	
		_init: function()
		{
			this.opts = extendOptions( this.opts, this.conf, this.$menu );
			this.direction = ( this.opts.slidingSubmenus ) ? 'horizontal' : 'vertical';
	
			//	INIT PAGE & MENU
			this._initPage( glbl.$page );
			this._initMenu();
			this._initBlocker();
			this._initPanles();
			this._initLinks();
			this._initOpenClose();
			this._bindCustomEvents();

			if ( $[ _PLUGIN_ ].addons )
			{
				for ( var a = 0; a < $[ _PLUGIN_ ].addons.length; a++ )
				{
					if ( typeof this[ '_addon_' + $[ _PLUGIN_ ].addons[ a ] ] == 'function' )
					{
						this[ '_addon_' + $[ _PLUGIN_ ].addons[ a ] ]();
					}
				}
			}
		},

		_bindCustomEvents: function()
		{
			var that = this;

			this.$menu
				.off( _e.open + ' ' + _e.close + ' ' + _e.setPage+ ' ' + _e.update )
				.on( _e.open + ' ' + _e.close + ' ' + _e.setPage+ ' ' + _e.update,
					function( e )
					{
						e.stopPropagation();
					}
				);

			//	Menu-events
			this.$menu
				.on( _e.open,
					function( e )
					{
						if ( $(this).hasClass( _c.current ) )
						{
							e.stopImmediatePropagation();
							return false;
						}
						return that.open();
					}
				)
				.on( _e.close,
					function( e )
					{
						if ( !$(this).hasClass( _c.current ) )
						{
							e.stopImmediatePropagation();
							return false;
						}
						return that.close();
					}
				)
				.on( _e.setPage,
					function( e, $p )
					{
						that._initPage( $p );
						that._initOpenClose();
					}
				);

			//	Panel-events
			var $panels = this.$menu.find( this.opts.isMenu && this.direction != 'horizontal' ? 'ul, ol' : '.' + _c.panel );
			$panels
				.off( _e.toggle + ' ' + _e.open + ' ' + _e.close )
				.on( _e.toggle + ' ' + _e.open + ' ' + _e.close,
					function( e )
					{
						e.stopPropagation();
					}
				);

			if ( this.direction == 'horizontal' )
			{
				$panels
					.on( _e.open,
						function( e )
						{
							return openSubmenuHorizontal( $(this), that.$menu );
						}
					);
			}
			else
			{
				$panels
					.on( _e.toggle,
						function( e )
						{
							var $t = $(this);
							return $t.triggerHandler( $t.parent().hasClass( _c.opened ) ? _e.close : _e.open );
						}
					)
					.on( _e.open,
						function( e )
						{
							$(this).parent().addClass( _c.opened );
							return 'open';
						}
					)
					.on( _e.close,
						function( e )
						{
							$(this).parent().removeClass( _c.opened );
							return 'close';
						}
					);
			}
		},
		
		_initBlocker: function()
		{
			var that = this;

			if ( !glbl.$blck )
			{
				glbl.$blck = $( '<div id="' + _c.blocker + '" />' ).appendTo( glbl.$body );
			}

			click( glbl.$blck,
				function()
				{
					if ( !glbl.$html.hasClass( _c.modal ) )
					{
						that.$menu.trigger( _e.close );
					}
				}, true, true
			);
		},
		_initPage: function( $p )
		{
			if ( !$p )
			{
				$p = $(this.conf.pageSelector, glbl.$body);
				if ( $p.length > 1 )
				{
					$[ _PLUGIN_ ].debug( 'Multiple nodes found for the page-node, all nodes are wrapped in one <' + this.conf.pageNodetype + '>.' );
					$p = $p.wrapAll( '<' + this.conf.pageNodetype + ' />' ).parent();
				}
			}
	
			$p.addClass( _c.page );
			glbl.$page = $p;
		},
		_initMenu: function()
		{
			var that = this;

			//	Clone if needed
			if ( this.conf.clone )
			{
				this.$menu = this.$menu.clone( true );
				this.$menu.add( this.$menu.find( '*' ) ).filter( '[id]' ).each(
					function()
					{
						$(this).attr( 'id', _c.mm( $(this).attr( 'id' ) ) );
					}
				);
			}

			//	Strip whitespace
			this.$menu.contents().each(
				function()
				{
					if ( $(this)[ 0 ].nodeType == 3 )
					{
						$(this).remove();
					}
				}
			);

			//	Prepend to body
			this.$menu
				.prependTo( 'body' )
				.addClass( _c.menu );

			//	Add direction class
			this.$menu.addClass( _c.mm( this.direction ) );

			//	Add options classes
			if ( this.opts.classes )
			{
				this.$menu.addClass( this.opts.classes );
			}
			if ( this.opts.isMenu )
			{
				this.$menu.addClass( _c.ismenu );
			}
			if ( this.opts.position != 'left' )
			{
				this.$menu.addClass( _c.mm( this.opts.position ) );
			}
			if ( this.opts.zposition != 'back' )
			{
				this.$menu.addClass( _c.mm( this.opts.zposition ) );
			}
		},
		_initPanles: function()
		{
			var that = this;


			//	Refactor List class
			this.__refactorClass( $('.' + this.conf.listClass, this.$menu), 'list' );

			//	Add List class
			if ( this.opts.isMenu )
			{
				$('ul, ol', this.$menu)
					.not( '.mm-nolist' )
					.addClass( _c.list );
			}

			var $lis = $('.' + _c.list + ' > li', this.$menu);

			//	Refactor Selected class
			this.__refactorClass( $lis.filter( '.' + this.conf.selectedClass ), 'selected' );

			//	Refactor Label class
			this.__refactorClass( $lis.filter( '.' + this.conf.labelClass ), 'label' );

			//	Refactor Spacer class
			this.__refactorClass( $lis.filter( '.' + this.conf.spacerClass ), 'spacer' );

			//	setSelected-event
			$lis
				.off( _e.setSelected )
				.on( _e.setSelected,
					function( e, selected )
					{
						e.stopPropagation();
	
						$lis.removeClass( _c.selected );
						if ( typeof selected != 'boolean' )
						{
							selected = true;
						}
						if ( selected )
						{
							$(this).addClass( _c.selected );
						}
					}
				);

			//	Refactor Panel class
			this.__refactorClass( $('.' + this.conf.panelClass, this.$menu), 'panel' );

			//	Add Panel class
			this.$menu
				.children()
				.filter( this.conf.panelNodetype )
				.add( this.$menu.find( '.' + _c.list ).children().children().filter( this.conf.panelNodetype ) )
				.addClass( _c.panel );

			var $panels = $('.' + _c.panel, this.$menu);

			//	Add an ID to all panels
			$panels
				.each(
					function( i )
					{
						var $t = $(this),
							id = $t.attr( 'id' ) || _c.mm( 'm' + that.serialnr + '-p' + i );

						$t.attr( 'id', id );
					}
			);

			//	Add open and close links to menu items
			$panels
				.find( '.' + _c.panel )
				.each(
					function( i )
					{
						var $t = $(this),
							$u = $t.is( 'ul, ol' ) ? $t : $t.find( 'ul ,ol' ).first(),
							$l = $t.parent(),
							$a = $l.find( '> a, > span' ),
							$p = $l.closest( '.' + _c.panel );

						$t.data( _d.parent, $l );

						if ( $l.parent().is( '.' + _c.list ) )
						{
							var $btn = $( '<a class="' + _c.subopen + '" href="#' + $t.attr( 'id' ) + '" />' ).insertBefore( $a );
							if ( !$a.is( 'a' ) )
							{
								$btn.addClass( _c.fullsubopen );
							}
							if ( that.direction == 'horizontal' )
							{
								$u.prepend( '<li class="' + _c.subtitle + '"><a class="' + _c.subclose + '" href="#' + $p.attr( 'id' ) + '">' + $a.text() + '</a></li>' );
							}
						}
					}
				);

			//	Link anchors to panels
			var evt = this.direction == 'horizontal' ? _e.open : _e.toggle;
			$panels
				.each(
					function( i )
					{
						var $opening = $(this),
							id = $opening.attr( 'id' );

						click( $('a[href="#' + id + '"]', that.$menu),
							function( e )
							{
								$opening.trigger( evt );
							}
						);
					}
			);

			if ( this.direction == 'horizontal' )
			{
				//	Add opened-classes
				var $selected = $('.' + _c.list + ' > li.' + _c.selected, this.$menu);
				$selected
					.add( $selected.parents( 'li' ) )
					.parents( 'li' ).removeClass( _c.selected )
					.end().each(
						function()
						{
							var $t = $(this),
								$u = $t.find( '> .' + _c.panel );

							if ( $u.length )
							{
								$t.parents( '.' + _c.panel ).addClass( _c.subopened );
								$u.addClass( _c.opened );
							}
						}
					)
					.closest( '.' + _c.panel ).addClass( _c.opened )
					.parents( '.' + _c.panel ).addClass( _c.subopened );
			}
			else
			{
				//	Replace Selected-class with opened-class in parents from .Selected
				$('li.' + _c.selected, this.$menu)
					.addClass( _c.opened )
					.parents( '.' + _c.selected ).removeClass( _c.selected );
			}

			//	Set current opened
			var $current = $panels.filter( '.' + _c.opened );
			if ( !$current.length )
			{
				$current = $panels.first();
			}
			$current
				.addClass( _c.opened )
				.last()
				.addClass( _c.current );

			//	Rearrange markup
			if ( this.direction == 'horizontal' )
			{
				$panels.find( '.' + _c.panel ).appendTo( this.$menu );
			}
		},
		_initLinks: function()
		{
			var that = this;
	
			var $a = $('.' + _c.list + ' > li > a', this.$menu)
				.not( '.' + _c.subopen )
				.not( '.' + _c.subclose )
				.not( '[rel="external"]' )
				.not( '[target="_blank"]' );

			$a.off( _e.click )
				.on( _e.click,
					function( e )
					{
						var $t = $(this),
							href = $t.attr( 'href' );
	

						//	Set selected item
						if ( that.__valueOrFn( that.opts.onClick.setSelected, $t ) )
						{
							$t.parent().trigger( _e.setSelected );
						}

						//	Prevent default / don't follow link. Default: false
						var preventDefault = that.__valueOrFn( that.opts.onClick.preventDefault, $t, href.slice( 0, 1 ) == '#' );
						if ( preventDefault )
						{
							e.preventDefault();
							e.stopPropagation();
						}

						//	Block UI. Default: false if preventDefault, true otherwise
						if ( that.__valueOrFn( that.opts.onClick.blockUI, $t, !preventDefault ) )
						{
							glbl.$html.addClass( _c.blocking );
						}

						//	Close menu. Default: true if preventDefault, false otherwise
						if ( that.__valueOrFn( that.opts.onClick.close, $t, preventDefault ) )
						{
							that.$menu.triggerHandler( _e.close );
						}
					}
				);
		},
		_initOpenClose: function()
		{
			var that = this;

			//	Toggle menu
			var id = this.$menu.attr( 'id' );
			if ( id && id.length )
			{
				if ( this.conf.clone )
				{
					id = _c.umm( id );
				}

				click( $('a[href="#' + id + '"]'),
					function()
					{
						that.$menu.trigger( _e.open );
					}
				);
			}

			//	Close menu
			var id = glbl.$page.attr( 'id' );
			if ( id && id.length )
			{
				click( $('a[href="#' + id + '"]'),
					function()
					{
						that.$menu.trigger( _e.close );
					}, false, true
				);
			}
		},
		
		__valueOrFn: function( o, $e, d )
		{
			if ( typeof o == 'function' )
			{
				return o.call( $e[ 0 ] );
			}
			if ( typeof o == 'undefined' && typeof d != 'undefined' )
			{
				return d;
			}
			return o;
		},
		
		__refactorClass: function( $e, c )
		{
			$e.removeClass( this.conf[ c + 'Class' ] ).addClass( _c[ c ] );
		}
	};


	$.fn[ _PLUGIN_ ] = function( opts, conf )
	{
		//	First time plugin is fired
		if ( !glbl.$wndw )
		{
			_initPlugin();
		}

		//	Extend options
		opts = extendOptions( opts, conf );
		conf = extendConfiguration( conf );

		return this.each(
			function()
			{
				var $menu = $(this);
				if ( $menu.data( _PLUGIN_ ) )
				{
					return;
				}
				$menu.data( _PLUGIN_, new $[ _PLUGIN_ ]( $menu, opts, conf ) );
			}
		);
	};

	$[ _PLUGIN_ ].version = _VERSION_;
	
	$[ _PLUGIN_ ].defaults = {
		position		: 'left',
		zposition		: 'back',
		moveBackground	: true,
		slidingSubmenus	: true,
		modal			: false,
		classes			: '',
		onClick			: {
//			close				: true,
//			blockUI				: null,
//			preventDefault		: null,
			setSelected			: true
		}
	};
	$[ _PLUGIN_ ].configuration = {
		preventTabbing		: true,
		panelClass			: 'Panel',
		listClass			: 'List',
		selectedClass		: 'Selected',
		labelClass			: 'Label',
		spacerClass			: 'Spacer',
		pageNodetype		: 'div',
		panelNodetype		: 'ul, ol, div',
		transitionDuration	: 400
	};



	/*
		SUPPORT
	*/
	(function() {

		var wd = window.document,
			ua = window.navigator.userAgent;

		var _touch 				= 'ontouchstart' in wd,
			_overflowscrolling	= 'WebkitOverflowScrolling' in wd.documentElement.style,
			_transition			= (function() {
				var s = document.createElement( 'div' ).style;
			    if ( 'webkitTransition' in s )
			    {
			        return 'webkitTransition';  
			    }
			    return 'transition' in s;
			})(),
			_oldAndroidBrowser	= (function() {
				if ( ua.indexOf( 'Android' ) >= 0 )
				{
					return 2.4 > parseFloat( ua.slice( ua.indexOf( 'Android' ) +8 ) );
				}
				return false;
			})();

		$[ _PLUGIN_ ].support = {

			touch: _touch,
			transition: _transition,
			oldAndroidBrowser: _oldAndroidBrowser,

			overflowscrolling: (function() {
				if ( !_touch )
				{
					return true;
				}
				if ( _overflowscrolling )
				{
					return true;
				}
				if ( _oldAndroidBrowser )
				{
					return false;
				}
				return true;
			})()
		};
	})();


	/*
		BROWSER SPECIFIC FIXES
	*/
	$[ _PLUGIN_ ].useOverflowScrollingFallback = function( use )
	{
		if ( glbl.$html )
		{
			if ( typeof use == 'boolean' )
			{
				glbl.$html[ use ? 'addClass' : 'removeClass' ]( _c.nooverflowscrolling );
			}
			return glbl.$html.hasClass( _c.nooverflowscrolling );
		}
		else
		{
			_useOverflowScrollingFallback = use;
			return use;
		}
	};


	/*
		DEBUG
	*/
	$[ _PLUGIN_ ].debug = function( msg ) {};
	$[ _PLUGIN_ ].deprecated = function( depr, repl )
	{
		if ( typeof console != 'undefined' && typeof console.warn != 'undefined' )
		{
			console.warn( 'MMENU: ' + depr + ' is deprecated, use ' + repl + ' instead.' );
		}
	};


	//	Global vars
	var _useOverflowScrollingFallback = !$[ _PLUGIN_ ].support.overflowscrolling;


	function extendOptions( o, c, $m )
	{
		if ( typeof o != 'object' )
		{
			o = {};
		}

		if ( $m )
		{
			if ( typeof o.isMenu != 'boolean' )
			{
				var $c = $m.children();
				o.isMenu = ( $c.length == 1 && $c.is( c.panelNodetype ) );
			}
			return o;
		}


		//	Extend onClick
		if ( typeof o.onClick != 'object' )
		{
			o.onClick = {};
		}


		//	DEPRECATED
		if ( typeof o.onClick.setLocationHref != 'undefined' )
		{
			$[ _PLUGIN_ ].deprecated( 'onClick.setLocationHref option', '!onClick.preventDefault' );
			if ( typeof o.onClick.setLocationHref == 'boolean' )
			{
				o.onClick.preventDefault = !o.onClick.setLocationHref;
			}
		}
		//	/DEPRECATED


		//	Extend from defaults
		o = $.extend( true, {}, $[ _PLUGIN_ ].defaults, o );


		//	Degration
		if ( $[ _PLUGIN_ ].useOverflowScrollingFallback() )
		{
			switch( o.position )
			{
				case 'top':
				case 'right':
				case 'bottom':
					$[ _PLUGIN_ ].debug( 'position: "' + o.position + '" not supported when using the overflowScrolling-fallback.' );
					o.position = 'left';
					break;
			}
			switch( o.zposition )
			{
				case 'front':
				case 'next':
					$[ _PLUGIN_ ].debug( 'z-position: "' + o.zposition + '" not supported when using the overflowScrolling-fallback.' );
					o.zposition = 'back';
					break;
			}
		}

		return o;
	}
	function extendConfiguration( c )
	{
		if ( typeof c != 'object' )
		{
			c = {};
		}


		//	DEPRECATED
		if ( typeof c.panelNodeType != 'undefined' )
		{
			$[ _PLUGIN_ ].deprecated( 'panelNodeType configuration option', 'panelNodetype' );
			c.panelNodetype = c.panelNodeType;
		}
		//	/DEPRECATED


		c = $.extend( true, {}, $[ _PLUGIN_ ].configuration, c )

		//	Set pageSelector
		if ( typeof c.pageSelector != 'string' )
		{
			c.pageSelector = '> ' + c.pageNodetype;
		}

		return c;
	}

	function _initPlugin()
	{
		glbl.$wndw = $(window);
		glbl.$html = $('html');
		glbl.$body = $('body');
		
		glbl.$allMenus = $();


		//	Classnames, Datanames, Eventnames
		$.each( [ _c, _d, _e ],
			function( i, o )
			{
				o.add = function( c )
				{
					c = c.split( ' ' );
					for ( var d in c )
					{
						o[ c[ d ] ] = o.mm( c[ d ] );
					}
				};
			}
		);

		//	Classnames
		_c.mm = function( c ) { return 'mm-' + c; };
		_c.add( 'menu ismenu panel list subtitle selected label spacer current highest hidden page blocker modal background opened opening subopened subopen fullsubopen subclose nooverflowscrolling' );
		_c.umm = function( c )
		{
			if ( c.slice( 0, 3 ) == 'mm-' )
			{
				c = c.slice( 3 );
			}
			return c;
		};

		//	Datanames
		_d.mm = function( d ) { return 'mm-' + d; };
		_d.add( 'parent style scrollTop offetLeft' );

		//	Eventnames
		_e.mm = function( e ) { return e + '.mm'; };
		_e.add( 'toggle open opening opened close closing closed update setPage setSelected transitionend touchstart touchend click keydown keyup resize' );
		if ( !$[ _PLUGIN_ ].support.touch )
		{
			_e.touchstart	= _e.mm( 'mousedown' );
			_e.touchend 	= _e.mm( 'mouseup' );
		}

		$[ _PLUGIN_ ]._c = _c;
		$[ _PLUGIN_ ]._d = _d;
		$[ _PLUGIN_ ]._e = _e;

		$[ _PLUGIN_ ].glbl = glbl;

		$[ _PLUGIN_ ].useOverflowScrollingFallback( _useOverflowScrollingFallback );
	}

	function openSubmenuHorizontal( $opening, $m )
	{
		if ( $opening.hasClass( _c.current ) )
		{
			return false;
		} 

		var $panels = $('.' + _c.panel, $m),
			$current = $panels.filter( '.' + _c.current );
		
		$panels
			.removeClass( _c.highest )
			.removeClass( _c.current )
			.not( $opening )
			.not( $current )
			.addClass( _c.hidden );

		if ( $opening.hasClass( _c.opened ) )
		{
			$current
				.addClass( _c.highest )
				.removeClass( _c.opened )
				.removeClass( _c.subopened );
		}
		else
		{
			$opening
				.addClass( _c.highest );

			$current
				.addClass( _c.subopened );
		}

		$opening
			.removeClass( _c.hidden )
			.removeClass( _c.subopened )
			.addClass( _c.current )
			.addClass( _c.opened );

		return 'open';
	}

	function findScrollTop()
	{
		if ( !glbl.$scrollTopNode )
		{
			if ( glbl.$html.scrollTop() != 0 )
			{
				glbl.$scrollTopNode = glbl.$html;
			}
			else if ( glbl.$body.scrollTop() != 0 )
			{
				glbl.$scrollTopNode = glbl.$body;
			}
		}
		return ( glbl.$scrollTopNode ) ? glbl.$scrollTopNode.scrollTop() : 0;
	}

	function transitionend( $e, fn, duration )
	{
		var s = $[ _PLUGIN_ ].support.transition;
	    if ( s == 'webkitTransition' )
	    {
	        $e.one( 'webkitTransitionEnd', fn );
	    }
		else if ( s )
		{
			$e.one( _e.transitionend, fn );
		}
		else
		{
			setTimeout( fn, duration );
		}
	}
	function click( $b, fn, onTouchStart, add )
	{
		if ( typeof $b == 'string' )
		{
			$b = $( $b );
		}

		var event = ( onTouchStart )
			? _e.touchstart
			: _e.click;

		if ( !add )
		{
			$b.off( event );
		}
		$b.on( event,
			function( e )
			{
				e.preventDefault();
				e.stopPropagation();

				fn.call( this, e );
			}
		);
	}

})( jQuery );;

/*!
 * Amplify Core 1.1.2
 *
 * Copyright 2011 - 2013 appendTo LLC. (http://appendto.com/team)
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 *
 * http://amplifyjs.com
 */
(function(e,t){var n=[].slice,r={},i=e.amplify={publish:function(e){if(typeof e!="string")throw new Error("You must provide a valid topic to publish.");var t=n.call(arguments,1),i,s,o,u=0,a;if(!r[e])return!0;i=r[e].slice();for(o=i.length;u<o;u++){s=i[u],a=s.callback.apply(s.context,t);if(a===!1)break}return a!==!1},subscribe:function(e,t,n,i){if(typeof e!="string")throw new Error("You must provide a valid topic to create a subscription.");arguments.length===3&&typeof n=="number"&&(i=n,n=t,t=null),arguments.length===2&&(n=t,t=null),i=i||10;var s=0,o=e.split(/\s/),u=o.length,a;for(;s<u;s++){e=o[s],a=!1,r[e]||(r[e]=[]);var f=r[e].length-1,l={callback:n,context:t,priority:i};for(;f>=0;f--)if(r[e][f].priority<=i){r[e].splice(f+1,0,l),a=!0;break}a||r[e].unshift(l)}return n},unsubscribe:function(e,t,n){if(typeof e!="string")throw new Error("You must provide a valid topic to remove a subscription.");arguments.length===2&&(n=t,t=null);if(!r[e])return;var i=r[e].length,s=0;for(;s<i;s++)r[e][s].callback===n&&(!t||r[e][s].context===t)&&(r[e].splice(s,1),s--,i--)}}})(this);
/*!
 * v0.0.9
 * Copyright (c) 2013 First Opinion
 * formatter.js is open sourced under the MIT license.
 *
 * thanks to digitalBush/jquery.maskedinput for some of the trickier
 * keycode handling
 */
!function(a,b,c){function d(a,b){var c=this;if(c.el=a,!c.el)throw new TypeError("Must provide an existing element");if(c.opts=l.extend({},e,b),"undefined"==typeof c.opts.pattern)throw new TypeError("Must provide a pattern");var d=g.parse(c.opts.pattern);c.mLength=d.mLength,c.chars=d.chars,c.inpts=d.inpts,c.hldrs={},c.focus=0,l.addListener(c.el,"keydown",function(a){c._keyDown(a)}),l.addListener(c.el,"keypress",function(a){c._keyPress(a)}),l.addListener(c.el,"paste",function(a){c._paste(a)}),c.opts.persistent&&(c._processKey("",!1),c.el.blur(),l.addListener(c.el,"focus",function(a){c._focus(a)}),l.addListener(c.el,"click",function(a){c._focus(a)}),l.addListener(c.el,"touchstart",function(a){c._focus(a)}))}var e={persistent:!1,repeat:!1,placeholder:" "},f={9:/[0-9]/,a:/[A-Za-z]/,"*":/[A-Za-z0-9]/};d.addInptType=function(a,b){f[a]=b},d.prototype.resetPattern=function(a){this.opts.pattern=a,this.sel=k.get(this.el),this.val=this.el.value,this.delta=0,this._removeChars();var b=g.parse(a);this.mLength=b.mLength,this.chars=b.chars,this.inpts=b.inpts,this._processKey("",!1)},d.prototype._keyDown=function(a){var b=a.which||a.keyCode;return b&&l.isDelKey(b)?(this._processKey(null,b),l.preventDefault(a)):void 0},d.prototype._keyPress=function(a){var b,c;return a.which?b=a.which:(b=a.keyCode,c=l.isSpecialKey(b)),l.isDelKey(b)||c||l.isModifier(a)?void 0:(this._processKey(String.fromCharCode(b),!1),l.preventDefault(a))},d.prototype._paste=function(a){return this._processKey(l.getClip(a),!1),l.preventDefault(a)},d.prototype._focus=function(){var a=this;setTimeout(function(){var b=k.get(a.el),c=b.end>a.focus;isFirstChar=0===b.end,(c||isFirstChar)&&k.set(a.el,a.focus)},0)},d.prototype._processKey=function(a,b){if(this.sel=k.get(this.el),this.val=this.el.value,this.delta=0,this.sel.begin!==this.sel.end)this.delta=-1*Math.abs(this.sel.begin-this.sel.end),this.val=l.removeChars(this.val,this.sel.begin,this.sel.end);else if(b&&46==b)this._delete();else if(b&&this.sel.begin-1>=0)this.val=l.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta=-1;else if(b)return!0;b||(this.val=l.addChars(this.val,a,this.sel.begin),this.delta+=a.length),this._formatValue()},d.prototype._delete=function(){for(;this.chars[this.sel.begin];)this._nextPos();this.sel.begin<this.val.length&&(this._nextPos(),this.val=l.removeChars(this.val,this.sel.end-1,this.sel.end),this.delta=-1)},d.prototype._nextPos=function(){this.sel.end++,this.sel.begin++},d.prototype._formatValue=function(){this.newPos=this.sel.end+this.delta,this._removeChars(),this._validateInpts(),this._addChars(),this.el.value=this.val.substr(0,this.mLength),k.set(this.el,this.newPos)},d.prototype._removeChars=function(){this.sel.end>this.focus&&(this.delta+=this.sel.end-this.focus);for(var a=0,b=0;b<=this.mLength;b++){var c,d=this.chars[b],e=this.hldrs[b],f=b+a;f=b>=this.sel.begin?f+this.delta:f,c=this.val.charAt(f),(d&&d==c||e&&e==c)&&(this.val=l.removeChars(this.val,f,f+1),a--)}this.hldrs={},this.focus=this.val.length},d.prototype._validateInpts=function(){for(var a=0;a<this.val.length;a++){var b=this.inpts[a],c=!f[b],d=!c&&!f[b].test(this.val.charAt(a)),e=this.inpts[a];(c||d)&&e&&(this.val=l.removeChars(this.val,a,a+1),this.focusStart--,this.newPos--,this.delta--,a--)}},d.prototype._addChars=function(){if(this.opts.persistent){for(var a=0;a<=this.mLength;a++)this.val.charAt(a)||(this.val=l.addChars(this.val,this.opts.placeholder,a),this.hldrs[a]=this.opts.placeholder),this._addChar(a);for(;this.chars[this.focus];)this.focus++}else for(var b=0;b<=this.val.length;b++){if(this.delta<=0&&b==this.focus)return!0;this._addChar(b)}},d.prototype._addChar=function(a){var b=this.chars[a];return b?(l.isBetween(a,[this.sel.begin-1,this.newPos+1])&&(this.newPos++,this.delta++),a<=this.focus&&this.focus++,this.hldrs[a]&&(delete this.hldrs[a],this.hldrs[a+1]=this.opts.placeholder),this.val=l.addChars(this.val,b,a),void 0):!0};var g={},h=4,i=new RegExp("{{([^}]+)}}","g"),j=function(a){for(var b,c=[];b=i.exec(a);)c.push(b);return c};g.parse=function(a){var b={inpts:{},chars:{}},c=j(a),d=a.length,e=0,f=0,g=0,i=function(a){for(var c=a.length,d=0;c>d;d++)b.inpts[f]=a.charAt(d),f++;e++,g+=a.length+h-1};for(g;d>g;g++)g==c[e].index?i(c[e][1]):b.chars[g-e*h]=a.charAt(g);return b.mLength=g-e*h,b};var k={};k.get=function(a){if("number"==typeof a.selectionStart)return{begin:a.selectionStart,end:a.selectionEnd};var b=c.selection.createRange();if(b&&b.parentElement()==a){var d=a.createTextRange(),e=a.createTextRange(),f=a.value.length;return d.moveToBookmark(b.getBookmark()),e.collapse(!1),d.compareEndPoints("StartToEnd",e)>-1?{begin:f,end:f}:{begin:-d.moveStart("character",-f),end:-d.moveEnd("character",-f)}}return{begin:0,end:0}},k.set=function(a,b){if(a.setSelectionRange)a.focus(),a.setSelectionRange(b,b);else if(a.createTextRange){var c=a.createTextRange();c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select()}};var l={},m="undefined"!=typeof navigator?navigator.userAgent:null,n=/iphone/i.test(m);l.extend=function(a){for(var b=1;b<arguments.length;b++)for(var c in arguments[b])a[c]=arguments[b][c];return a},l.addChars=function(a,b,c){return a.substr(0,c)+b+a.substr(c,a.length)},l.removeChars=function(a,b,c){return a.substr(0,b)+a.substr(c,a.length)},l.isBetween=function(a,b){return b.sort(function(a,b){return a-b}),a>b[0]&&a<b[1]},l.addListener=function(a,b,c){return"undefined"!=typeof a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},l.preventDefault=function(a){return a.preventDefault?a.preventDefault():a.returnValue=!1},l.getClip=function(a){return a.clipboardData?a.clipboardData.getData("Text"):b.clipboardData?b.clipboardData.getData("Text"):void 0},l.isDelKey=function(a){return 8===a||46===a||n&&127===a},l.isSpecialKey=function(a){var b={9:"tab",13:"enter",35:"end",36:"home",37:"leftarrow",38:"uparrow",39:"rightarrow",40:"downarrow",116:"F5"};return b[a]},l.isModifier=function(a){return a.ctrlKey||a.altKey||a.metaKey};var o="formatter";a.fn[o]=function(b){return"object"==typeof b&&this.each(function(){a.data(this,"plugin_"+o)||a.data(this,"plugin_"+o,new d(this,b))}),this.resetPattern=function(b){return this.each(function(){var c=a.data(this,"plugin_"+o);c&&c.resetPattern(b)}),this},this},a.fn[o].addInptType=function(a,b){d.addInptType(a,b)}}(jQuery,window,document);;
// version 1.6.0
// http://welcome.totheinter.net/columnizer-jquery-plugin/
// created by: Adam Wulf @adamwulf, adam.wulf@gmail.com

(function($){

 $.fn.columnize = function(options) {


	var defaults = {
		// default width of columns
		width: 400,
		// optional # of columns instead of width
		columns : false,
		// true to build columns once regardless of window resize
		// false to rebuild when content box changes bounds
		buildOnce : false,
		// an object with options if the text should overflow
		// it's container if it can't fit within a specified height
		overflow : false,
		// this function is called after content is columnized
		doneFunc : function(){},
		// if the content should be columnized into a 
		// container node other than it's own node
		target : false,
		// re-columnizing when images reload might make things
		// run slow. so flip this to true if it's causing delays
		ignoreImageLoading : true,
		// should columns float left or right
		columnFloat : "left",
		// ensure the last column is never the tallest column
		lastNeverTallest : false,
		// (int) the minimum number of characters to jump when splitting
		// text nodes. smaller numbers will result in higher accuracy
		// column widths, but will take slightly longer
		accuracy : false,
		// don't automatically layout columns, only use manual columnbreak
		manualBreaks : false,
		// previx for all the CSS classes used by this plugin
		// default to empty string for backwards compatibility
		cssClassPrefix : ""
	};
	options = $.extend(defaults, options);

	if(typeof(options.width) == "string"){
		options.width = parseInt(options.width,10);
		if(isNaN(options.width)){
			options.width = defaults.width;
		}
	}

    return this.each(function() {
		var $inBox = options.target ? $(options.target) : $(this);
		var maxHeight = $(this).height();
		var $cache = $('<div></div>'); // this is where we'll put the real content
		var lastWidth = 0;
		var columnizing = false;
		var manualBreaks = options.manualBreaks;
		var cssClassPrefix = defaults.cssClassPrefix;
		if(typeof(options.cssClassPrefix) == "string"){
			cssClassPrefix = options.cssClassPrefix;
		}


		var adjustment = 0;

		$cache.append($(this).contents().clone(true));

		// images loading after dom load
		// can screw up the column heights,
		// so recolumnize after images load
		if(!options.ignoreImageLoading && !options.target){
			if(!$inBox.data("imageLoaded")){
				$inBox.data("imageLoaded", true);
				if($(this).find("img").length > 0){
					// only bother if there are
					// actually images...
					var func = function($inBox,$cache){ return function(){
							if(!$inBox.data("firstImageLoaded")){
								$inBox.data("firstImageLoaded", "true");
								$inBox.empty().append($cache.children().clone(true));
								$inBox.columnize(options);
							}
						};
					}($(this), $cache);
					$(this).find("img").one("load", func);
					$(this).find("img").one("abort", func);
					return;
				}
			}
		}

		$inBox.empty();

		columnizeIt();

		if(!options.buildOnce){
			$(window).resize(function() {
				if(!options.buildOnce){
					if($inBox.data("timeout")){
						clearTimeout($inBox.data("timeout"));
					}
					$inBox.data("timeout", setTimeout(columnizeIt, 200));
				}
			});
		}

		function prefixTheClassName(className, withDot){
			var dot = withDot ? "." : "";
			if(cssClassPrefix.length){
				return dot + cssClassPrefix + "-" + className;
			}
			return dot + className;
		}

		/**
		 * this fuction builds as much of a column as it can without
		 * splitting nodes in half. If the last node in the new column
		 * is a text node, then it will try to split that text node. otherwise
		 * it will leave the node in $pullOutHere and return with a height
		 * smaller than targetHeight.
		 * 
         * Returns a boolean on whether we did some splitting successfully at a text point
         * (so we know we don't need to split a real element). return false if the caller should
         * split a node if possible to end this column.
		 *
		 * @param putInHere, the jquery node to put elements into for the current column
		 * @param $pullOutHere, the jquery node to pull elements out of (uncolumnized html)
		 * @param $parentColumn, the jquery node for the currently column that's being added to
		 * @param targetHeight, the ideal height for the column, get as close as we can to this height
		 */
		function columnize($putInHere, $pullOutHere, $parentColumn, targetHeight){
			//
			// add as many nodes to the column as we can,
			// but stop once our height is too tall
			while((manualBreaks || $parentColumn.height() < targetHeight) &&
				$pullOutHere[0].childNodes.length){
				var node = $pullOutHere[0].childNodes[0];
				//
				// Because we're not cloning, jquery will actually move the element"
				// http://welcome.totheinter.net/2009/03/19/the-undocumented-life-of-jquerys-append/
				if($(node).find(prefixTheClassName("columnbreak", true)).length){
					//
					// our column is on a column break, so just end here
					return;
				}
				if($(node).hasClass(prefixTheClassName("columnbreak"))){
					//
					// our column is on a column break, so just end here
					return;
				}
				$putInHere.append(node);
			}
			if($putInHere[0].childNodes.length === 0) return;

			// now we're too tall, so undo the last one
			var kids = $putInHere[0].childNodes;
			var lastKid = kids[kids.length-1];
			$putInHere[0].removeChild(lastKid);
			var $item = $(lastKid);

			// now lets try to split that last node
			// to fit as much of it as we can into this column
			if($item[0].nodeType == 3){
				// it's a text node, split it up
				var oText = $item[0].nodeValue;
				var counter2 = options.width / 18;
				if(options.accuracy)
				counter2 = options.accuracy;
				var columnText;
				var latestTextNode = null;
				while($parentColumn.height() < targetHeight && oText.length){
					var indexOfSpace = oText.indexOf(' ', counter2);
					if (indexOfSpace != -1) {
						columnText = oText.substring(0, oText.indexOf(' ', counter2));
					} else {
						columnText = oText;
					}
					latestTextNode = document.createTextNode(columnText);
					$putInHere.append(latestTextNode);

					if(oText.length > counter2 && indexOfSpace != -1){
						oText = oText.substring(indexOfSpace);
					}else{
						oText = "";
					}
				}
				if($parentColumn.height() >= targetHeight && latestTextNode !== null){
					// too tall :(
					$putInHere[0].removeChild(latestTextNode);
					oText = latestTextNode.nodeValue + oText;
				}
				if(oText.length){
					$item[0].nodeValue = oText;
				}else{
					return false; // we ate the whole text node, move on to the next node
				}
			}

			if($pullOutHere.contents().length){
				$pullOutHere.prepend($item);
			}else{
				$pullOutHere.append($item);
			}

			return $item[0].nodeType == 3;
		}

		/**
		 * Split up an element, which is more complex than splitting text. We need to create 
		 * two copies of the element with it's contents divided between each
		 */
		function split($putInHere, $pullOutHere, $parentColumn, targetHeight){
			if($putInHere.contents(":last").find(prefixTheClassName("columnbreak", true)).length){
				//
				// our column is on a column break, so just end here
				return;
			}
			if($putInHere.contents(":last").hasClass(prefixTheClassName("columnbreak"))){
				//
				// our column is on a column break, so just end here
				return;
			}
			if($pullOutHere.contents().length){
				var $cloneMe = $pullOutHere.contents(":first");
				//
				// make sure we're splitting an element
				if($cloneMe.get(0).nodeType != 1) return;

				//
				// clone the node with all data and events
				var $clone = $cloneMe.clone(true);
				//
				// need to support both .prop and .attr if .prop doesn't exist.
				// this is for backwards compatibility with older versions of jquery.
				if($cloneMe.hasClass(prefixTheClassName("columnbreak"))){
					//
					// ok, we have a columnbreak, so add it into
					// the column and exit
					$putInHere.append($clone);
					$cloneMe.remove();
				}else if (manualBreaks){
					// keep adding until we hit a manual break
					$putInHere.append($clone);
					$cloneMe.remove();
				}else if($clone.get(0).nodeType == 1 && !$clone.hasClass(prefixTheClassName("dontend"))){
					$putInHere.append($clone);
					if($clone.is("img") && $parentColumn.height() < targetHeight + 20){
						//
						// we can't split an img in half, so just add it
						// to the column and remove it from the pullOutHere section
						$cloneMe.remove();
					}else if(!$cloneMe.hasClass(prefixTheClassName("dontsplit")) && $parentColumn.height() < targetHeight + 20){
						//
						// pretty close fit, and we're not allowed to split it, so just
						// add it to the column, remove from pullOutHere, and be done
						$cloneMe.remove();
					}else if($clone.is("img") || $cloneMe.hasClass(prefixTheClassName("dontsplit"))){
						//
						// it's either an image that's too tall, or an unsplittable node
						// that's too tall. leave it in the pullOutHere and we'll add it to the 
						// next column
						$clone.remove();
					}else{
						//
						// ok, we're allowed to split the node in half, so empty out
						// the node in the column we're building, and start splitting
						// it in half, leaving some of it in pullOutHere
						$clone.empty();
						if(!columnize($clone, $cloneMe, $parentColumn, targetHeight)){
							// this node still has non-text nodes to split
							// add the split class and then recur
							$cloneMe.addClass(prefixTheClassName("split"));
							if($cloneMe.children().length){
								split($clone, $cloneMe, $parentColumn, targetHeight);
							}
						}else{
							// this node only has text node children left, add the
							// split class and move on.
							$cloneMe.addClass(prefixTheClassName("split"));
						}
						if($clone.get(0).childNodes.length === 0){
							// it was split, but nothing is in it :(
							$clone.remove();
						}
					}
				}
			}
		}


		function singleColumnizeIt() {
			if ($inBox.data("columnized") && $inBox.children().length == 1) {
				return;
			}
			$inBox.data("columnized", true);
			$inBox.data("columnizing", true);

			$inBox.empty();
			$inBox.append($("<div class='"
				+ prefixTheClassName("first") + " "
				+ prefixTheClassName("last") + " "
				+ prefixTheClassName("column") + " "
				+ "' style='width:100%; float: " + options.columnFloat + ";'></div>")); //"
			$col = $inBox.children().eq($inBox.children().length-1);
			$destroyable = $cache.clone(true);
			if(options.overflow){
				targetHeight = options.overflow.height;
				columnize($col, $destroyable, $col, targetHeight);
				// make sure that the last item in the column isn't a "dontend"
				if(!$destroyable.contents().find(":first-child").hasClass(prefixTheClassName("dontend"))){
					split($col, $destroyable, $col, targetHeight);
				}

				while($col.contents(":last").length && checkDontEndColumn($col.contents(":last").get(0))){
					var $lastKid = $col.contents(":last");
					$lastKid.remove();
					$destroyable.prepend($lastKid);
				}

				var html = "";
				var div = document.createElement('DIV');
				while($destroyable[0].childNodes.length > 0){
					var kid = $destroyable[0].childNodes[0];
					if(kid.attributes){
						for(var i=0;i<kid.attributes.length;i++){
							if(kid.attributes[i].nodeName.indexOf("jQuery") === 0){
								kid.removeAttribute(kid.attributes[i].nodeName);
							}
						}
					}
					div.innerHTML = "";
					div.appendChild($destroyable[0].childNodes[0]);
					html += div.innerHTML;
				}
				var overflow = $(options.overflow.id)[0];
				overflow.innerHTML = html;

			}else{
				$col.append($destroyable);
			}
			$inBox.data("columnizing", false);

			if(options.overflow && options.overflow.doneFunc){
				options.overflow.doneFunc();
			}

		}

		/**
		 * returns true if the input dom node
		 * should not end a column.
		 * returns false otherwise
		 */
		function checkDontEndColumn(dom){
			if(dom.nodeType == 3){
				// text node. ensure that the text
				// is not 100% whitespace
				if(/^\s+$/.test(dom.nodeValue)){
						//
						// ok, it's 100% whitespace,
						// so we should return checkDontEndColumn
						// of the inputs previousSibling
						if(!dom.previousSibling) return false;
					return checkDontEndColumn(dom.previousSibling);
				}
				return false;
			}
			if(dom.nodeType != 1) return false;
			if($(dom).hasClass(prefixTheClassName("dontend"))) return true;
			if(dom.childNodes.length === 0) return false;
			return checkDontEndColumn(dom.childNodes[dom.childNodes.length-1]);
		}

		function columnizeIt() {
			//reset adjustment var
			adjustment = 0;
			if(lastWidth == $inBox.width()) return;
			lastWidth = $inBox.width();

			var numCols = Math.round($inBox.width() / options.width);
			var optionWidth = options.width;
			var optionHeight = options.height;
			if(options.columns) numCols = options.columns;
			if(manualBreaks){
				numCols = $cache.find(prefixTheClassName("columnbreak", true)).length + 1;
				optionWidth = false;
			}

//			if ($inBox.data("columnized") && numCols == $inBox.children().length) {
//				return;
//			}
			if(numCols <= 1){
				return singleColumnizeIt();
			}
			if($inBox.data("columnizing")) return;
			$inBox.data("columnized", true);
			$inBox.data("columnizing", true);

			$inBox.empty();
			$inBox.append($("<div style='width:" + (Math.floor(100 / numCols))+ "%; float: " + options.columnFloat + ";'></div>")); //"
			$col = $inBox.children(":last");
			$col.append($cache.clone());
			maxHeight = $col.height();
			$inBox.empty();

			var targetHeight = maxHeight / numCols;
			var firstTime = true;
			var maxLoops = 3;
			var scrollHorizontally = false;
			if(options.overflow){
				maxLoops = 1;
				targetHeight = options.overflow.height;
			}else if(optionHeight && optionWidth){
				maxLoops = 1;
				targetHeight = optionHeight;
				scrollHorizontally = true;
			}

			//
			// We loop as we try and workout a good height to use. We know it initially as an average 
			// but if the last column is higher than the first ones (which can happen, depending on split
			// points) we need to raise 'adjustment'. We try this over a few iterations until we're 'solid'.
			//
			// also, lets hard code the max loops to 20. that's /a lot/ of loops for columnizer,
			// and should keep run aways in check. if somehow someone has content combined with
			// options that would cause an infinite loop, then this'll definitely stop it.
			for(var loopCount=0;loopCount<maxLoops && loopCount<20;loopCount++){
				$inBox.empty();
				var $destroyable, className, $col, $lastKid;
				try{
					$destroyable = $cache.clone(true);
				}catch(e){
					// jquery in ie6 can't clone with true
					$destroyable = $cache.clone();
				}
				$destroyable.css("visibility", "hidden");
				// create the columns
				for (var i = 0; i < numCols; i++) {
					/* create column */
					className = (i === 0) ? prefixTheClassName("first") : "";
					className += " " + prefixTheClassName("column");
					className = (i == numCols - 1) ? (prefixTheClassName("last") + " " + className) : className;
					$inBox.append($("<div class='" + className + "' style='width:" + (Math.floor(100 / numCols))+ "%; float: " + options.columnFloat + ";'></div>")); //"
				}

				// fill all but the last column (unless overflowing)
				i = 0;
				while(i < numCols - (options.overflow ? 0 : 1) || scrollHorizontally && $destroyable.contents().length){
					if($inBox.children().length <= i){
						// we ran out of columns, make another
						$inBox.append($("<div class='" + className + "' style='width:" + (Math.floor(100 / numCols))+ "%; float: " + options.columnFloat + ";'></div>")); //"
					}
					$col = $inBox.children().eq(i);
					if(scrollHorizontally){
						$col.width(optionWidth + "px");
					}
					columnize($col, $destroyable, $col, targetHeight);
					// make sure that the last item in the column isn't a "dontend"
					split($col, $destroyable, $col, targetHeight);

					while($col.contents(":last").length && checkDontEndColumn($col.contents(":last").get(0))){
						$lastKid = $col.contents(":last");
						$lastKid.remove();
						$destroyable.prepend($lastKid);
					}
					i++;

					//
					// https://github.com/adamwulf/Columnizer-jQuery-Plugin/issues/47
					//
					// check for infinite loop.
					//
					// this could happen when a dontsplit or dontend item is taller than the column
					// we're trying to build, and its never actually added to a column.
					//
					// this results in empty columns being added with the dontsplit item
					// perpetually waiting to get put into a column. lets force the issue here
					if($col.contents().length === 0 && $destroyable.contents().length){
						//
						// ok, we're building zero content columns. this'll happen forever
						// since nothing can ever get taken out of destroyable.
						//
						// to fix, lets put 1 item from destroyable into the empty column
						// before we iterate
						$col.append($destroyable.contents(":first"));
					}else if(i == numCols - (options.overflow ? 0 : 1) && !options.overflow){
						//
						// ok, we're about to exit the while loop because we're done with all
						// columns except the last column.
						//
						// if $destroyable still has columnbreak nodes in it, then we need to keep
						// looping and creating more columns.
						if($destroyable.find(prefixTheClassName("columnbreak", true)).length){
							numCols ++;
						}
					}
				}
				if(options.overflow && !scrollHorizontally){
					var IE6 = false /*@cc_on || @_jscript_version < 5.7 @*/;
					var IE7 = (document.all) && (navigator.appVersion.indexOf("MSIE 7.") != -1);
					if(IE6 || IE7){
						var html = "";
						var div = document.createElement('DIV');
						while($destroyable[0].childNodes.length > 0){
							var kid = $destroyable[0].childNodes[0];
							for(i=0;i<kid.attributes.length;i++){
								if(kid.attributes[i].nodeName.indexOf("jQuery") === 0){
									kid.removeAttribute(kid.attributes[i].nodeName);
								}
							}
							div.innerHTML = "";
							div.appendChild($destroyable[0].childNodes[0]);
							html += div.innerHTML;
						}
						var overflow = $(options.overflow.id)[0];
						overflow.innerHTML = html;
					}else{
						$(options.overflow.id).empty().append($destroyable.contents().clone(true));
					}
				}else if(!scrollHorizontally){
					// the last column in the series
					$col = $inBox.children().eq($inBox.children().length-1);
					$destroyable.contents().each( function() {
						$col.append( $(this) );
					});
					var afterH = $col.height();
					var diff = afterH - targetHeight;
					var totalH = 0;
					var min = 10000000;
					var max = 0;
					var lastIsMax = false;
					var numberOfColumnsThatDontEndInAColumnBreak = 0;
					$inBox.children().each(function($inBox){ return function($item){
						var $col = $inBox.children().eq($item);
						var endsInBreak = $col.children(":last").find(prefixTheClassName("columnbreak", true)).length;
						if(!endsInBreak){
							var h = $col.height();
							lastIsMax = false;
							totalH += h;
							if(h > max) {
								max = h;
								lastIsMax = true;
							}
							if(h < min) min = h;
							numberOfColumnsThatDontEndInAColumnBreak++;
						}
					};
				}($inBox));

					var avgH = totalH / numberOfColumnsThatDontEndInAColumnBreak;
					if(totalH === 0){
						//
						// all columns end in a column break,
						// so we're done here
						loopCount = maxLoops;
					}else if(options.lastNeverTallest && lastIsMax){
						// the last column is the tallest
						// so allow columns to be taller
						// and retry
						//
						// hopefully this'll mean more content fits into
						// earlier columns, so that the last column
						// can be shorter than the rest
						adjustment += 30;

						targetHeight = targetHeight + 30;
						if(loopCount == maxLoops-1) maxLoops++;
					}else if(max - min > 30){
						// too much variation, try again
						targetHeight = avgH + 30;
					}else if(Math.abs(avgH-targetHeight) > 20){
						// too much variation, try again
						targetHeight = avgH;
					}else {
						// solid, we're done
						loopCount = maxLoops;
					}
				}else{
					// it's scrolling horizontally, fix the width/classes of the columns
					$inBox.children().each(function(i){
						$col = $inBox.children().eq(i);
						$col.width(optionWidth + "px");
						if(i === 0){
							$col.addClass(prefixTheClassName("first"));
						}else if(i==$inBox.children().length-1){
							$col.addClass(prefixTheClassName("last"));
						}else{
							$col.removeClass(prefixTheClassName("first"));
							$col.removeClass(prefixTheClassName("last"));
						}
					});
					$inBox.width($inBox.children().length * optionWidth + "px");
				}
				$inBox.append($("<br style='clear:both;'>"));
			}
			$inBox.find(prefixTheClassName("column", true)).find(":first" + prefixTheClassName("removeiffirst", true)).remove();
			$inBox.find(prefixTheClassName("column", true)).find(':last' + prefixTheClassName("removeiflast", true)).remove();
			$inBox.data("columnizing", false);

			if(options.overflow){
				options.overflow.doneFunc();
			}
			options.doneFunc();
		}
    });
 };
})(jQuery);
;
/*!
* jQuery Cycle2; build: v20131022
* http://jquery.malsup.com/cycle2/
* Copyright (c) 2013 M. Alsup; Dual licensed: MIT/GPL
*/
/*! core engine; version: 20131003 */
(function(e){"use strict";function t(e){return(e||"").toLowerCase()}var i="20131003";e.fn.cycle=function(i){var n;return 0!==this.length||e.isReady?this.each(function(){var n,s,o,c,r=e(this),l=e.fn.cycle.log;if(!r.data("cycle.opts")){(r.data("cycle-log")===!1||i&&i.log===!1||s&&s.log===!1)&&(l=e.noop),l("--c2 init--"),n=r.data();for(var a in n)n.hasOwnProperty(a)&&/^cycle[A-Z]+/.test(a)&&(c=n[a],o=a.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,t),l(o+":",c,"("+typeof c+")"),n[o]=c);s=e.extend({},e.fn.cycle.defaults,n,i||{}),s.timeoutId=0,s.paused=s.paused||!1,s.container=r,s._maxZ=s.maxZ,s.API=e.extend({_container:r},e.fn.cycle.API),s.API.log=l,s.API.trigger=function(e,t){return s.container.trigger(e,t),s.API},r.data("cycle.opts",s),r.data("cycle.API",s.API),s.API.trigger("cycle-bootstrap",[s,s.API]),s.API.addInitialSlides(),s.API.preInitSlideshow(),s.slides.length&&s.API.initSlideshow()}}):(n={s:this.selector,c:this.context},e.fn.cycle.log("requeuing slideshow (dom not ready)"),e(function(){e(n.s,n.c).cycle(i)}),this)},e.fn.cycle.API={opts:function(){return this._container.data("cycle.opts")},addInitialSlides:function(){var t=this.opts(),i=t.slides;t.slideCount=0,t.slides=e(),i=i.jquery?i:t.container.find(i),t.random&&i.sort(function(){return Math.random()-.5}),t.API.add(i)},preInitSlideshow:function(){var t=this.opts();t.API.trigger("cycle-pre-initialize",[t]);var i=e.fn.cycle.transitions[t.fx];i&&e.isFunction(i.preInit)&&i.preInit(t),t._preInitialized=!0},postInitSlideshow:function(){var t=this.opts();t.API.trigger("cycle-post-initialize",[t]);var i=e.fn.cycle.transitions[t.fx];i&&e.isFunction(i.postInit)&&i.postInit(t)},initSlideshow:function(){var t,i=this.opts(),n=i.container;i.API.calcFirstSlide(),"static"==i.container.css("position")&&i.container.css("position","relative"),e(i.slides[i.currSlide]).css("opacity",1).show(),i.API.stackSlides(i.slides[i.currSlide],i.slides[i.nextSlide],!i.reverse),i.pauseOnHover&&(i.pauseOnHover!==!0&&(n=e(i.pauseOnHover)),n.hover(function(){i.API.pause(!0)},function(){i.API.resume(!0)})),i.timeout&&(t=i.API.getSlideOpts(i.currSlide),i.API.queueTransition(t,t.timeout+i.delay)),i._initialized=!0,i.API.updateView(!0),i.API.trigger("cycle-initialized",[i]),i.API.postInitSlideshow()},pause:function(t){var i=this.opts(),n=i.API.getSlideOpts(),s=i.hoverPaused||i.paused;t?i.hoverPaused=!0:i.paused=!0,s||(i.container.addClass("cycle-paused"),i.API.trigger("cycle-paused",[i]).log("cycle-paused"),n.timeout&&(clearTimeout(i.timeoutId),i.timeoutId=0,i._remainingTimeout-=e.now()-i._lastQueue,(0>i._remainingTimeout||isNaN(i._remainingTimeout))&&(i._remainingTimeout=void 0)))},resume:function(e){var t=this.opts(),i=!t.hoverPaused&&!t.paused;e?t.hoverPaused=!1:t.paused=!1,i||(t.container.removeClass("cycle-paused"),0===t.slides.filter(":animated").length&&t.API.queueTransition(t.API.getSlideOpts(),t._remainingTimeout),t.API.trigger("cycle-resumed",[t,t._remainingTimeout]).log("cycle-resumed"))},add:function(t,i){var n,s=this.opts(),o=s.slideCount,c=!1;"string"==e.type(t)&&(t=e.trim(t)),e(t).each(function(){var t,n=e(this);i?s.container.prepend(n):s.container.append(n),s.slideCount++,t=s.API.buildSlideOpts(n),s.slides=i?e(n).add(s.slides):s.slides.add(n),s.API.initSlide(t,n,--s._maxZ),n.data("cycle.opts",t),s.API.trigger("cycle-slide-added",[s,t,n])}),s.API.updateView(!0),c=s._preInitialized&&2>o&&s.slideCount>=1,c&&(s._initialized?s.timeout&&(n=s.slides.length,s.nextSlide=s.reverse?n-1:1,s.timeoutId||s.API.queueTransition(s)):s.API.initSlideshow())},calcFirstSlide:function(){var e,t=this.opts();e=parseInt(t.startingSlide||0,10),(e>=t.slides.length||0>e)&&(e=0),t.currSlide=e,t.reverse?(t.nextSlide=e-1,0>t.nextSlide&&(t.nextSlide=t.slides.length-1)):(t.nextSlide=e+1,t.nextSlide==t.slides.length&&(t.nextSlide=0))},calcNextSlide:function(){var e,t=this.opts();t.reverse?(e=0>t.nextSlide-1,t.nextSlide=e?t.slideCount-1:t.nextSlide-1,t.currSlide=e?0:t.nextSlide+1):(e=t.nextSlide+1==t.slides.length,t.nextSlide=e?0:t.nextSlide+1,t.currSlide=e?t.slides.length-1:t.nextSlide-1)},calcTx:function(t,i){var n,s=t;return i&&s.manualFx&&(n=e.fn.cycle.transitions[s.manualFx]),n||(n=e.fn.cycle.transitions[s.fx]),n||(n=e.fn.cycle.transitions.fade,s.API.log('Transition "'+s.fx+'" not found.  Using fade.')),n},prepareTx:function(e,t){var i,n,s,o,c,r=this.opts();return 2>r.slideCount?(r.timeoutId=0,void 0):(!e||r.busy&&!r.manualTrump||(r.API.stopTransition(),r.busy=!1,clearTimeout(r.timeoutId),r.timeoutId=0),r.busy||(0!==r.timeoutId||e)&&(n=r.slides[r.currSlide],s=r.slides[r.nextSlide],o=r.API.getSlideOpts(r.nextSlide),c=r.API.calcTx(o,e),r._tx=c,e&&void 0!==o.manualSpeed&&(o.speed=o.manualSpeed),r.nextSlide!=r.currSlide&&(e||!r.paused&&!r.hoverPaused&&r.timeout)?(r.API.trigger("cycle-before",[o,n,s,t]),c.before&&c.before(o,n,s,t),i=function(){r.busy=!1,r.container.data("cycle.opts")&&(c.after&&c.after(o,n,s,t),r.API.trigger("cycle-after",[o,n,s,t]),r.API.queueTransition(o),r.API.updateView(!0))},r.busy=!0,c.transition?c.transition(o,n,s,t,i):r.API.doTransition(o,n,s,t,i),r.API.calcNextSlide(),r.API.updateView()):r.API.queueTransition(o)),void 0)},doTransition:function(t,i,n,s,o){var c=t,r=e(i),l=e(n),a=function(){l.animate(c.animIn||{opacity:1},c.speed,c.easeIn||c.easing,o)};l.css(c.cssBefore||{}),r.animate(c.animOut||{},c.speed,c.easeOut||c.easing,function(){r.css(c.cssAfter||{}),c.sync||a()}),c.sync&&a()},queueTransition:function(t,i){var n=this.opts(),s=void 0!==i?i:t.timeout;return 0===n.nextSlide&&0===--n.loop?(n.API.log("terminating; loop=0"),n.timeout=0,s?setTimeout(function(){n.API.trigger("cycle-finished",[n])},s):n.API.trigger("cycle-finished",[n]),n.nextSlide=n.currSlide,void 0):(s&&(n._lastQueue=e.now(),void 0===i&&(n._remainingTimeout=t.timeout),n.paused||n.hoverPaused||(n.timeoutId=setTimeout(function(){n.API.prepareTx(!1,!n.reverse)},s))),void 0)},stopTransition:function(){var e=this.opts();e.slides.filter(":animated").length&&(e.slides.stop(!1,!0),e.API.trigger("cycle-transition-stopped",[e])),e._tx&&e._tx.stopTransition&&e._tx.stopTransition(e)},advanceSlide:function(e){var t=this.opts();return clearTimeout(t.timeoutId),t.timeoutId=0,t.nextSlide=t.currSlide+e,0>t.nextSlide?t.nextSlide=t.slides.length-1:t.nextSlide>=t.slides.length&&(t.nextSlide=0),t.API.prepareTx(!0,e>=0),!1},buildSlideOpts:function(i){var n,s,o=this.opts(),c=i.data()||{};for(var r in c)c.hasOwnProperty(r)&&/^cycle[A-Z]+/.test(r)&&(n=c[r],s=r.match(/^cycle(.*)/)[1].replace(/^[A-Z]/,t),o.API.log("["+(o.slideCount-1)+"]",s+":",n,"("+typeof n+")"),c[s]=n);c=e.extend({},e.fn.cycle.defaults,o,c),c.slideNum=o.slideCount;try{delete c.API,delete c.slideCount,delete c.currSlide,delete c.nextSlide,delete c.slides}catch(l){}return c},getSlideOpts:function(t){var i=this.opts();void 0===t&&(t=i.currSlide);var n=i.slides[t],s=e(n).data("cycle.opts");return e.extend({},i,s)},initSlide:function(t,i,n){var s=this.opts();i.css(t.slideCss||{}),n>0&&i.css("zIndex",n),isNaN(t.speed)&&(t.speed=e.fx.speeds[t.speed]||e.fx.speeds._default),t.sync||(t.speed=t.speed/2),i.addClass(s.slideClass)},updateView:function(e,t){var i=this.opts();if(i._initialized){var n=i.API.getSlideOpts(),s=i.slides[i.currSlide];!e&&t!==!0&&(i.API.trigger("cycle-update-view-before",[i,n,s]),0>i.updateView)||(i.slideActiveClass&&i.slides.removeClass(i.slideActiveClass).eq(i.currSlide).addClass(i.slideActiveClass),e&&i.hideNonActive&&i.slides.filter(":not(."+i.slideActiveClass+")").hide(),0===i.updateView&&setTimeout(function(){i.API.trigger("cycle-update-view",[i,n,s,e])},n.speed/(i.sync?2:1)),0!==i.updateView&&i.API.trigger("cycle-update-view",[i,n,s,e]),e&&i.API.trigger("cycle-update-view-after",[i,n,s]))}},getComponent:function(t){var i=this.opts(),n=i[t];return"string"==typeof n?/^\s*[\>|\+|~]/.test(n)?i.container.find(n):e(n):n.jquery?n:e(n)},stackSlides:function(t,i,n){var s=this.opts();t||(t=s.slides[s.currSlide],i=s.slides[s.nextSlide],n=!s.reverse),e(t).css("zIndex",s.maxZ);var o,c=s.maxZ-2,r=s.slideCount;if(n){for(o=s.currSlide+1;r>o;o++)e(s.slides[o]).css("zIndex",c--);for(o=0;s.currSlide>o;o++)e(s.slides[o]).css("zIndex",c--)}else{for(o=s.currSlide-1;o>=0;o--)e(s.slides[o]).css("zIndex",c--);for(o=r-1;o>s.currSlide;o--)e(s.slides[o]).css("zIndex",c--)}e(i).css("zIndex",s.maxZ-1)},getSlideIndex:function(e){return this.opts().slides.index(e)}},e.fn.cycle.log=function(){window.console&&console.log&&console.log("[cycle2] "+Array.prototype.join.call(arguments," "))},e.fn.cycle.version=function(){return"Cycle2: "+i},e.fn.cycle.transitions={custom:{},none:{before:function(e,t,i,n){e.API.stackSlides(i,t,n),e.cssBefore={opacity:1,display:"block"}}},fade:{before:function(t,i,n,s){var o=t.API.getSlideOpts(t.nextSlide).slideCss||{};t.API.stackSlides(i,n,s),t.cssBefore=e.extend(o,{opacity:0,display:"block"}),t.animIn={opacity:1},t.animOut={opacity:0}}},fadeout:{before:function(t,i,n,s){var o=t.API.getSlideOpts(t.nextSlide).slideCss||{};t.API.stackSlides(i,n,s),t.cssBefore=e.extend(o,{opacity:1,display:"block"}),t.animOut={opacity:0}}},scrollHorz:{before:function(e,t,i,n){e.API.stackSlides(t,i,n);var s=e.container.css("overflow","hidden").width();e.cssBefore={left:n?s:-s,top:0,opacity:1,display:"block"},e.cssAfter={zIndex:e._maxZ-2,left:0},e.animIn={left:0},e.animOut={left:n?-s:s}}}},e.fn.cycle.defaults={allowWrap:!0,autoSelector:".cycle-slideshow[data-cycle-auto-init!=false]",delay:0,easing:null,fx:"fade",hideNonActive:!0,loop:0,manualFx:void 0,manualSpeed:void 0,manualTrump:!0,maxZ:100,pauseOnHover:!1,reverse:!1,slideActiveClass:"cycle-slide-active",slideClass:"cycle-slide",slideCss:{position:"absolute",top:0,left:0},slides:"> img",speed:500,startingSlide:0,sync:!0,timeout:4e3,updateView:0},e(document).ready(function(){e(e.fn.cycle.defaults.autoSelector).cycle()})})(jQuery),/*! Cycle2 autoheight plugin; Copyright (c) M.Alsup, 2012; version: 20130304 */
function(e){"use strict";function t(t,n){var s,o,c,r=n.autoHeight;if("container"==r)o=e(n.slides[n.currSlide]).outerHeight(),n.container.height(o);else if(n._autoHeightRatio)n.container.height(n.container.width()/n._autoHeightRatio);else if("calc"===r||"number"==e.type(r)&&r>=0){if(c="calc"===r?i(t,n):r>=n.slides.length?0:r,c==n._sentinelIndex)return;n._sentinelIndex=c,n._sentinel&&n._sentinel.remove(),s=e(n.slides[c].cloneNode(!0)),s.removeAttr("id name rel").find("[id],[name],[rel]").removeAttr("id name rel"),s.css({position:"static",visibility:"hidden",display:"block"}).prependTo(n.container).addClass("cycle-sentinel cycle-slide").removeClass("cycle-slide-active"),s.find("*").css("visibility","hidden"),n._sentinel=s}}function i(t,i){var n=0,s=-1;return i.slides.each(function(t){var i=e(this).height();i>s&&(s=i,n=t)}),n}function n(t,i,n,s){var o=e(s).outerHeight(),c=i.sync?i.speed/2:i.speed;i.container.animate({height:o},c)}function s(i,o){o._autoHeightOnResize&&(e(window).off("resize orientationchange",o._autoHeightOnResize),o._autoHeightOnResize=null),o.container.off("cycle-slide-added cycle-slide-removed",t),o.container.off("cycle-destroyed",s),o.container.off("cycle-before",n),o._sentinel&&(o._sentinel.remove(),o._sentinel=null)}e.extend(e.fn.cycle.defaults,{autoHeight:0}),e(document).on("cycle-initialized",function(i,o){function c(){t(i,o)}var r,l=o.autoHeight,a=e.type(l),d=null;("string"===a||"number"===a)&&(o.container.on("cycle-slide-added cycle-slide-removed",t),o.container.on("cycle-destroyed",s),"container"==l?o.container.on("cycle-before",n):"string"===a&&/\d+\:\d+/.test(l)&&(r=l.match(/(\d+)\:(\d+)/),r=r[1]/r[2],o._autoHeightRatio=r),"number"!==a&&(o._autoHeightOnResize=function(){clearTimeout(d),d=setTimeout(c,50)},e(window).on("resize orientationchange",o._autoHeightOnResize)),setTimeout(c,30))})}(jQuery),/*! caption plugin for Cycle2;  version: 20130306 */
function(e){"use strict";e.extend(e.fn.cycle.defaults,{caption:"> .cycle-caption",captionTemplate:"{{slideNum}} / {{slideCount}}",overlay:"> .cycle-overlay",overlayTemplate:"<div>{{title}}</div><div>{{desc}}</div>",captionModule:"caption"}),e(document).on("cycle-update-view",function(t,i,n,s){"caption"===i.captionModule&&e.each(["caption","overlay"],function(){var e=this,t=n[e+"Template"],o=i.API.getComponent(e);o.length&&t?(o.html(i.API.tmpl(t,n,i,s)),o.show()):o.hide()})}),e(document).on("cycle-destroyed",function(t,i){var n;e.each(["caption","overlay"],function(){var e=this,t=i[e+"Template"];i[e]&&t&&(n=i.API.getComponent("caption"),n.empty())})})}(jQuery),/*! command plugin for Cycle2;  version: 20130707 */
function(e){"use strict";var t=e.fn.cycle;e.fn.cycle=function(i){var n,s,o,c=e.makeArray(arguments);return"number"==e.type(i)?this.cycle("goto",i):"string"==e.type(i)?this.each(function(){var r;return n=i,o=e(this).data("cycle.opts"),void 0===o?(t.log('slideshow must be initialized before sending commands; "'+n+'" ignored'),void 0):(n="goto"==n?"jump":n,s=o.API[n],e.isFunction(s)?(r=e.makeArray(c),r.shift(),s.apply(o.API,r)):(t.log("unknown command: ",n),void 0))}):t.apply(this,arguments)},e.extend(e.fn.cycle,t),e.extend(t.API,{next:function(){var e=this.opts();if(!e.busy||e.manualTrump){var t=e.reverse?-1:1;e.allowWrap===!1&&e.currSlide+t>=e.slideCount||(e.API.advanceSlide(t),e.API.trigger("cycle-next",[e]).log("cycle-next"))}},prev:function(){var e=this.opts();if(!e.busy||e.manualTrump){var t=e.reverse?1:-1;e.allowWrap===!1&&0>e.currSlide+t||(e.API.advanceSlide(t),e.API.trigger("cycle-prev",[e]).log("cycle-prev"))}},destroy:function(){this.stop();var t=this.opts(),i=e.isFunction(e._data)?e._data:e.noop;clearTimeout(t.timeoutId),t.timeoutId=0,t.API.stop(),t.API.trigger("cycle-destroyed",[t]).log("cycle-destroyed"),t.container.removeData(),i(t.container[0],"parsedAttrs",!1),t.retainStylesOnDestroy||(t.container.removeAttr("style"),t.slides.removeAttr("style"),t.slides.removeClass(t.slideActiveClass)),t.slides.each(function(){e(this).removeData(),i(this,"parsedAttrs",!1)})},jump:function(e){var t,i=this.opts();if(!i.busy||i.manualTrump){var n=parseInt(e,10);if(isNaN(n)||0>n||n>=i.slides.length)return i.API.log("goto: invalid slide index: "+n),void 0;if(n==i.currSlide)return i.API.log("goto: skipping, already on slide",n),void 0;i.nextSlide=n,clearTimeout(i.timeoutId),i.timeoutId=0,i.API.log("goto: ",n," (zero-index)"),t=i.currSlide<i.nextSlide,i.API.prepareTx(!0,t)}},stop:function(){var t=this.opts(),i=t.container;clearTimeout(t.timeoutId),t.timeoutId=0,t.API.stopTransition(),t.pauseOnHover&&(t.pauseOnHover!==!0&&(i=e(t.pauseOnHover)),i.off("mouseenter mouseleave")),t.API.trigger("cycle-stopped",[t]).log("cycle-stopped")},reinit:function(){var e=this.opts();e.API.destroy(),e.container.cycle()},remove:function(t){for(var i,n,s=this.opts(),o=[],c=1,r=0;s.slides.length>r;r++)i=s.slides[r],r==t?n=i:(o.push(i),e(i).data("cycle.opts").slideNum=c,c++);n&&(s.slides=e(o),s.slideCount--,e(n).remove(),t==s.currSlide?s.API.advanceSlide(1):s.currSlide>t?s.currSlide--:s.currSlide++,s.API.trigger("cycle-slide-removed",[s,t,n]).log("cycle-slide-removed"),s.API.updateView())}}),e(document).on("click.cycle","[data-cycle-cmd]",function(t){t.preventDefault();var i=e(this),n=i.data("cycle-cmd"),s=i.data("cycle-context")||".cycle-slideshow";e(s).cycle(n,i.data("cycle-arg"))})}(jQuery),/*! hash plugin for Cycle2;  version: 20130905 */
function(e){"use strict";function t(t,i){var n;return t._hashFence?(t._hashFence=!1,void 0):(n=window.location.hash.substring(1),t.slides.each(function(s){if(e(this).data("cycle-hash")==n){if(i===!0)t.startingSlide=s;else{var o=s>t.currSlide;t.nextSlide=s,t.API.prepareTx(!0,o)}return!1}}),void 0)}e(document).on("cycle-pre-initialize",function(i,n){t(n,!0),n._onHashChange=function(){t(n,!1)},e(window).on("hashchange",n._onHashChange)}),e(document).on("cycle-update-view",function(e,t,i){i.hash&&"#"+i.hash!=window.location.hash&&(t._hashFence=!0,window.location.hash=i.hash)}),e(document).on("cycle-destroyed",function(t,i){i._onHashChange&&e(window).off("hashchange",i._onHashChange)})}(jQuery),/*! loader plugin for Cycle2;  version: 20131020 */
function(e){"use strict";e.extend(e.fn.cycle.defaults,{loader:!1}),e(document).on("cycle-bootstrap",function(t,i){function n(t,n){function o(t){var o;"wait"==i.loader?(r.push(t),0===a&&(r.sort(c),s.apply(i.API,[r,n]),i.container.removeClass("cycle-loading"))):(o=e(i.slides[i.currSlide]),s.apply(i.API,[t,n]),o.show(),i.container.removeClass("cycle-loading"))}function c(e,t){return e.data("index")-t.data("index")}var r=[];if("string"==e.type(t))t=e.trim(t);else if("array"===e.type(t))for(var l=0;t.length>l;l++)t[l]=e(t[l])[0];t=e(t);var a=t.length;a&&(i.eventualSlideCount=i.slideCount+a,t.hide().appendTo("body").each(function(t){function c(){0===--l&&(--a,o(d))}var l=0,d=e(this),u=d.is("img")?d:d.find("img");return d.data("index",t),u=u.filter(":not(.cycle-loader-ignore)").filter(':not([src=""])'),u.length?(l=u.length,u.each(function(){this.complete?c():e(this).load(function(){c()}).error(function(){0===--l&&(i.API.log("slide skipped; img not loaded:",this.src),0===--a&&"wait"==i.loader&&s.apply(i.API,[r,n]))})}),void 0):(--a,r.push(d),void 0)}),a&&i.container.addClass("cycle-loading"))}var s;i.loader&&(s=i.API.add,i.API.add=n)})}(jQuery),/*! pager plugin for Cycle2;  version: 20130525 */
function(e){"use strict";function t(t,i,n){var s,o=t.API.getComponent("pager");o.each(function(){var o=e(this);if(i.pagerTemplate){var c=t.API.tmpl(i.pagerTemplate,i,t,n[0]);s=e(c).appendTo(o)}else s=o.children().eq(t.slideCount-1);s.on(t.pagerEvent,function(e){e.preventDefault(),t.API.page(o,e.currentTarget)})})}function i(e,t){var i=this.opts();if(!i.busy||i.manualTrump){var n=e.children().index(t),s=n,o=s>i.currSlide;i.currSlide!=s&&(i.nextSlide=s,i.API.prepareTx(!0,o),i.API.trigger("cycle-pager-activated",[i,e,t]))}}e.extend(e.fn.cycle.defaults,{pager:"> .cycle-pager",pagerActiveClass:"cycle-pager-active",pagerEvent:"click.cycle",pagerTemplate:"<span>&bull;</span>"}),e(document).on("cycle-bootstrap",function(e,i,n){n.buildPagerLink=t}),e(document).on("cycle-slide-added",function(e,t,n,s){t.pager&&(t.API.buildPagerLink(t,n,s),t.API.page=i)}),e(document).on("cycle-slide-removed",function(t,i,n){if(i.pager){var s=i.API.getComponent("pager");s.each(function(){var t=e(this);e(t.children()[n]).remove()})}}),e(document).on("cycle-update-view",function(t,i){var n;i.pager&&(n=i.API.getComponent("pager"),n.each(function(){e(this).children().removeClass(i.pagerActiveClass).eq(i.currSlide).addClass(i.pagerActiveClass)}))}),e(document).on("cycle-destroyed",function(e,t){var i=t.API.getComponent("pager");i&&(i.children().off(t.pagerEvent),t.pagerTemplate&&i.empty())})}(jQuery),/*! prevnext plugin for Cycle2;  version: 20130709 */
function(e){"use strict";e.extend(e.fn.cycle.defaults,{next:"> .cycle-next",nextEvent:"click.cycle",disabledClass:"disabled",prev:"> .cycle-prev",prevEvent:"click.cycle",swipe:!1}),e(document).on("cycle-initialized",function(e,t){if(t.API.getComponent("next").on(t.nextEvent,function(e){e.preventDefault(),t.API.next()}),t.API.getComponent("prev").on(t.prevEvent,function(e){e.preventDefault(),t.API.prev()}),t.swipe){var i=t.swipeVert?"swipeUp.cycle":"swipeLeft.cycle swipeleft.cycle",n=t.swipeVert?"swipeDown.cycle":"swipeRight.cycle swiperight.cycle";t.container.on(i,function(){t.API.next()}),t.container.on(n,function(){t.API.prev()})}}),e(document).on("cycle-update-view",function(e,t){if(!t.allowWrap){var i=t.disabledClass,n=t.API.getComponent("next"),s=t.API.getComponent("prev"),o=t._prevBoundry||0,c=void 0!==t._nextBoundry?t._nextBoundry:t.slideCount-1;t.currSlide==c?n.addClass(i).prop("disabled",!0):n.removeClass(i).prop("disabled",!1),t.currSlide===o?s.addClass(i).prop("disabled",!0):s.removeClass(i).prop("disabled",!1)}}),e(document).on("cycle-destroyed",function(e,t){t.API.getComponent("prev").off(t.nextEvent),t.API.getComponent("next").off(t.prevEvent),t.container.off("swipeleft.cycle swiperight.cycle swipeLeft.cycle swipeRight.cycle swipeUp.cycle swipeDown.cycle")})}(jQuery),/*! progressive loader plugin for Cycle2;  version: 20130315 */
function(e){"use strict";e.extend(e.fn.cycle.defaults,{progressive:!1}),e(document).on("cycle-pre-initialize",function(t,i){if(i.progressive){var n,s,o=i.API,c=o.next,r=o.prev,l=o.prepareTx,a=e.type(i.progressive);if("array"==a)n=i.progressive;else if(e.isFunction(i.progressive))n=i.progressive(i);else if("string"==a){if(s=e(i.progressive),n=e.trim(s.html()),!n)return;if(/^(\[)/.test(n))try{n=e.parseJSON(n)}catch(d){return o.log("error parsing progressive slides",d),void 0}else n=n.split(RegExp(s.data("cycle-split")||"\n")),n[n.length-1]||n.pop()}l&&(o.prepareTx=function(e,t){var s,o;return e||0===n.length?(l.apply(i.API,[e,t]),void 0):(t&&i.currSlide==i.slideCount-1?(o=n[0],n=n.slice(1),i.container.one("cycle-slide-added",function(e,t){setTimeout(function(){t.API.advanceSlide(1)},50)}),i.API.add(o)):t||0!==i.currSlide?l.apply(i.API,[e,t]):(s=n.length-1,o=n[s],n=n.slice(0,s),i.container.one("cycle-slide-added",function(e,t){setTimeout(function(){t.currSlide=1,t.API.advanceSlide(-1)},50)}),i.API.add(o,!0)),void 0)}),c&&(o.next=function(){var e=this.opts();if(n.length&&e.currSlide==e.slideCount-1){var t=n[0];n=n.slice(1),e.container.one("cycle-slide-added",function(e,t){c.apply(t.API),t.container.removeClass("cycle-loading")}),e.container.addClass("cycle-loading"),e.API.add(t)}else c.apply(e.API)}),r&&(o.prev=function(){var e=this.opts();if(n.length&&0===e.currSlide){var t=n.length-1,i=n[t];n=n.slice(0,t),e.container.one("cycle-slide-added",function(e,t){t.currSlide=1,t.API.advanceSlide(-1),t.container.removeClass("cycle-loading")}),e.container.addClass("cycle-loading"),e.API.add(i,!0)}else r.apply(e.API)})}})}(jQuery),/*! tmpl plugin for Cycle2;  version: 20121227 */
function(e){"use strict";e.extend(e.fn.cycle.defaults,{tmplRegex:"{{((.)?.*?)}}"}),e.extend(e.fn.cycle.API,{tmpl:function(t,i){var n=RegExp(i.tmplRegex||e.fn.cycle.defaults.tmplRegex,"g"),s=e.makeArray(arguments);return s.shift(),t.replace(n,function(t,i){var n,o,c,r,l=i.split(".");for(n=0;s.length>n;n++)if(c=s[n]){if(l.length>1)for(r=c,o=0;l.length>o;o++)c=r,r=r[l[o]]||i;else r=c[i];if(e.isFunction(r))return r.apply(c,s);if(void 0!==r&&null!==r&&r!=i)return r}return i})}})}(jQuery);
//@ sourceMappingURL=jquery.cycle2.js.map;
/*! Plugin for Cycle2; Copyright (c) 2012 M. Alsup; ver: 20121120 */
(function(a){"use strict";var b="ontouchend"in document;a.event.special.swipe=a.event.special.swipe||{scrollSupressionThreshold:10,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,setup:function(){var b=a(this);b.bind("touchstart",function(c){function g(b){if(!f)return;var c=b.originalEvent.touches?b.originalEvent.touches[0]:b;e={time:(new Date).getTime(),coords:[c.pageX,c.pageY]},Math.abs(f.coords[0]-e.coords[0])>a.event.special.swipe.scrollSupressionThreshold&&b.preventDefault()}var d=c.originalEvent.touches?c.originalEvent.touches[0]:c,e,f={time:(new Date).getTime(),coords:[d.pageX,d.pageY],origin:a(c.target)};b.bind("touchmove",g).one("touchend",function(c){b.unbind("touchmove",g),f&&e&&e.time-f.time<a.event.special.swipe.durationThreshold&&Math.abs(f.coords[0]-e.coords[0])>a.event.special.swipe.horizontalDistanceThreshold&&Math.abs(f.coords[1]-e.coords[1])<a.event.special.swipe.verticalDistanceThreshold&&f.origin.trigger("swipe").trigger(f.coords[0]>e.coords[0]?"swipeleft":"swiperight"),f=e=undefined})})}},a.event.special.swipeleft=a.event.special.swipeleft||{setup:function(){a(this).bind("swipe",a.noop)}},a.event.special.swiperight=a.event.special.swiperight||a.event.special.swipeleft})(jQuery);;

/* Jquery for search in list  starts */

(function ($) {
    // custom css expression for a case-insensitive contains()
    jQuery.expr[':'].Contains = function (a, i, m) {
        return (a.textContent || a.innerText || "").toUpperCase().indexOf(m[3].toUpperCase()) >= 0;
    };


    function listFilter(input, list) { // header is any element, list is an unordered list
        $(input)
      .change(function () {
          var filter = $(input).val();
          if (filter) {
              // this finds all links in a list that contain the input,
              // and hide the ones not containing the input while showing the ones that do
              $(list).find("a:not(:Contains(" + filter + "))").hide();
              $(list).find("a:Contains(" + filter + ")").show();
          } else {
              $(list).find("a").show();
          }
          return false;
      })
    .keyup(function () {
        // fire the above change event after every letter
        $(this).change();
    });
    }


    //ondomready
    $(function () {
        listFilter($("#yearInput"), $("#yearList"));
        listFilter($("#makeInput"), $("#makeList"));
        listFilter($("#modelInput"), $("#modelList"));
        listFilter($("#trimInput"), $("#trimList"));
        listFilter($("#colorInput"), $("#colorList"));
        listFilter($("#stateInput"), $("#stateList"));
    });
} (jQuery));

/* Jquery for search in list  ends */


;

/*!
 * bootstrap-select v1.4.1
 * http://silviomoreto.github.io/bootstrap-select/
 *
 * Copyright 2013 bootstrap-select
 * Licensed under the MIT license
 */
;!function(b){b.expr[":"].icontains=function(e,c,d){return b(e).text().toUpperCase().indexOf(d[3].toUpperCase())>=0};var a=function(d,c,f){if(f){f.stopPropagation();f.preventDefault()}this.$element=b(d);this.$newElement=null;this.$button=null;this.$menu=null;this.options=b.extend({},b.fn.selectpicker.defaults,this.$element.data(),typeof c=="object"&&c);if(this.options.title==null){this.options.title=this.$element.attr("title")}this.val=a.prototype.val;this.render=a.prototype.render;this.refresh=a.prototype.refresh;this.setStyle=a.prototype.setStyle;this.selectAll=a.prototype.selectAll;this.deselectAll=a.prototype.deselectAll;this.init()};a.prototype={constructor:a,init:function(){this.$element.hide();this.multiple=this.$element.prop("multiple");var d=this.$element.attr("id");this.$newElement=this.createView();this.$element.after(this.$newElement);this.$menu=this.$newElement.find("> .dropdown-menu");this.$button=this.$newElement.find("> button");this.$searchbox=this.$newElement.find("input");if(d!==undefined){var c=this;this.$button.attr("data-id",d);b('label[for="'+d+'"]').click(function(f){f.preventDefault();c.$button.focus()})}this.checkDisabled();this.clickListener();if(this.options.liveSearch){this.liveSearchListener()}this.render();this.liHeight();this.setStyle();this.setWidth();if(this.options.container){this.selectPosition()}this.$menu.data("this",this);this.$newElement.data("this",this)},createDropdown:function(){var c=this.multiple?" show-tick":"";var f=this.options.header?'<div class="popover-title"><button type="button" class="close" aria-hidden="true">&times;</button>'+this.options.header+"</div>":"";var e=this.options.liveSearch?'<div class="bootstrap-select-searchbox"><input type="text" class="input-block-level form-control" /></div>':"";var d="<div class='btn-group bootstrap-select"+c+"'><button type='button' class='btn dropdown-toggle selectpicker' data-toggle='dropdown'><span class='filter-option pull-left'></span>&nbsp;<span class='caret'></span></button><div class='dropdown-menu open'>"+f+e+"<ul class='dropdown-menu inner selectpicker' role='menu'></ul></div></div>";return b(d)},createView:function(){var c=this.createDropdown();var d=this.createLi();c.find("ul").append(d);return c},reloadLi:function(){this.destroyLi();var c=this.createLi();this.$menu.find("ul").append(c)},destroyLi:function(){this.$menu.find("li").remove()},createLi:function(){var d=this,e=[],c="";this.$element.find("option").each(function(){var i=b(this);var g=i.attr("class")||"";var h=i.attr("style")||"";var m=i.data("content")?i.data("content"):i.html();var k=i.data("subtext")!==undefined?'<small class="muted text-muted">'+i.data("subtext")+"</small>":"";var j=i.data("icon")!==undefined?'<i class="'+d.options.iconBase+" "+i.data("icon")+'"></i> ':"";if(j!==""&&(i.is(":disabled")||i.parent().is(":disabled"))){j="<span>"+j+"</span>"}if(!i.data("content")){m=j+'<span class="text">'+m+k+"</span>"}if(d.options.hideDisabled&&(i.is(":disabled")||i.parent().is(":disabled"))){e.push('<a style="min-height: 0; padding: 0"></a>')}else{if(i.parent().is("optgroup")&&i.data("divider")!==true){if(i.index()==0){var l=i.parent().attr("label");var n=i.parent().data("subtext")!==undefined?'<small class="muted text-muted">'+i.parent().data("subtext")+"</small>":"";var f=i.parent().data("icon")?'<i class="'+i.parent().data("icon")+'"></i> ':"";l=f+'<span class="text">'+l+n+"</span>";if(i[0].index!=0){e.push('<div class="div-contain"><div class="divider"></div></div><dt>'+l+"</dt>"+d.createA(m,"opt "+g,h))}else{e.push("<dt>"+l+"</dt>"+d.createA(m,"opt "+g,h))}}else{e.push(d.createA(m,"opt "+g,h))}}else{if(i.data("divider")===true){e.push('<div class="div-contain"><div class="divider"></div></div>')}else{if(b(this).data("hidden")===true){e.push("")}else{e.push(d.createA(m,g,h))}}}}});b.each(e,function(f,g){c+="<li rel="+f+">"+g+"</li>"});if(!this.multiple&&this.$element.find("option:selected").length==0&&!this.options.title){this.$element.find("option").eq(0).prop("selected",true).attr("selected","selected")}return b(c)},createA:function(e,c,d){return'<a tabindex="0" class="'+c+'" style="'+d+'">'+e+'<i class="'+this.options.iconBase+" "+this.options.tickIcon+' icon-ok check-mark"></i></a>'},render:function(){var d=this;this.$element.find("option").each(function(h){d.setDisabled(h,b(this).is(":disabled")||b(this).parent().is(":disabled"));d.setSelected(h,b(this).is(":selected"))});this.tabIndex();var g=this.$element.find("option:selected").map(function(){var j=b(this);var i=j.data("icon")&&d.options.showIcon?'<i class="'+d.options.iconBase+" "+j.data("icon")+'"></i> ':"";var h;if(d.options.showSubtext&&j.attr("data-subtext")&&!d.multiple){h=' <small class="muted text-muted">'+j.data("subtext")+"</small>"}else{h=""}if(j.data("content")&&d.options.showContent){return j.data("content")}else{if(j.attr("title")!=undefined){return j.attr("title")}else{return i+j.html()+h}}}).toArray();var f=!this.multiple?g[0]:g.join(this.options.multipleSeparator);if(this.multiple&&this.options.selectedTextFormat.indexOf("count")>-1){var c=this.options.selectedTextFormat.split(">");var e=this.options.hideDisabled?":not([disabled])":"";if((c.length>1&&g.length>c[1])||(c.length==1&&g.length>=2)){f=this.options.countSelectedText.replace("{0}",g.length).replace("{1}",this.$element.find('option:not([data-divider="true"]):not([data-hidden="true"])'+e).length)}}if(!f){f=this.options.title!=undefined?this.options.title:this.options.noneSelectedText}this.$button.attr("title",b.trim(f));this.$newElement.find(".filter-option").html(f)},setStyle:function(e,d){if(this.$element.attr("class")){this.$newElement.addClass(this.$element.attr("class").replace(/selectpicker|mobile-device/gi,""))}var c=e?e:this.options.style;if(d=="add"){this.$button.addClass(c)}else{if(d=="remove"){this.$button.removeClass(c)}else{this.$button.removeClass(this.options.style);this.$button.addClass(c)}}},liHeight:function(){var e=this.$menu.parent().clone().appendTo("body"),f=e.addClass("open").find("> .dropdown-menu"),d=f.find("li > a").outerHeight(),c=this.options.header?f.find(".popover-title").outerHeight():0,g=this.options.liveSearch?f.find(".bootstrap-select-searchbox").outerHeight():0;e.remove();this.$newElement.data("liHeight",d).data("headerHeight",c).data("searchHeight",g)},setSize:function(){var h=this,d=this.$menu,i=d.find(".inner"),t=this.$newElement.outerHeight(),f=this.$newElement.data("liHeight"),r=this.$newElement.data("headerHeight"),l=this.$newElement.data("searchHeight"),k=d.find("li .divider").outerHeight(true),q=parseInt(d.css("padding-top"))+parseInt(d.css("padding-bottom"))+parseInt(d.css("border-top-width"))+parseInt(d.css("border-bottom-width")),o=this.options.hideDisabled?":not(.disabled)":"",n=b(window),g=q+parseInt(d.css("margin-top"))+parseInt(d.css("margin-bottom"))+2,p,u,s,j=function(){u=h.$newElement.offset().top-n.scrollTop();s=n.height()-u-t};j();if(this.options.header){d.css("padding-top",0)}if(this.options.size=="auto"){var e=function(){var v;j();p=s-g;if(h.options.dropupAuto){h.$newElement.toggleClass("dropup",(u>s)&&((p-g)<d.height()))}if(h.$newElement.hasClass("dropup")){p=u-g}if((d.find("li").length+d.find("dt").length)>3){v=f*3+g-2}else{v=0}d.css({"max-height":p+"px",overflow:"hidden","min-height":v+"px"});i.css({"max-height":p-r-l-q+"px","overflow-y":"auto","min-height":v-q+"px"})};e();b(window).resize(e);b(window).scroll(e)}else{if(this.options.size&&this.options.size!="auto"&&d.find("li"+o).length>this.options.size){var m=d.find("li"+o+" > *").filter(":not(.div-contain)").slice(0,this.options.size).last().parent().index();var c=d.find("li").slice(0,m+1).find(".div-contain").length;p=f*this.options.size+c*k+q;if(h.options.dropupAuto){this.$newElement.toggleClass("dropup",(u>s)&&(p<d.height()))}d.css({"max-height":p+r+l+"px",overflow:"hidden"});i.css({"max-height":p-q+"px","overflow-y":"auto"})}}},setWidth:function(){if(this.options.width=="auto"){this.$menu.css("min-width","0");var d=this.$newElement.clone().appendTo("body");var c=d.find("> .dropdown-menu").css("width");d.remove();this.$newElement.css("width",c)}else{if(this.options.width=="fit"){this.$menu.css("min-width","");this.$newElement.css("width","").addClass("fit-width")}else{if(this.options.width){this.$menu.css("min-width","");this.$newElement.css("width",this.options.width)}else{this.$menu.css("min-width","");this.$newElement.css("width","")}}}if(this.$newElement.hasClass("fit-width")&&this.options.width!=="fit"){this.$newElement.removeClass("fit-width")}},selectPosition:function(){var e=this,d="<div />",f=b(d),h,g,c=function(i){f.addClass(i.attr("class")).toggleClass("dropup",i.hasClass("dropup"));h=i.offset();g=i.hasClass("dropup")?0:i[0].offsetHeight;f.css({top:h.top+g,left:h.left,width:i[0].offsetWidth,position:"absolute"})};this.$newElement.on("click",function(){c(b(this));f.appendTo(e.options.container);f.toggleClass("open",!b(this).hasClass("open"));f.append(e.$menu)});b(window).resize(function(){c(e.$newElement)});b(window).on("scroll",function(){c(e.$newElement)});b("html").on("click",function(i){if(b(i.target).closest(e.$newElement).length<1){f.removeClass("open")}})},mobile:function(){this.$element.addClass("mobile-device").appendTo(this.$newElement);if(this.options.container){this.$menu.hide()}},refresh:function(){this.reloadLi();this.render();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},update:function(){this.reloadLi();this.setWidth();this.setStyle();this.checkDisabled();this.liHeight()},setSelected:function(c,d){this.$menu.find("li").eq(c).toggleClass("selected",d)},setDisabled:function(c,d){if(d){this.$menu.find("li").eq(c).addClass("disabled").find("a").attr("href","#").attr("tabindex",-1)}else{this.$menu.find("li").eq(c).removeClass("disabled").find("a").removeAttr("href").attr("tabindex",0)}},isDisabled:function(){return this.$element.is(":disabled")},checkDisabled:function(){var c=this;if(this.isDisabled()){this.$button.addClass("disabled").attr("tabindex",-1)}else{if(this.$button.hasClass("disabled")){this.$button.removeClass("disabled")}if(this.$button.attr("tabindex")==-1){if(!this.$element.data("tabindex")){this.$button.removeAttr("tabindex")}}}this.$button.click(function(){return !c.isDisabled()})},tabIndex:function(){if(this.$element.is("[tabindex]")){this.$element.data("tabindex",this.$element.attr("tabindex"));this.$button.attr("tabindex",this.$element.data("tabindex"))}},clickListener:function(){var c=this;b("body").on("touchstart.dropdown",".dropdown-menu",function(d){d.stopPropagation()});this.$newElement.on("click",function(){c.setSize();if(!c.options.liveSearch&&!c.multiple){setTimeout(function(){c.$menu.find(".selected a").focus()},10)}});this.$menu.on("click","li a",function(k){var g=b(this).parent().index(),j=c.$element.val(),f=c.$element.prop("selectedIndex");if(c.multiple){k.stopPropagation()}k.preventDefault();if(!c.isDisabled()&&!b(this).parent().hasClass("disabled")){var d=c.$element.find("option");var i=d.eq(g);if(!c.multiple){d.prop("selected",false);i.prop("selected",true)}else{var h=i.prop("selected");i.prop("selected",!h)}if(!c.multiple){c.$button.focus()}else{if(c.options.liveSearch){c.$searchbox.focus()}}if((j!=c.$element.val()&&c.multiple)||(f!=c.$element.prop("selectedIndex")&&!c.multiple)){c.$element.change()}}});this.$menu.on("click","li.disabled a, li dt, li .div-contain, .popover-title, .popover-title :not(.close)",function(d){if(d.target==this){d.preventDefault();d.stopPropagation();if(!c.options.liveSearch){c.$button.focus()}else{c.$searchbox.focus()}}});this.$menu.on("click",".popover-title .close",function(){c.$button.focus()});this.$searchbox.on("click",function(d){d.stopPropagation()});this.$element.change(function(){c.render()})},liveSearchListener:function(){var d=this,c=b('<li class="no-results"></li>');this.$newElement.on("click.dropdown.data-api",function(){d.$menu.find(".active").removeClass("active");if(!!d.$searchbox.val()){d.$searchbox.val("");d.$menu.find("li").show();if(!!c.parent().length){c.remove()}}if(!d.multiple){d.$menu.find(".selected").addClass("active")}setTimeout(function(){d.$searchbox.focus()},10)});this.$searchbox.on("input propertychange",function(){if(d.$searchbox.val()){d.$menu.find("li").show().not(":icontains("+d.$searchbox.val()+")").hide();if(!d.$menu.find("li").filter(":visible:not(.no-results)").length){if(!!c.parent().length){c.remove()}c.html('No results match "'+d.$searchbox.val()+'"').show();d.$menu.find("li").last().after(c)}else{if(!!c.parent().length){c.remove()}}}else{d.$menu.find("li").show();if(!!c.parent().length){c.remove()}}d.$menu.find("li.active").removeClass("active");d.$menu.find("li").filter(":visible:not(.divider)").eq(0).addClass("active").find("a").focus();b(this).focus()});this.$menu.on("mouseenter","a",function(f){d.$menu.find(".active").removeClass("active");b(f.currentTarget).parent().not(".disabled").addClass("active")});this.$menu.on("mouseleave","a",function(){d.$menu.find(".active").removeClass("active")})},val:function(c){if(c!=undefined){this.$element.val(c);this.$element.change();return this.$element}else{return this.$element.val()}},selectAll:function(){this.$element.find("option").prop("selected",true).attr("selected","selected");this.render()},deselectAll:function(){this.$element.find("option").prop("selected",false).removeAttr("selected");this.render()},keydown:function(p){var q,o,i,n,k,j,r,f,h,m,d,s,g={32:" ",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};q=b(this);i=q.parent();if(q.is("input")){i=q.parent().parent()}m=i.data("this");if(m.options.liveSearch){i=q.parent().parent()}if(m.options.container){i=m.$menu}o=b("[role=menu] li:not(.divider) a",i);s=m.$menu.parent().hasClass("open");if(m.options.liveSearch){if(/(^9$|27)/.test(p.keyCode)&&s&&m.$menu.find(".active").length==0){p.preventDefault();m.$menu.parent().removeClass("open");m.$button.focus()}o=b("[role=menu] li:not(.divider):visible",i);if(!q.val()&&!/(38|40)/.test(p.keyCode)){if(o.filter(".active").length==0){o=m.$newElement.find("li").filter(":icontains("+g[p.keyCode]+")")}}}if(!o.length){return}if(/(38|40)/.test(p.keyCode)){if(!s){m.$menu.parent().addClass("open")}n=o.index(o.filter(":focus"));j=o.parent(":not(.disabled):visible").first().index();r=o.parent(":not(.disabled):visible").last().index();k=o.eq(n).parent().nextAll(":not(.disabled):visible").eq(0).index();f=o.eq(n).parent().prevAll(":not(.disabled):visible").eq(0).index();h=o.eq(k).parent().prevAll(":not(.disabled):visible").eq(0).index();if(m.options.liveSearch){o.each(function(e){if(b(this).is(":not(.disabled)")){b(this).data("index",e)}});n=o.index(o.filter(".active"));j=o.filter(":not(.disabled):visible").first().data("index");r=o.filter(":not(.disabled):visible").last().data("index");k=o.eq(n).nextAll(":not(.disabled):visible").eq(0).data("index");f=o.eq(n).prevAll(":not(.disabled):visible").eq(0).data("index");h=o.eq(k).prevAll(":not(.disabled):visible").eq(0).data("index")}d=q.data("prevIndex");if(p.keyCode==38){if(m.options.liveSearch){n-=1}if(n!=h&&n>f){n=f}if(n<j){n=j}if(n==d){n=r}}if(p.keyCode==40){if(m.options.liveSearch){n+=1}if(n==-1){n=0}if(n!=h&&n<k){n=k}if(n>r){n=r}if(n==d){n=j}}q.data("prevIndex",n);if(!m.options.liveSearch){o.eq(n).focus()}else{p.preventDefault();if(!q.is(".dropdown-toggle")){o.removeClass("active");o.eq(n).addClass("active").find("a").focus();q.focus()}}}else{if(!q.is("input")){var c=[];o.each(function(){if(b(this).parent().is(":not(.disabled)")){if(b.trim(b(this).text().toLowerCase()).substring(0,1)==g[p.keyCode]){c.push(b(this).parent().index())}}});var l=b(document).data("keycount");l++;b(document).data("keycount",l);var t=b.trim(b(":focus").text().toLowerCase()).substring(0,1);if(t!=g[p.keyCode]){l=1;b(document).data("keycount",l)}else{if(l>=c.length){b(document).data("keycount",0)}}o.eq(c[l-1]).focus()}}if(/(13|32|^9$)/.test(p.keyCode)&&s){if(!/(32)/.test(p.keyCode)){p.preventDefault()}if(!m.options.liveSearch){b(":focus").click()}else{if(!/(32)/.test(p.keyCode)){m.$menu.find(".active a").click();q.focus()}}b(document).data("keycount",0)}if((/(^9$|27)/.test(p.keyCode)&&s&&(m.multiple||m.options.liveSearch))||(/(27)/.test(p.keyCode)&&!s)){m.$menu.parent().removeClass("open");m.$button.focus()}},hide:function(){this.$newElement.hide()},show:function(){this.$newElement.show()},destroy:function(){this.$newElement.remove();this.$element.remove()}};b.fn.selectpicker=function(e,f){var c=arguments;var g;var d=this.each(function(){if(b(this).is("select")){var m=b(this),l=m.data("selectpicker"),h=typeof e=="object"&&e;if(!l){m.data("selectpicker",(l=new a(this,h,f)))}else{if(h){for(var j in h){l.options[j]=h[j]}}}if(typeof e=="string"){var k=e;if(l[k] instanceof Function){[].shift.apply(c);g=l[k].apply(l,c)}else{g=l.options[k]}}}});if(g!=undefined){return g}else{return d}};b.fn.selectpicker.defaults={style:"btn-default",size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",countSelectedText:"{0} of {1} selected",width:false,container:false,hideDisabled:false,showSubtext:false,showIcon:true,showContent:true,dropupAuto:true,header:false,liveSearch:false,multipleSeparator:", ",iconBase:"glyphicon",tickIcon:"glyphicon-ok"};b(document).data("keycount",0).on("keydown",".bootstrap-select [data-toggle=dropdown], .bootstrap-select [role=menu], .bootstrap-select-searchbox input",a.prototype.keydown)}(window.jQuery);;
/**

Uploading files, only to find that they are too large, or the wrong type is frustrating.
The `fileValidator` plugin lets you warn users before they start uploading
enormous files.

Usage
-----

Simply select the file inputs you wish to validate, and pass in a callbacks to handle invalid files.

$( el ).fileValidator({
onValidation: function(files){ ... },
onInvalid:    function(validationType, file){ ... },
totalSize:    '2m', //optional
maxSize:      '2m', //optional
type:         'image' //optional
extension:	  'png' //optional
});



 */
(function ($) {

	$.fileValidator = function (options) {
		var validations = [];
		var onInvalid = options.onInvalid;

		for (var key in $.fileValidator.validations) {
			if (!options[key]) {
				continue;
			}
			validations.push($.fileValidator.validations[key](options[key], onInvalid));
		}

		return function (file) {
			for (var i = 0, len = validations.length; i < len; i++) {
				validations[i].call(this, file);
			}
		};
	};

	$.fileValidator.validations = {
		maxSize : function (maxSize, invalid) {
			if (typeof maxSize == 'string') {
				maxSize = $.fileValidator.sizeToBytes(maxSize);
			}

			return function (file) {
				if (file && file.size > maxSize) {
					invalid.call(this, 'maxSize', file);
				}
			};
		},

		totalSize : function (totalSize, invalid) {
			if (typeof totalSize == 'string') {
				totalSize = $.fileValidator.sizeToBytes(totalSize);
			}

			return function (file) {
				var filesSize = 0;
				var files = this.files || [];
				for (var i = 0, len = files.length; i < len; i++) {
					filesSize += files[i].size;
				}
			
				if (filesSize > totalSize) {
					invalid.call(this, 'totalSize', file);
				}
			};
		},
		
		type : function (contentType, invalid) {
			var isValid;
			if (typeof contentType == 'function') {
				isValid = contentType;
			} else if (contentType.constructor === RegExp) {
				isValid = function (type) {
					return type.match(contentType);
				};
			} else {
				isValid = function (type) {
					return ~type.indexOf(contentType);
				};
			}

			return function (file) {
				if (!isValid(file.type))
					invalid.call(this, 'type', file);
			};
		},

		extension : function (extensions, invalid) {
			var isValid;
			if (typeof extensions == 'string') {
				isValid = function (name) {
					var ext = name.split('.').pop().toLowerCase();
					if ($.inArray(ext, extensions.split(',')) == -1) {
						return false;
					}
					return true;
				}
			}

			return function (file) {
				if (isValid && !isValid(file.name))
					invalid.call(this, 'extension', file);
			};
		}
	};

	$.fn.fileValidator = function (userOptions) {
		var options = $.extend({
				// Validations
				maxSize : null,
				type : null,
				extension : null ,
				totalSize : null ,
				
				// Callbacks
				onValidation : $.fileValidator.doNothing,
				onInvalid : $.fileValidator.doNothing
			}, userOptions);

		return this.each(function () {
			var el = $(this);
			var validator = $.fileValidator($.extend({}, options, el.data()));

			el.bind('change', function (event) {
				var files = this.files || [];
				options.onValidation.call(this, files);
				for (var i = 0, len = files.length; i < len; i++) {
					validator.call(this, files[i]);
				}
			});
		});
	};

	$.fileValidator.doNothing = function doNothing() {};
	$.fileValidator.sizeToBytes = function sizeToBytes(size) {
		var scale = 1;

		if (~size.indexOf('k')) {
			scale = 1024;
		} else if (~size.indexOf('m')) {
			scale = 1024 * 1024;
		} else if (~size.indexOf('g')) {
			scale = 1024 * 1024 * 1024;
		}
		return parseInt(size, 10) * scale;
	};
})(jQuery);;
/*! noUiSlider - 7.0.10 - 2014-12-27 14:50:47 */

!function(a){"use strict";function b(a,b){return Math.round(a/b)*b}function c(a){return"number"==typeof a&&!isNaN(a)&&isFinite(a)}function d(a){var b=Math.pow(10,7);return Number((Math.round(a*b)/b).toFixed(7))}function e(a,b,c){a.addClass(b),setTimeout(function(){a.removeClass(b)},c)}function f(a){return Math.max(Math.min(a,100),0)}function g(b){return a.isArray(b)?b:[b]}function h(a){var b=a.split(".");return b.length>1?b[1].length:0}function i(a,b){return 100/(b-a)}function j(a,b){return 100*b/(a[1]-a[0])}function k(a,b){return j(a,a[0]<0?b+Math.abs(a[0]):b-a[0])}function l(a,b){return b*(a[1]-a[0])/100+a[0]}function m(a,b){for(var c=1;a>=b[c];)c+=1;return c}function n(a,b,c){if(c>=a.slice(-1)[0])return 100;var d,e,f,g,h=m(c,a);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],f+k([d,e],c)/i(f,g)}function o(a,b,c){if(c>=100)return a.slice(-1)[0];var d,e,f,g,h=m(c,b);return d=a[h-1],e=a[h],f=b[h-1],g=b[h],l([d,e],(c-f)*i(f,g))}function p(a,c,d,e){if(100===e)return e;var f,g,h=m(e,a);return d?(f=a[h-1],g=a[h],e-f>(g-f)/2?g:f):c[h-1]?a[h-1]+b(e-a[h-1],c[h-1]):e}function q(a,b,d){var e;if("number"==typeof b&&(b=[b]),"[object Array]"!==Object.prototype.toString.call(b))throw new Error("noUiSlider: 'range' contains invalid value.");if(e="min"===a?0:"max"===a?100:parseFloat(a),!c(e)||!c(b[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");d.xPct.push(e),d.xVal.push(b[0]),e?d.xSteps.push(isNaN(b[1])?!1:b[1]):isNaN(b[1])||(d.xSteps[0]=b[1])}function r(a,b,c){return b?void(c.xSteps[a]=j([c.xVal[a],c.xVal[a+1]],b)/i(c.xPct[a],c.xPct[a+1])):!0}function s(a,b,c,d){this.xPct=[],this.xVal=[],this.xSteps=[d||!1],this.xNumSteps=[!1],this.snap=b,this.direction=c;var e,f=[];for(e in a)a.hasOwnProperty(e)&&f.push([a[e],e]);for(f.sort(function(a,b){return a[0]-b[0]}),e=0;e<f.length;e++)q(f[e][1],f[e][0],this);for(this.xNumSteps=this.xSteps.slice(0),e=0;e<this.xNumSteps.length;e++)r(e,this.xNumSteps[e],this)}function t(a,b){if(!c(b))throw new Error("noUiSlider: 'step' is not numeric.");a.singleStep=b}function u(b,c){if("object"!=typeof c||a.isArray(c))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===c.min||void 0===c.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");b.spectrum=new s(c,b.snap,b.dir,b.singleStep)}function v(b,c){if(c=g(c),!a.isArray(c)||!c.length||c.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");b.handles=c.length,b.start=c}function w(a,b){if(a.snap=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function x(a,b){if(a.animate=b,"boolean"!=typeof b)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function y(a,b){if("lower"===b&&1===a.handles)a.connect=1;else if("upper"===b&&1===a.handles)a.connect=2;else if(b===!0&&2===a.handles)a.connect=3;else{if(b!==!1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");a.connect=0}}function z(a,b){switch(b){case"horizontal":a.ort=0;break;case"vertical":a.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function A(a,b){if(!c(b))throw new Error("noUiSlider: 'margin' option must be numeric.");if(a.margin=a.spectrum.getMargin(b),!a.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function B(a,b){if(!c(b))throw new Error("noUiSlider: 'limit' option must be numeric.");if(a.limit=a.spectrum.getMargin(b),!a.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function C(a,b){switch(b){case"ltr":a.dir=0;break;case"rtl":a.dir=1,a.connect=[0,2,1,3][a.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function D(a,b){if("string"!=typeof b)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var c=b.indexOf("tap")>=0,d=b.indexOf("drag")>=0,e=b.indexOf("fixed")>=0,f=b.indexOf("snap")>=0;a.events={tap:c||f,drag:d,fixed:e,snap:f}}function E(a,b){if(a.format=b,"function"==typeof b.to&&"function"==typeof b.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function F(b){var c,d={margin:0,limit:0,animate:!0,format:V};return c={step:{r:!1,t:t},start:{r:!0,t:v},connect:{r:!0,t:y},direction:{r:!0,t:C},snap:{r:!1,t:w},animate:{r:!1,t:x},range:{r:!0,t:u},orientation:{r:!1,t:z},margin:{r:!1,t:A},limit:{r:!1,t:B},behaviour:{r:!0,t:D},format:{r:!1,t:E}},b=a.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},b),a.each(c,function(a,c){if(void 0===b[a]){if(c.r)throw new Error("noUiSlider: '"+a+"' is required.");return!0}c.t(d,b[a])}),d.style=d.ort?"top":"left",d}function G(a,b,c){var d=a+b[0],e=a+b[1];return c?(0>d&&(e+=Math.abs(d)),e>100&&(d-=e-100),[f(d),f(e)]):[d,e]}function H(a){a.preventDefault();var b,c,d=0===a.type.indexOf("touch"),e=0===a.type.indexOf("mouse"),f=0===a.type.indexOf("pointer"),g=a;return 0===a.type.indexOf("MSPointer")&&(f=!0),a.originalEvent&&(a=a.originalEvent),d&&(b=a.changedTouches[0].pageX,c=a.changedTouches[0].pageY),(e||f)&&(f||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),b=a.clientX+window.pageXOffset,c=a.clientY+window.pageYOffset),g.points=[b,c],g.cursor=e,g}function I(b,c){var d=a("<div><div/></div>").addClass(U[2]),e=["-lower","-upper"];return b&&e.reverse(),d.children().addClass(U[3]+" "+U[3]+e[c]),d}function J(a,b,c){switch(a){case 1:b.addClass(U[7]),c[0].addClass(U[6]);break;case 3:c[1].addClass(U[6]);case 2:c[0].addClass(U[7]);case 0:b.addClass(U[6])}}function K(a,b,c){var d,e=[];for(d=0;a>d;d+=1)e.push(I(b,d).appendTo(c));return e}function L(b,c,d){return d.addClass([U[0],U[8+b],U[4+c]].join(" ")),a("<div/>").appendTo(d).addClass(U[1])}function M(b,c,d){function i(){return C[["width","height"][c.ort]]()}function j(a){var b,c=[E.val()];for(b=0;b<a.length;b+=1)E.trigger(a[b],c)}function k(a){return 1===a.length?a[0]:c.dir?a.reverse():a}function l(a){return function(b,c){E.val([a?null:c,a?c:null],!0)}}function m(b){var c=a.inArray(b,N);E[0].linkAPI&&E[0].linkAPI[b]&&E[0].linkAPI[b].change(M[c],D[c].children(),E)}function n(b,d){var e=a.inArray(b,N);return d&&d.appendTo(D[e].children()),c.dir&&c.handles>1&&(e=1===e?0:1),l(e)}function o(){var a,b;for(a=0;a<N.length;a+=1)this.linkAPI&&this.linkAPI[b=N[a]]&&this.linkAPI[b].reconfirm(b)}function p(a,b,d,e){return a=a.replace(/\s/g,S+" ")+S,b.on(a,function(a){return E.attr("disabled")?!1:E.hasClass(U[14])?!1:(a=H(a),a.calcPoint=a.points[c.ort],void d(a,e))})}function q(a,b){var c,d=b.handles||D,e=!1,f=100*(a.calcPoint-b.start)/i(),g=d[0][0]!==D[0][0]?1:0;c=G(f,b.positions,d.length>1),e=v(d[0],c[g],1===d.length),d.length>1&&(e=v(d[1],c[g?0:1],!1)||e),e&&j(["slide"])}function r(b){a("."+U[15]).removeClass(U[15]),b.cursor&&a("body").css("cursor","").off(S),Q.off(S),E.removeClass(U[12]),j(["set","change"])}function s(b,c){1===c.handles.length&&c.handles[0].children().addClass(U[15]),b.stopPropagation(),p(T.move,Q,q,{start:b.calcPoint,handles:c.handles,positions:[F[0],F[D.length-1]]}),p(T.end,Q,r,null),b.cursor&&(a("body").css("cursor",a(b.target).css("cursor")),D.length>1&&E.addClass(U[12]),a("body").on("selectstart"+S,!1))}function t(b){var d,f=b.calcPoint,g=0;b.stopPropagation(),a.each(D,function(){g+=this.offset()[c.style]}),g=g/2>f||1===D.length?0:1,f-=C.offset()[c.style],d=100*f/i(),c.events.snap||e(E,U[14],300),v(D[g],d),j(["slide","set","change"]),c.events.snap&&s(b,{handles:[D[g]]})}function u(a){var b,c;if(!a.fixed)for(b=0;b<D.length;b+=1)p(T.start,D[b].children(),s,{handles:[D[b]]});a.tap&&p(T.start,C,t,{handles:D}),a.drag&&(c=C.find("."+U[7]).addClass(U[10]),a.fixed&&(c=c.add(C.children().not(c).children())),p(T.start,c,s,{handles:D}))}function v(a,b,d){var e=a[0]!==D[0][0]?1:0,g=F[0]+c.margin,h=F[1]-c.margin,i=F[0]+c.limit,j=F[1]-c.limit;return D.length>1&&(b=e?Math.max(b,g):Math.min(b,h)),d!==!1&&c.limit&&D.length>1&&(b=e?Math.min(b,i):Math.max(b,j)),b=I.getStep(b),b=f(parseFloat(b.toFixed(7))),b===F[e]?!1:(a.css(c.style,b+"%"),a.is(":first-child")&&a.toggleClass(U[17],b>50),F[e]=b,M[e]=I.fromStepping(b),m(N[e]),!0)}function w(a,b){var d,e,f;for(c.limit&&(a+=1),d=0;a>d;d+=1)e=d%2,f=b[e],null!==f&&f!==!1&&("number"==typeof f&&(f=String(f)),f=c.format.from(f),(f===!1||isNaN(f)||v(D[e],I.toStepping(f),d===3-c.dir)===!1)&&m(N[e]))}function x(a){if(E[0].LinkIsEmitting)return this;var b,d=g(a);return c.dir&&c.handles>1&&d.reverse(),c.animate&&-1!==F[0]&&e(E,U[14],300),b=D.length>1?3:1,1===d.length&&(b=1),w(b,d),j(["set"]),this}function y(){var a,b=[];for(a=0;a<c.handles;a+=1)b[a]=c.format.to(M[a]);return k(b)}function z(){return a(this).off(S).removeClass(U.join(" ")).empty(),delete this.LinkUpdate,delete this.LinkConfirm,delete this.LinkDefaultFormatter,delete this.LinkDefaultFlag,delete this.reappend,delete this.vGet,delete this.vSet,delete this.getCurrentStep,delete this.getInfo,delete this.destroy,d}function A(){var b=a.map(F,function(a,b){var c=I.getApplicableStep(a),d=h(String(c[2])),e=M[b],f=100===a?null:c[2],g=Number((e-c[2]).toFixed(d)),i=0===a?null:g>=c[1]?c[2]:c[0]||!1;return[[i,f]]});return k(b)}function B(){return d}var C,D,E=a(b),F=[-1,-1],I=c.spectrum,M=[],N=["lower","upper"].slice(0,c.handles);if(c.dir&&N.reverse(),b.LinkUpdate=m,b.LinkConfirm=n,b.LinkDefaultFormatter=c.format,b.LinkDefaultFlag="lower",b.reappend=o,E.hasClass(U[0]))throw new Error("Slider was already initialized.");C=L(c.dir,c.ort,E),D=K(c.handles,c.dir,C),J(c.connect,E,D),u(c.events),b.vSet=x,b.vGet=y,b.destroy=z,b.getCurrentStep=A,b.getOriginalOptions=B,b.getInfo=function(){return[I,c.style,c.ort]},E.val(c.start)}function N(a){var b=F(a,this);return this.each(function(){M(this,b,a)})}function O(b){return this.each(function(){if(!this.destroy)return void a(this).noUiSlider(b);var c=a(this).val(),d=this.destroy(),e=a.extend({},d,b);a(this).noUiSlider(e),this.reappend(),d.start===e.start&&a(this).val(c)})}function P(){return this[0][arguments.length?"vSet":"vGet"].apply(this[0],arguments)}var Q=a(document),R=a.fn.val,S=".nui",T=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},U=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","","noUi-stacking"];s.prototype.getMargin=function(a){return 2===this.xPct.length?j(this.xVal,a):!1},s.prototype.toStepping=function(a){return a=n(this.xVal,this.xPct,a),this.direction&&(a=100-a),a},s.prototype.fromStepping=function(a){return this.direction&&(a=100-a),d(o(this.xVal,this.xPct,a))},s.prototype.getStep=function(a){return this.direction&&(a=100-a),a=p(this.xPct,this.xSteps,this.snap,a),this.direction&&(a=100-a),a},s.prototype.getApplicableStep=function(a){var b=m(a,this.xPct),c=100===a?2:1;return[this.xNumSteps[b-2],this.xVal[b-c],this.xNumSteps[b-c]]},s.prototype.convert=function(a){return this.getStep(this.toStepping(a))};var V={to:function(a){return a.toFixed(2)},from:Number};a.fn.val=function(b){function c(a){return a.hasClass(U[0])?P:R}if(!arguments.length){var d=a(this[0]);return c(d).call(d)}var e=a.isFunction(b);return this.each(function(d){var f=b,g=a(this);e&&(f=b.call(this,d,g.val())),c(g).call(g,f)})},a.fn.noUiSlider=function(a,b){switch(a){case"step":return this[0].getCurrentStep();case"options":return this[0].getOriginalOptions()}return(b?O:N).call(this,a)}}(window.jQuery||window.Zepto);;
/*
 * Swipe 2.0
 *
 * Brad Birdsall
 * Copyright 2013, MIT License
 *
*/

function Swipe(container, options) {

  "use strict";

  // utilities
  var noop = function() {}; // simple no operation function
  var offloadFn = function(fn) { setTimeout(fn || noop, 0) }; // offload a functions execution

  // check browser capabilities
  var browser = {
    addEventListener: !!window.addEventListener,
    touch: ('ontouchstart' in window) || window.DocumentTouch && document instanceof DocumentTouch,
    transitions: (function(temp) {
      var props = ['transitionProperty', 'WebkitTransition', 'MozTransition', 'OTransition', 'msTransition'];
      for ( var i in props ) if (temp.style[ props[i] ] !== undefined) return true;
      return false;
    })(document.createElement('swipe'))
  };

  // quit if no root element
  if (!container) return;
  var element = container.children[0];
  var slides, slidePos, width, length;
  options = options || {};
  var index = parseInt(options.startSlide, 10) || 0;
  var speed = options.speed || 300;
  options.continuous = options.continuous !== undefined ? options.continuous : true;

  function setup() {

    // cache slides
    slides = element.children;
    length = slides.length;

    // set continuous to false if only one slide
    if (slides.length < 2) options.continuous = false;

    //special case if two slides
    if (browser.transitions && options.continuous && slides.length < 3) {
      element.appendChild(slides[0].cloneNode(true));
      element.appendChild(element.children[1].cloneNode(true));
      slides = element.children;
    }

    // create an array to store current positions of each slide
    slidePos = new Array(slides.length);

    // determine width of each slide
    width = container.getBoundingClientRect().width || container.offsetWidth;

    element.style.width = (slides.length * width) + 'px';

    // stack elements
    var pos = slides.length;
    while(pos--) {

      var slide = slides[pos];

      slide.style.width = width + 'px';
      slide.setAttribute('data-index', pos);

      if (browser.transitions) {
        slide.style.left = (pos * -width) + 'px';
        move(pos, index > pos ? -width : (index < pos ? width : 0), 0);
      }

    }

    // reposition elements before and after index
    if (options.continuous && browser.transitions) {
      move(circle(index-1), -width, 0);
      move(circle(index+1), width, 0);
    }

    if (!browser.transitions) element.style.left = (index * -width) + 'px';

    container.style.visibility = 'visible';

  }

  function prev() {

    if (options.continuous) slide(index-1);
    else if (index) slide(index-1);

  }

  function next() {

    if (options.continuous) slide(index+1);
    else if (index < slides.length - 1) slide(index+1);

  }

  function circle(index) {

    // a simple positive modulo using slides.length
    return (slides.length + (index % slides.length)) % slides.length;

  }

  function slide(to, slideSpeed) {

    // do nothing if already on requested slide
    if (index == to) return;

    if (browser.transitions) {

      var direction = Math.abs(index-to) / (index-to); // 1: backward, -1: forward

      // get the actual position of the slide
      if (options.continuous) {
        var natural_direction = direction;
        direction = -slidePos[circle(to)] / width;

        // if going forward but to < index, use to = slides.length + to
        // if going backward but to > index, use to = -slides.length + to
        if (direction !== natural_direction) to =  -direction * slides.length + to;

      }

      var diff = Math.abs(index-to) - 1;

      // move all the slides between index and to in the right direction
      while (diff--) move( circle((to > index ? to : index) - diff - 1), width * direction, 0);

      to = circle(to);

      move(index, width * direction, slideSpeed || speed);
      move(to, 0, slideSpeed || speed);

      if (options.continuous) move(circle(to - direction), -(width * direction), 0); // we need to get the next in place

    } else {

      to = circle(to);
      animate(index * -width, to * -width, slideSpeed || speed);
      //no fallback for a circular continuous if the browser does not accept transitions
    }

    index = to;
    offloadFn(options.callback && options.callback(index, slides[index]));
  }

  function move(index, dist, speed) {

    translate(index, dist, speed);
    slidePos[index] = dist;

  }

  function translate(index, dist, speed) {

    var slide = slides[index];
    var style = slide && slide.style;

    if (!style) return;

    style.webkitTransitionDuration =
    style.MozTransitionDuration =
    style.msTransitionDuration =
    style.OTransitionDuration =
    style.transitionDuration = speed + 'ms';

    style.webkitTransform = 'translate(' + dist + 'px,0)' + 'translateZ(0)';
    style.msTransform =
    style.MozTransform =
    style.OTransform = 'translateX(' + dist + 'px)';

  }

  function animate(from, to, speed) {

    // if not an animation, just reposition
    if (!speed) {

      element.style.left = to + 'px';
      return;

    }

    var start = +new Date;

    var timer = setInterval(function() {

      var timeElap = +new Date - start;

      if (timeElap > speed) {

        element.style.left = to + 'px';

        if (delay) begin();

        options.transitionEnd && options.transitionEnd.call(event, index, slides[index]);

        clearInterval(timer);
        return;

      }

      element.style.left = (( (to - from) * (Math.floor((timeElap / speed) * 100) / 100) ) + from) + 'px';

    }, 4);

  }

  // setup auto slideshow
  var delay = options.auto || 0;
  var interval;

  function begin() {

    interval = setTimeout(next, delay);

  }

  function stop() {

    delay = 0;
    clearTimeout(interval);

  }


  // setup initial vars
  var start = {};
  var delta = {};
  var isScrolling;

  // setup event capturing
  var events = {

    handleEvent: function(event) {

      switch (event.type) {
        case 'touchstart': this.start(event); break;
        case 'touchmove': this.move(event); break;
        case 'touchend': offloadFn(this.end(event)); break;
        case 'webkitTransitionEnd':
        case 'msTransitionEnd':
        case 'oTransitionEnd':
        case 'otransitionend':
        case 'transitionend': offloadFn(this.transitionEnd(event)); break;
        case 'resize': offloadFn(setup); break;
      }

      if (options.stopPropagation) event.stopPropagation();

    },
    start: function(event) {

      var touches = event.touches[0];

      // measure start values
      start = {

        // get initial touch coords
        x: touches.pageX,
        y: touches.pageY,

        // store time to determine touch duration
        time: +new Date

      };

      // used for testing first move event
      isScrolling = undefined;

      // reset delta and end measurements
      delta = {};

      // attach touchmove and touchend listeners
      element.addEventListener('touchmove', this, false);
      element.addEventListener('touchend', this, false);

    },
    move: function(event) {

      // ensure swiping with one touch and not pinching
      if ( event.touches.length > 1 || event.scale && event.scale !== 1) return

      if (options.disableScroll) event.preventDefault();

      var touches = event.touches[0];

      // measure change in x and y
      delta = {
        x: touches.pageX - start.x,
        y: touches.pageY - start.y
      }

      // determine if scrolling test has run - one time test
      if ( typeof isScrolling == 'undefined') {
        isScrolling = !!( isScrolling || Math.abs(delta.x) < Math.abs(delta.y) );
      }

      // if user is not trying to scroll vertically
      if (!isScrolling) {

        // prevent native scrolling
        event.preventDefault();

        // stop slideshow
        stop();

        // increase resistance if first or last slide
        if (options.continuous) { // we don't add resistance at the end

          translate(circle(index-1), delta.x + slidePos[circle(index-1)], 0);
          translate(index, delta.x + slidePos[index], 0);
          translate(circle(index+1), delta.x + slidePos[circle(index+1)], 0);

        } else {

          delta.x =
            delta.x /
              ( (!index && delta.x > 0               // if first slide and sliding left
                || index == slides.length - 1        // or if last slide and sliding right
                && delta.x < 0                       // and if sliding at all
              ) ?
              ( Math.abs(delta.x) / width + 1 )      // determine resistance level
              : 1 );                                 // no resistance if false

          // translate 1:1
          translate(index-1, delta.x + slidePos[index-1], 0);
          translate(index, delta.x + slidePos[index], 0);
          translate(index+1, delta.x + slidePos[index+1], 0);
        }

      }

    },
    end: function(event) {

      // measure duration
      var duration = +new Date - start.time;

      // determine if slide attempt triggers next/prev slide
      var isValidSlide =
            Number(duration) < 250               // if slide duration is less than 250ms
            && Math.abs(delta.x) > 20            // and if slide amt is greater than 20px
            || Math.abs(delta.x) > width/2;      // or if slide amt is greater than half the width

      // determine if slide attempt is past start and end
      var isPastBounds =
            !index && delta.x > 0                            // if first slide and slide amt is greater than 0
            || index == slides.length - 1 && delta.x < 0;    // or if last slide and slide amt is less than 0

      if (options.continuous) isPastBounds = false;

      // determine direction of swipe (true:right, false:left)
      var direction = delta.x < 0;

      // if not scrolling vertically
      if (!isScrolling) {

        if (isValidSlide && !isPastBounds) {

          if (direction) {

            if (options.continuous) { // we need to get the next in this direction in place

              move(circle(index-1), -width, 0);
              move(circle(index+2), width, 0);

            } else {
              move(index-1, -width, 0);
            }

            move(index, slidePos[index]-width, speed);
            move(circle(index+1), slidePos[circle(index+1)]-width, speed);
            index = circle(index+1);

          } else {
            if (options.continuous) { // we need to get the next in this direction in place

              move(circle(index+1), width, 0);
              move(circle(index-2), -width, 0);

            } else {
              move(index+1, width, 0);
            }

            move(index, slidePos[index]+width, speed);
            move(circle(index-1), slidePos[circle(index-1)]+width, speed);
            index = circle(index-1);

          }

          options.callback && options.callback(index, slides[index]);

        } else {

          if (options.continuous) {

            move(circle(index-1), -width, speed);
            move(index, 0, speed);
            move(circle(index+1), width, speed);

          } else {

            move(index-1, -width, speed);
            move(index, 0, speed);
            move(index+1, width, speed);
          }

        }

      }

      // kill touchmove and touchend event listeners until touchstart called again
      element.removeEventListener('touchmove', events, false)
      element.removeEventListener('touchend', events, false)

    },
    transitionEnd: function(event) {

      if (parseInt(event.target.getAttribute('data-index'), 10) == index) {

        if (delay) begin();

        options.transitionEnd && options.transitionEnd.call(event, index, slides[index]);

      }

    }

  }

  // trigger setup
  setup();

  // start auto slideshow if applicable
  if (delay) begin();


  // add event listeners
  if (browser.addEventListener) {

    // set touchstart event on element
    if (browser.touch) element.addEventListener('touchstart', events, false);

    if (browser.transitions) {
      element.addEventListener('webkitTransitionEnd', events, false);
      element.addEventListener('msTransitionEnd', events, false);
      element.addEventListener('oTransitionEnd', events, false);
      element.addEventListener('otransitionend', events, false);
      element.addEventListener('transitionend', events, false);
    }

    // set resize event on window
    window.addEventListener('resize', events, false);

  } else {

    window.onresize = function () { setup() }; // to play nice with old IE

  }

  // expose the Swipe API
  return {
    setup: function() {

      setup();

    },
    slide: function(to, speed) {

      // cancel slideshow
      stop();

      slide(to, speed);

    },
    prev: function() {

      // cancel slideshow
      stop();

      prev();

    },
    next: function() {

      // cancel slideshow
      stop();

      next();

    },
    stop: function() {

      // cancel slideshow
      stop();

    },
    getPos: function() {

      // return current index position
      return index;

    },
    getNumSlides: function() {

      // return total number of slides
      return length;
    },
    kill: function() {

      // cancel slideshow
      stop();

      // reset element
      element.style.width = '';
      element.style.left = '';

      // reset slides
      var pos = slides.length;
      while(pos--) {

        var slide = slides[pos];
        slide.style.width = '';
        slide.style.left = '';

        if (browser.transitions) translate(pos, 0, 0);

      }

      // removed event listeners
      if (browser.addEventListener) {

        // remove current event listeners
        element.removeEventListener('touchstart', events, false);
        element.removeEventListener('webkitTransitionEnd', events, false);
        element.removeEventListener('msTransitionEnd', events, false);
        element.removeEventListener('oTransitionEnd', events, false);
        element.removeEventListener('otransitionend', events, false);
        element.removeEventListener('transitionend', events, false);
        window.removeEventListener('resize', events, false);

      }
      else {

        window.onresize = null;

      }

    }
  }

}


if ( window.jQuery || window.Zepto ) {
  (function($) {
    $.fn.Swipe = function(params) {
      return this.each(function() {
        $(this).data('Swipe', new Swipe($(this)[0], params));
      });
    }
  })( window.jQuery || window.Zepto )
}
;
/* =========================================================
 * bootstrap-slider.js v2.0.0
 * http://www.eyecon.ro/bootstrap-slider
 * =========================================================
 * Copyright 2012 Stefan Petre
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
 
!function( $ ) {

	var Slider = function(element, options) {
		this.element = $(element);
		this.picker = $('<div class="slider">'+
							'<div class="slider-track">'+
								'<div class="slider-selection"></div>'+
								'<div class="slider-handle"></div>'+
								'<div class="slider-handle"></div>'+
							'</div>'+
							'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'+
						'</div>')
							.insertBefore(this.element)
							.append(this.element);
		this.id = this.element.data('slider-id')||options.id;
		if (this.id) {
			this.picker[0].id = this.id;
		}

		if (typeof Modernizr !== 'undefined' && Modernizr.touch) {
			this.touchCapable = true;
		}

		var tooltip = this.element.data('slider-tooltip')||options.tooltip;

		this.tooltip = this.picker.find('.tooltip');
		this.tooltipInner = this.tooltip.find('div.tooltip-inner');

		this.orientation = this.element.data('slider-orientation')||options.orientation;
		switch(this.orientation) {
			case 'vertical':
				this.picker.addClass('slider-vertical');
				this.stylePos = 'top';
				this.mousePos = 'pageY';
				this.sizePos = 'offsetHeight';
				this.tooltip.addClass('right')[0].style.left = '100%';
				break;
			default:
				this.picker
					.addClass('slider-horizontal')
					.css('width', this.element.outerWidth());
				this.orientation = 'horizontal';
				this.stylePos = 'left';
				this.mousePos = 'pageX';
				this.sizePos = 'offsetWidth';
				this.tooltip.addClass('top')[0].style.top = -this.tooltip.outerHeight() - 14 + 'px';
				break;
		}

		this.min = this.element.data('slider-min')||options.min;
		this.max = this.element.data('slider-max')||options.max;
		this.step = this.element.data('slider-step')||options.step;
		this.value = this.element.data('slider-value')||options.value;
		if (this.value[1]) {
			this.range = true;
		}

		this.selection = this.element.data('slider-selection')||options.selection;
		this.selectionEl = this.picker.find('.slider-selection');
		if (this.selection === 'none') {
			this.selectionEl.addClass('hide');
		}
		this.selectionElStyle = this.selectionEl[0].style;


		this.handle1 = this.picker.find('.slider-handle:first');
		this.handle1Stype = this.handle1[0].style;
		this.handle2 = this.picker.find('.slider-handle:last');
		this.handle2Stype = this.handle2[0].style;

		var handle = this.element.data('slider-handle')||options.handle;
		switch(handle) {
			case 'round':
				this.handle1.addClass('round');
				this.handle2.addClass('round');
				break
			case 'triangle':
				this.handle1.addClass('triangle');
				this.handle2.addClass('triangle');
				break
		}

		if (this.range) {
			this.value[0] = Math.max(this.min, Math.min(this.max, this.value[0]));
			this.value[1] = Math.max(this.min, Math.min(this.max, this.value[1]));
		} else {
			this.value = [ Math.max(this.min, Math.min(this.max, this.value))];
			this.handle2.addClass('hide');
			if (this.selection == 'after') {
				this.value[1] = this.max;
			} else {
				this.value[1] = this.min;
			}
		}
		this.diff = this.max - this.min;
		this.percentage = [
			(this.value[0]-this.min)*100/this.diff,
			(this.value[1]-this.min)*100/this.diff,
			this.step*100/this.diff
		];

		this.offset = this.picker.offset();
		this.size = this.picker[0][this.sizePos];

		this.formater = options.formater;

		this.layout();

		if (this.touchCapable) {
			// Touch: Bind touch events:
			this.picker.on({
				touchstart: $.proxy(this.mousedown, this)
			});
		} else {
			this.picker.on({
				mousedown: $.proxy(this.mousedown, this)
			});
		}

		if (tooltip === 'show') {
			this.picker.on({
				mouseenter: $.proxy(this.showTooltip, this),
				mouseleave: $.proxy(this.hideTooltip, this)
			});
		} else {
			this.tooltip.addClass('hide');
		}
	};

	Slider.prototype = {
		constructor: Slider,

		over: false,
		inDrag: false,
		
		showTooltip: function(){
			this.tooltip.addClass('in');
			//var left = Math.round(this.percent*this.width);
			//this.tooltip.css('left', left - this.tooltip.outerWidth()/2);
			this.over = true;
		},
		
		hideTooltip: function(){
			if (this.inDrag === false) {
				this.tooltip.removeClass('in');
			}
			this.over = false;
		},

		layout: function(){
			this.handle1Stype[this.stylePos] = this.percentage[0]+'%';
			this.handle2Stype[this.stylePos] = this.percentage[1]+'%';
			if (this.orientation == 'vertical') {
				this.selectionElStyle.top = Math.min(this.percentage[0], this.percentage[1]) +'%';
				this.selectionElStyle.height = Math.abs(this.percentage[0] - this.percentage[1]) +'%';
			} else {
				this.selectionElStyle.left = Math.min(this.percentage[0], this.percentage[1]) +'%';
				this.selectionElStyle.width = Math.abs(this.percentage[0] - this.percentage[1]) +'%';
			}
			if (this.range) {
				this.tooltipInner.text(
					this.formater(this.value[0]) + 
					' : ' + 
					this.formater(this.value[1])
				);
				this.tooltip[0].style[this.stylePos] = this.size * (this.percentage[0] + (this.percentage[1] - this.percentage[0])/2)/100 - (this.orientation === 'vertical' ? this.tooltip.outerHeight()/2 : this.tooltip.outerWidth()/2) +'px';
			} else {
				this.tooltipInner.text(
					this.formater(this.value[0])
				);
				this.tooltip[0].style[this.stylePos] = this.size * this.percentage[0]/100 - (this.orientation === 'vertical' ? this.tooltip.outerHeight()/2 : this.tooltip.outerWidth()/2) +'px';
			}
		},

		mousedown: function(ev) {

			// Touch: Get the original event:
			if (this.touchCapable && ev.type === 'touchstart') {
				ev = ev.originalEvent;
			}

			this.offset = this.picker.offset();
			this.size = this.picker[0][this.sizePos];

			var percentage = this.getPercentage(ev);

			if (this.range) {
				var diff1 = Math.abs(this.percentage[0] - percentage);
				var diff2 = Math.abs(this.percentage[1] - percentage);
				this.dragged = (diff1 < diff2) ? 0 : 1;
			} else {
				this.dragged = 0;
			}

			this.percentage[this.dragged] = percentage;
			this.layout();

			if (this.touchCapable) {
				// Touch: Bind touch events:
				$(document).on({
					touchmove: $.proxy(this.mousemove, this),
					touchend: $.proxy(this.mouseup, this)
				});
			} else {
				$(document).on({
					mousemove: $.proxy(this.mousemove, this),
					mouseup: $.proxy(this.mouseup, this)
				});
			}

			this.inDrag = true;
			var val = this.calculateValue();
			this.element.trigger({
					type: 'slideStart',
					value: val
				}).trigger({
					type: 'slide',
					value: val
				});
			return false;
		},

		mousemove: function(ev) {
			
			// Touch: Get the original event:
			if (this.touchCapable && ev.type === 'touchmove') {
				ev = ev.originalEvent;
			}

			var percentage = this.getPercentage(ev);
			if (this.range) {
				if (this.dragged === 0 && this.percentage[1] < percentage) {
					this.percentage[0] = this.percentage[1];
					this.dragged = 1;
				} else if (this.dragged === 1 && this.percentage[0] > percentage) {
					this.percentage[1] = this.percentage[0];
					this.dragged = 0;
				}
			}
			this.percentage[this.dragged] = percentage;
			this.layout();
			var val = this.calculateValue();
			this.element
				.trigger({
					type: 'slide',
					value: val
				})
				.data('value', val)
				.prop('value', val);
			return false;
		},

		mouseup: function(ev) {
			if (this.touchCapable) {
				// Touch: Bind touch events:
				$(document).off({
					touchmove: this.mousemove,
					touchend: this.mouseup
				});
			} else {
				$(document).off({
					mousemove: this.mousemove,
					mouseup: this.mouseup
				});
			}

			this.inDrag = false;
			if (this.over == false) {
				this.hideTooltip();
			}
			this.element;
			var val = this.calculateValue();
			this.element
				.trigger({
					type: 'slideStop',
					value: val
				})
				.data('value', val)
				.prop('value', val);
			return false;
		},

		calculateValue: function() {
			var val;
			if (this.range) {
				val = [
					(this.min + Math.round((this.diff * this.percentage[0]/100)/this.step)*this.step),
					(this.min + Math.round((this.diff * this.percentage[1]/100)/this.step)*this.step)
				];
				this.value = val;
			} else {
				val = (this.min + Math.round((this.diff * this.percentage[0]/100)/this.step)*this.step);
				this.value = [val, this.value[1]];
			}
			return val;
		},

		getPercentage: function(ev) {
			if (this.touchCapable) {
				ev = ev.touches[0];
			}
			var percentage = (ev[this.mousePos] - this.offset[this.stylePos])*100/this.size;
			percentage = Math.round(percentage/this.percentage[2])*this.percentage[2];
			return Math.max(0, Math.min(100, percentage));
		},

		getValue: function() {
			if (this.range) {
				return this.value;
			}
			return this.value[0];
		},

		setValue: function(val) {
			this.value = val;

			if (this.range) {
				this.value[0] = Math.max(this.min, Math.min(this.max, this.value[0]));
				this.value[1] = Math.max(this.min, Math.min(this.max, this.value[1]));
			} else {
				this.value = [ Math.max(this.min, Math.min(this.max, this.value))];
				this.handle2.addClass('hide');
				if (this.selection == 'after') {
					this.value[1] = this.max;
				} else {
					this.value[1] = this.min;
				}
			}
			this.diff = this.max - this.min;
			this.percentage = [
				(this.value[0]-this.min)*100/this.diff,
				(this.value[1]-this.min)*100/this.diff,
				this.step*100/this.diff
			];
			this.layout();
		}
	};

	$.fn.slider = function ( option, val ) {
		return this.each(function () {
			var $this = $(this),
				data = $this.data('slider'),
				options = typeof option === 'object' && option;
			if (!data)  {
				$this.data('slider', (data = new Slider(this, $.extend({}, $.fn.slider.defaults,options))));
			}
			if (typeof option == 'string') {
				data[option](val);
			}
		})
	};

	$.fn.slider.defaults = {
		min: 0,
		max: 10,
		step: 1,
		orientation: 'horizontal',
		value: 5,
		selection: 'before',
		tooltip: 'show',
		handle: 'round',
		formater: function(value) {
			return value;
		}
	};

	$.fn.slider.Constructor = Slider;

}( window.jQuery );;
/* Modernizr 2.6.2 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-touch-shiv-teststyles-prefixes-load
 */
;window.Modernizr=function(a,b,c){function v(a){i.cssText=a}function w(a,b){return v(l.join(a+";")+(b||""))}function x(a,b){return typeof a===b}function y(a,b){return!!~(""+a).indexOf(b)}function z(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:x(f,"function")?f.bind(d||b):f}return!1}var d="2.6.2",e={},f=b.documentElement,g="modernizr",h=b.createElement(g),i=h.style,j,k={}.toString,l=" -webkit- -moz- -o- -ms- ".split(" "),m={},n={},o={},p=[],q=p.slice,r,s=function(a,c,d,e){var h,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:g+(d+1),l.appendChild(j);return h=["&#173;",'<style id="s',g,'">',a,"</style>"].join(""),l.id=g,(m?l:n).innerHTML+=h,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=f.style.overflow,f.style.overflow="hidden",f.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),f.style.overflow=k),!!i},t={}.hasOwnProperty,u;!x(t,"undefined")&&!x(t.call,"undefined")?u=function(a,b){return t.call(a,b)}:u=function(a,b){return b in a&&x(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=q.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(q.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(q.call(arguments)))};return e}),m.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:s(["@media (",l.join("touch-enabled),("),g,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9}),c};for(var A in m)u(m,A)&&(r=A.toLowerCase(),e[r]=m[A](),p.push((e[r]?"":"no-")+r));return e.addTest=function(a,b){if(typeof a=="object")for(var d in a)u(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof enableClasses!="undefined"&&enableClasses&&(f.className+=" "+(b?"":"no-")+a),e[a]=b}return e},v(""),h=j=null,function(a,b){function k(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function l(){var a=r.elements;return typeof a=="string"?a.split(" "):a}function m(a){var b=i[a[g]];return b||(b={},h++,a[g]=h,i[h]=b),b}function n(a,c,f){c||(c=b);if(j)return c.createElement(a);f||(f=m(c));var g;return f.cache[a]?g=f.cache[a].cloneNode():e.test(a)?g=(f.cache[a]=f.createElem(a)).cloneNode():g=f.createElem(a),g.canHaveChildren&&!d.test(a)?f.frag.appendChild(g):g}function o(a,c){a||(a=b);if(j)return a.createDocumentFragment();c=c||m(a);var d=c.frag.cloneNode(),e=0,f=l(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function p(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return r.shivMethods?n(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+l().join().replace(/\w+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(r,b.frag)}function q(a){a||(a=b);var c=m(a);return r.shivCSS&&!f&&!c.hasCSS&&(c.hasCSS=!!k(a,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),j||p(a,c),a}var c=a.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,e=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,f,g="_html5shiv",h=0,i={},j;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",f="hidden"in a,j=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){f=!0,j=!0}})();var r={elements:c.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:c.shivCSS!==!1,supportsUnknownElements:j,shivMethods:c.shivMethods!==!1,type:"default",shivDocument:q,createElement:n,createDocumentFragment:o};a.html5=r,q(b)}(this,b),e._version=d,e._prefixes=l,e.testStyles=s,e}(this,this.document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};;
var peddle;
if (!peddle) peddle = {};
else if (typeof peddle != "object")
    throw new Error("peddle already exists and is not an object");


if (jQuery) (function ($) {
    $.extend($.fn, {
        peddleCalender: function (method, data) {

            var selector = this.selector;
            var visibleNoOfDates = 8;
            $.fn.peddleCalender.getCurrentMonth = function () {
                var month = ["January", "February", "March", "April",
                    "May", "June", "July", "August", "September",
                    "October", "November", "December"];
                var date = new Date();
                var currentMonth = date.getMonth();
                return month[currentMonth].toUpperCase();
            };

            $.fn.peddleCalender.getDisplayDates = function () {
                var displayDates = [];
                var date = new Date();
                var todaysDate = date.getDate();
                var dateToDisplay = visibleNoOfDates;
                var nextDate = todaysDate;

                while (dateToDisplay) {
                    displayDates.push(nextDate);
                    date.setDate(nextDate + 1);
                    nextDate = date.getDate();
                    dateToDisplay--;
                }
                return displayDates;
            };

            $.fn.peddleCalender.getDisplayWeeks = function () {
                var weeks = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];
                var dateToDisplay = visibleNoOfDates;
                var displayWeeks = [];
                var date = new Date();
                var today = date.getDay();

                while (dateToDisplay) {
                    if (today == 7) {
                        today = 0;
                    }
                    displayWeeks.push(weeks[today]);
                    today++;
                    dateToDisplay--;
                }
                return displayWeeks;
            };

            $.fn.peddleCalender.getSelectedDay = function () {
                var day = $('.dateContainerSelected .dayStyle');
                return day;
            };

            $.fn.peddleCalender.getSelectedDate = function () {
                var date = $('.dateContainerSelected .dateStyle');
                return date;
            };

            $.fn.peddleCalender.disableDate = function (index) {
                $('.dateContainer:visible').eq(index - 1).addClass('dateContainerDisable');
                $('.dateContainer:visible').eq(index - 1).find('.disableDate').show();
            };

            $.fn.peddleCalender.selectDate = function (index) {
                $('.dateContainer').removeClass('dateContainerSelected');
                $('.dateContainer:visible').eq(index - 1).addClass('dateContainerSelected');
            };

            $.fn.peddleCalender.prepareCalendarModal = function (method, data) {
                var currentMonth = $.fn.peddleCalender.getCurrentMonth();
                $('.currentMonth').text(currentMonth);

                var displayDates = $.fn.peddleCalender.getDisplayDates();
                var displayWeeks = $.fn.peddleCalender.getDisplayWeeks();

                var datesHtml = '';
                for (var dates = 0; dates < displayDates.length; dates++) {

                    datesHtml += '<div class="dateContainer">';
                    datesHtml += '<div class="disableDate"></div>';
                    datesHtml += '<h3 class="dateStyle">' + displayDates[dates] + '</h3>';
                    datesHtml += '<div class="dayStyle">' + displayWeeks[dates].toUpperCase() + '</div>';
                    datesHtml += '</div>';
                }

                $(selector).append(datesHtml);

                $('.dateContainer').click(function () {
                    if (!$(this).hasClass('dateContainerDisable')) {
                        $('.dateContainer').removeClass('dateContainerSelected');
                        $(this).addClass('dateContainerSelected');
                    }
                });
            };

            $.fn.peddleCalender.prepareCalendarModal(method, data);
        }
    });
})(jQuery);;
/**
 * Version: 1.0 Alpha-1 
 * Build Date: 13-Nov-2007
 * Copyright (c) 2006-2007, Coolite Inc. (http://www.coolite.com/). All rights reserved.
 * License: Licensed under The MIT License. See license.txt and http://www.datejs.com/license/. 
 * Website: http://www.datejs.com/ or http://www.coolite.com/datejs/
 */
Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|after|from)/i,subtract:/^(\-|before|ago)/i,yesterday:/^yesterday/i,today:/^t(oday)?/i,tomorrow:/^tomorrow/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^min(ute)?s?/i,hour:/^h(ou)?rs?/i,week:/^w(ee)?k/i,month:/^m(o(nth)?s?)?/i,day:/^d(ays?)?/i,year:/^y((ea)?rs?)?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a|p)/i},abbreviatedTimeZoneStandard:{GMT:"-000",EST:"-0400",CST:"-0500",MST:"-0600",PST:"-0700"},abbreviatedTimeZoneDST:{GMT:"-000",EDT:"-0500",CDT:"-0600",MDT:"-0700",PDT:"-0800"}};
Date.getMonthNumberFromName=function(name){var n=Date.CultureInfo.monthNames,m=Date.CultureInfo.abbreviatedMonthNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s){return i;}}
return-1;};Date.getDayNumberFromName=function(name){var n=Date.CultureInfo.dayNames,m=Date.CultureInfo.abbreviatedDayNames,o=Date.CultureInfo.shortestDayNames,s=name.toLowerCase();for(var i=0;i<n.length;i++){if(n[i].toLowerCase()==s||m[i].toLowerCase()==s){return i;}}
return-1;};Date.isLeapYear=function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));};Date.getDaysInMonth=function(year,month){return[31,(Date.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];};Date.getTimezoneOffset=function(s,dst){return(dst||false)?Date.CultureInfo.abbreviatedTimeZoneDST[s.toUpperCase()]:Date.CultureInfo.abbreviatedTimeZoneStandard[s.toUpperCase()];};Date.getTimezoneAbbreviation=function(offset,dst){var n=(dst||false)?Date.CultureInfo.abbreviatedTimeZoneDST:Date.CultureInfo.abbreviatedTimeZoneStandard,p;for(p in n){if(n[p]===offset){return p;}}
return null;};Date.prototype.clone=function(){return new Date(this.getTime());};Date.prototype.compareTo=function(date){if(isNaN(this)){throw new Error(this);}
if(date instanceof Date&&!isNaN(date)){return(this>date)?1:(this<date)?-1:0;}else{throw new TypeError(date);}};Date.prototype.equals=function(date){return(this.compareTo(date)===0);};Date.prototype.between=function(start,end){var t=this.getTime();return t>=start.getTime()&&t<=end.getTime();};Date.prototype.addMilliseconds=function(value){this.setMilliseconds(this.getMilliseconds()+value);return this;};Date.prototype.addSeconds=function(value){return this.addMilliseconds(value*1000);};Date.prototype.addMinutes=function(value){return this.addMilliseconds(value*60000);};Date.prototype.addHours=function(value){return this.addMilliseconds(value*3600000);};Date.prototype.addDays=function(value){return this.addMilliseconds(value*86400000);};Date.prototype.addWeeks=function(value){return this.addMilliseconds(value*604800000);};Date.prototype.addMonths=function(value){var n=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+value);this.setDate(Math.min(n,this.getDaysInMonth()));return this;};Date.prototype.addYears=function(value){return this.addMonths(value*12);};Date.prototype.add=function(config){if(typeof config=="number"){this._orient=config;return this;}
var x=config;if(x.millisecond||x.milliseconds){this.addMilliseconds(x.millisecond||x.milliseconds);}
if(x.second||x.seconds){this.addSeconds(x.second||x.seconds);}
if(x.minute||x.minutes){this.addMinutes(x.minute||x.minutes);}
if(x.hour||x.hours){this.addHours(x.hour||x.hours);}
if(x.month||x.months){this.addMonths(x.month||x.months);}
if(x.year||x.years){this.addYears(x.year||x.years);}
if(x.day||x.days){this.addDays(x.day||x.days);}
return this;};Date._validate=function(value,min,max,name){if(typeof value!="number"){throw new TypeError(value+" is not a Number.");}else if(value<min||value>max){throw new RangeError(value+" is not a valid value for "+name+".");}
return true;};Date.validateMillisecond=function(n){return Date._validate(n,0,999,"milliseconds");};Date.validateSecond=function(n){return Date._validate(n,0,59,"seconds");};Date.validateMinute=function(n){return Date._validate(n,0,59,"minutes");};Date.validateHour=function(n){return Date._validate(n,0,23,"hours");};Date.validateDay=function(n,year,month){return Date._validate(n,1,Date.getDaysInMonth(year,month),"days");};Date.validateMonth=function(n){return Date._validate(n,0,11,"months");};Date.validateYear=function(n){return Date._validate(n,1,9999,"seconds");};Date.prototype.set=function(config){var x=config;if(!x.millisecond&&x.millisecond!==0){x.millisecond=-1;}
if(!x.second&&x.second!==0){x.second=-1;}
if(!x.minute&&x.minute!==0){x.minute=-1;}
if(!x.hour&&x.hour!==0){x.hour=-1;}
if(!x.day&&x.day!==0){x.day=-1;}
if(!x.month&&x.month!==0){x.month=-1;}
if(!x.year&&x.year!==0){x.year=-1;}
if(x.millisecond!=-1&&Date.validateMillisecond(x.millisecond)){this.addMilliseconds(x.millisecond-this.getMilliseconds());}
if(x.second!=-1&&Date.validateSecond(x.second)){this.addSeconds(x.second-this.getSeconds());}
if(x.minute!=-1&&Date.validateMinute(x.minute)){this.addMinutes(x.minute-this.getMinutes());}
if(x.hour!=-1&&Date.validateHour(x.hour)){this.addHours(x.hour-this.getHours());}
if(x.month!==-1&&Date.validateMonth(x.month)){this.addMonths(x.month-this.getMonth());}
if(x.year!=-1&&Date.validateYear(x.year)){this.addYears(x.year-this.getFullYear());}
if(x.day!=-1&&Date.validateDay(x.day,this.getFullYear(),this.getMonth())){this.addDays(x.day-this.getDate());}
if(x.timezone){this.setTimezone(x.timezone);}
if(x.timezoneOffset){this.setTimezoneOffset(x.timezoneOffset);}
return this;};Date.prototype.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this;};Date.prototype.isLeapYear=function(){var y=this.getFullYear();return(((y%4===0)&&(y%100!==0))||(y%400===0));};Date.prototype.isWeekday=function(){return!(this.is().sat()||this.is().sun());};Date.prototype.getDaysInMonth=function(){return Date.getDaysInMonth(this.getFullYear(),this.getMonth());};Date.prototype.moveToFirstDayOfMonth=function(){return this.set({day:1});};Date.prototype.moveToLastDayOfMonth=function(){return this.set({day:this.getDaysInMonth()});};Date.prototype.moveToDayOfWeek=function(day,orient){var diff=(day-this.getDay()+7*(orient||+1))%7;return this.addDays((diff===0)?diff+=7*(orient||+1):diff);};Date.prototype.moveToMonth=function(month,orient){var diff=(month-this.getMonth()+12*(orient||+1))%12;return this.addMonths((diff===0)?diff+=12*(orient||+1):diff);};Date.prototype.getDayOfYear=function(){return Math.floor((this-new Date(this.getFullYear(),0,1))/86400000);};Date.prototype.getWeekOfYear=function(firstDayOfWeek){var y=this.getFullYear(),m=this.getMonth(),d=this.getDate();var dow=firstDayOfWeek||Date.CultureInfo.firstDayOfWeek;var offset=7+1-new Date(y,0,1).getDay();if(offset==8){offset=1;}
var daynum=((Date.UTC(y,m,d,0,0,0)-Date.UTC(y,0,1,0,0,0))/86400000)+1;var w=Math.floor((daynum-offset+7)/7);if(w===dow){y--;var prevOffset=7+1-new Date(y,0,1).getDay();if(prevOffset==2||prevOffset==8){w=53;}else{w=52;}}
return w;};Date.prototype.isDST=function(){console.log('isDST');return this.toString().match(/(E|C|M|P)(S|D)T/)[2]=="D";};Date.prototype.getTimezone=function(){return Date.getTimezoneAbbreviation(this.getUTCOffset,this.isDST());};Date.prototype.setTimezoneOffset=function(s){var here=this.getTimezoneOffset(),there=Number(s)*-6/10;this.addMinutes(there-here);return this;};Date.prototype.setTimezone=function(s){return this.setTimezoneOffset(Date.getTimezoneOffset(s));};Date.prototype.getUTCOffset=function(){var n=this.getTimezoneOffset()*-10/6,r;if(n<0){r=(n-10000).toString();return r[0]+r.substr(2);}else{r=(n+10000).toString();return"+"+r.substr(1);}};Date.prototype.getDayName=function(abbrev){return abbrev?Date.CultureInfo.abbreviatedDayNames[this.getDay()]:Date.CultureInfo.dayNames[this.getDay()];};Date.prototype.getMonthName=function(abbrev){return abbrev?Date.CultureInfo.abbreviatedMonthNames[this.getMonth()]:Date.CultureInfo.monthNames[this.getMonth()];};Date.prototype._toString=Date.prototype.toString;Date.prototype.toString=function(format){var self=this;var p=function p(s){return(s.toString().length==1)?"0"+s:s;};return (format && (typeof format == "string"))?format.replace(/dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?/g,function(format){switch(format){case"hh":return p(self.getHours()<13?self.getHours():(self.getHours()-12));case"h":return self.getHours()<13?self.getHours():(self.getHours()-12);case"HH":return p(self.getHours());case"H":return self.getHours();case"mm":return p(self.getMinutes());case"m":return self.getMinutes();case"ss":return p(self.getSeconds());case"s":return self.getSeconds();case"yyyy":return self.getFullYear();case"yy":return self.getFullYear().toString().substring(2,4);case"dddd":return self.getDayName();case"ddd":return self.getDayName(true);case"dd":return p(self.getDate());case"d":return self.getDate().toString();case"MMMM":return self.getMonthName();case"MMM":return self.getMonthName(true);case"MM":return p((self.getMonth()+1));case"M":return self.getMonth()+1;case"t":return self.getHours()<12?Date.CultureInfo.amDesignator.substring(0,1):Date.CultureInfo.pmDesignator.substring(0,1);case"tt":return self.getHours()<12?Date.CultureInfo.amDesignator:Date.CultureInfo.pmDesignator;case"zzz":case"zz":case"z":return"";}}):this._toString();};
Date.now=function(){return new Date();};Date.today=function(){return Date.now().clearTime();};Date.prototype._orient=+1;Date.prototype.next=function(){this._orient=+1;return this;};Date.prototype.last=Date.prototype.prev=Date.prototype.previous=function(){this._orient=-1;return this;};Date.prototype._is=false;Date.prototype.is=function(){this._is=true;return this;};Number.prototype._dateElement="day";Number.prototype.fromNow=function(){var c={};c[this._dateElement]=this;return Date.now().add(c);};Number.prototype.ago=function(){var c={};c[this._dateElement]=this*-1;return Date.now().add(c);};(function(){var $D=Date.prototype,$N=Number.prototype;var dx=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),mx=("january february march april may june july august september october november december").split(/\s/),px=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),de;var df=function(n){return function(){if(this._is){this._is=false;return this.getDay()==n;}
return this.moveToDayOfWeek(n,this._orient);};};for(var i=0;i<dx.length;i++){$D[dx[i]]=$D[dx[i].substring(0,3)]=df(i);}
var mf=function(n){return function(){if(this._is){this._is=false;return this.getMonth()===n;}
return this.moveToMonth(n,this._orient);};};for(var j=0;j<mx.length;j++){$D[mx[j]]=$D[mx[j].substring(0,3)]=mf(j);}
var ef=function(j){return function(){if(j.substring(j.length-1)!="s"){j+="s";}
return this["add"+j](this._orient);};};var nf=function(n){return function(){this._dateElement=n;return this;};};for(var k=0;k<px.length;k++){de=px[k].toLowerCase();$D[de]=$D[de+"s"]=ef(px[k]);$N[de]=$N[de+"s"]=nf(de);}}());Date.prototype.toJSONString=function(){return this.toString("yyyy-MM-ddThh:mm:ssZ");};Date.prototype.toShortDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortDatePattern);};Date.prototype.toLongDateString=function(){return this.toString(Date.CultureInfo.formatPatterns.longDatePattern);};Date.prototype.toShortTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.shortTimePattern);};Date.prototype.toLongTimeString=function(){return this.toString(Date.CultureInfo.formatPatterns.longTimePattern);};Date.prototype.getOrdinal=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th";}};
(function(){Date.Parsing={Exception:function(s){this.message="Parse error at '"+s.substring(0,10)+" ...'";}};var $P=Date.Parsing;var _=$P.Operators={rtoken:function(r){return function(s){var mx=s.match(r);if(mx){return([mx[0],s.substring(mx[0].length)]);}else{throw new $P.Exception(s);}};},token:function(s){return function(s){return _.rtoken(new RegExp("^\s*"+s+"\s*"))(s);};},stoken:function(s){return _.rtoken(new RegExp("^"+s));},until:function(p){return function(s){var qx=[],rx=null;while(s.length){try{rx=p.call(this,s);}catch(e){qx.push(rx[0]);s=rx[1];continue;}
break;}
return[qx,s];};},many:function(p){return function(s){var rx=[],r=null;while(s.length){try{r=p.call(this,s);}catch(e){return[rx,s];}
rx.push(r[0]);s=r[1];}
return[rx,s];};},optional:function(p){return function(s){var r=null;try{r=p.call(this,s);}catch(e){return[null,s];}
return[r[0],r[1]];};},not:function(p){return function(s){try{p.call(this,s);}catch(e){return[null,s];}
throw new $P.Exception(s);};},ignore:function(p){return p?function(s){var r=null;r=p.call(this,s);return[null,r[1]];}:null;},product:function(){var px=arguments[0],qx=Array.prototype.slice.call(arguments,1),rx=[];for(var i=0;i<px.length;i++){rx.push(_.each(px[i],qx));}
return rx;},cache:function(rule){var cache={},r=null;return function(s){try{r=cache[s]=(cache[s]||rule.call(this,s));}catch(e){r=cache[s]=e;}
if(r instanceof $P.Exception){throw r;}else{return r;}};},any:function(){var px=arguments;return function(s){var r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){r=null;}
if(r){return r;}}
throw new $P.Exception(s);};},each:function(){var px=arguments;return function(s){var rx=[],r=null;for(var i=0;i<px.length;i++){if(px[i]==null){continue;}
try{r=(px[i].call(this,s));}catch(e){throw new $P.Exception(s);}
rx.push(r[0]);s=r[1];}
return[rx,s];};},all:function(){var px=arguments,_=_;return _.each(_.optional(px));},sequence:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;if(px.length==1){return px[0];}
return function(s){var r=null,q=null;var rx=[];for(var i=0;i<px.length;i++){try{r=px[i].call(this,s);}catch(e){break;}
rx.push(r[0]);try{q=d.call(this,r[1]);}catch(ex){q=null;break;}
s=q[1];}
if(!r){throw new $P.Exception(s);}
if(q){throw new $P.Exception(q[1]);}
if(c){try{r=c.call(this,r[1]);}catch(ey){throw new $P.Exception(r[1]);}}
return[rx,(r?r[1]:s)];};},between:function(d1,p,d2){d2=d2||d1;var _fn=_.each(_.ignore(d1),p,_.ignore(d2));return function(s){var rx=_fn.call(this,s);return[[rx[0][0],r[0][2]],rx[1]];};},list:function(p,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return(p instanceof Array?_.each(_.product(p.slice(0,-1),_.ignore(d)),p.slice(-1),_.ignore(c)):_.each(_.many(_.each(p,_.ignore(d))),px,_.ignore(c)));},set:function(px,d,c){d=d||_.rtoken(/^\s*/);c=c||null;return function(s){var r=null,p=null,q=null,rx=null,best=[[],s],last=false;for(var i=0;i<px.length;i++){q=null;p=null;r=null;last=(px.length==1);try{r=px[i].call(this,s);}catch(e){continue;}
rx=[[r[0]],r[1]];if(r[1].length>0&&!last){try{q=d.call(this,r[1]);}catch(ex){last=true;}}else{last=true;}
if(!last&&q[1].length===0){last=true;}
if(!last){var qx=[];for(var j=0;j<px.length;j++){if(i!=j){qx.push(px[j]);}}
p=_.set(qx,d).call(this,q[1]);if(p[0].length>0){rx[0]=rx[0].concat(p[0]);rx[1]=p[1];}}
if(rx[1].length<best[1].length){best=rx;}
if(best[1].length===0){break;}}
if(best[0].length===0){return best;}
if(c){try{q=c.call(this,best[1]);}catch(ey){throw new $P.Exception(best[1]);}
best[1]=q[1];}
return best;};},forward:function(gr,fname){return function(s){return gr[fname].call(this,s);};},replace:function(rule,repl){return function(s){var r=rule.call(this,s);return[repl,r[1]];};},process:function(rule,fn){return function(s){var r=rule.call(this,s);return[fn.call(this,r[0]),r[1]];};},min:function(min,rule){return function(s){var rx=rule.call(this,s);if(rx[0].length<min){throw new $P.Exception(s);}
return rx;};}};var _generator=function(op){return function(){var args=null,rx=[];if(arguments.length>1){args=Array.prototype.slice.call(arguments);}else if(arguments[0]instanceof Array){args=arguments[0];}
if(args){for(var i=0,px=args.shift();i<px.length;i++){args.unshift(px[i]);rx.push(op.apply(null,args));args.shift();return rx;}}else{return op.apply(null,arguments);}};};var gx="optional not ignore cache".split(/\s/);for(var i=0;i<gx.length;i++){_[gx[i]]=_generator(_[gx[i]]);}
var _vector=function(op){return function(){if(arguments[0]instanceof Array){return op.apply(null,arguments[0]);}else{return op.apply(null,arguments);}};};var vx="each any all".split(/\s/);for(var j=0;j<vx.length;j++){_[vx[j]]=_vector(_[vx[j]]);}}());(function(){var flattenAndCompact=function(ax){var rx=[];for(var i=0;i<ax.length;i++){if(ax[i]instanceof Array){rx=rx.concat(flattenAndCompact(ax[i]));}else{if(ax[i]){rx.push(ax[i]);}}}
return rx;};Date.Grammar={};Date.Translator={hour:function(s){return function(){this.hour=Number(s);};},minute:function(s){return function(){this.minute=Number(s);};},second:function(s){return function(){this.second=Number(s);};},meridian:function(s){return function(){this.meridian=s.slice(0,1).toLowerCase();};},timezone:function(s){return function(){var n=s.replace(/[^\d\+\-]/g,"");if(n.length){this.timezoneOffset=Number(n);}else{this.timezone=s.toLowerCase();}};},day:function(x){var s=x[0];return function(){this.day=Number(s.match(/\d+/)[0]);};},month:function(s){return function(){this.month=((s.length==3)?Date.getMonthNumberFromName(s):(Number(s)-1));};},year:function(s){return function(){var n=Number(s);this.year=((s.length>2)?n:(n+(((n+2000)<Date.CultureInfo.twoDigitYearMax)?2000:1900)));};},rday:function(s){return function(){switch(s){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break;}};},finishExact:function(x){x=(x instanceof Array)?x:[x];var now=new Date();this.year=now.getFullYear();this.month=now.getMonth();this.day=1;this.hour=0;this.minute=0;this.second=0;for(var i=0;i<x.length;i++){if(x[i]){x[i].call(this);}}
this.hour=(this.meridian=="p"&&this.hour<13)?this.hour+12:this.hour;if(this.day>Date.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.");}
var r=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){r.set({timezone:this.timezone});}else if(this.timezoneOffset){r.set({timezoneOffset:this.timezoneOffset});}
return r;},finish:function(x){x=(x instanceof Array)?flattenAndCompact(x):[x];if(x.length===0){return null;}
for(var i=0;i<x.length;i++){if(typeof x[i]=="function"){x[i].call(this);}}
if(this.now){return new Date();}
var today=Date.today();var method=null;var expression=!!(this.days!=null||this.orient||this.operator);if(expression){var gap,mod,orient;orient=((this.orient=="past"||this.operator=="subtract")?-1:1);if(this.weekday){this.unit="day";gap=(Date.getDayNumberFromName(this.weekday)-today.getDay());mod=7;this.days=gap?((gap+(orient*mod))%mod):(orient*mod);}
if(this.month){this.unit="month";gap=(this.month-today.getMonth());mod=12;this.months=gap?((gap+(orient*mod))%mod):(orient*mod);this.month=null;}
if(!this.unit){this.unit="day";}
if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1;}
if(this.unit=="week"){this.unit="day";this.value=this.value*7;}
this[this.unit+"s"]=this.value*orient;}
return today.add(this);}else{if(this.meridian&&this.hour){this.hour=(this.hour<13&&this.meridian=="p")?this.hour+12:this.hour;}
if(this.weekday&&!this.day){this.day=(today.addDays((Date.getDayNumberFromName(this.weekday)-today.getDay()))).getDate();}
if(this.month&&!this.day){this.day=1;}
return today.set(this);}}};var _=Date.Parsing.Operators,g=Date.Grammar,t=Date.Translator,_fn;g.datePartDelimiter=_.rtoken(/^([\s\-\.\,\/\x27]+)/);g.timePartDelimiter=_.stoken(":");g.whiteSpace=_.rtoken(/^\s*/);g.generalDelimiter=_.rtoken(/^(([\s\,]|at|on)+)/);var _C={};g.ctoken=function(keys){var fn=_C[keys];if(!fn){var c=Date.CultureInfo.regexPatterns;var kx=keys.split(/\s+/),px=[];for(var i=0;i<kx.length;i++){px.push(_.replace(_.rtoken(c[kx[i]]),kx[i]));}
fn=_C[keys]=_.any.apply(null,px);}
return fn;};g.ctoken2=function(key){return _.rtoken(Date.CultureInfo.regexPatterns[key]);};g.h=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),t.hour));g.hh=_.cache(_.process(_.rtoken(/^(0[0-9]|1[0-2])/),t.hour));g.H=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),t.hour));g.HH=_.cache(_.process(_.rtoken(/^([0-1][0-9]|2[0-3])/),t.hour));g.m=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.minute));g.mm=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.minute));g.s=_.cache(_.process(_.rtoken(/^([0-5][0-9]|[0-9])/),t.second));g.ss=_.cache(_.process(_.rtoken(/^[0-5][0-9]/),t.second));g.hms=_.cache(_.sequence([g.H,g.mm,g.ss],g.timePartDelimiter));g.t=_.cache(_.process(g.ctoken2("shortMeridian"),t.meridian));g.tt=_.cache(_.process(g.ctoken2("longMeridian"),t.meridian));g.z=_.cache(_.process(_.rtoken(/^(\+|\-)?\s*\d\d\d\d?/),t.timezone));g.zz=_.cache(_.process(_.rtoken(/^(\+|\-)\s*\d\d\d\d/),t.timezone));g.zzz=_.cache(_.process(g.ctoken2("timezone"),t.timezone));g.timeSuffix=_.each(_.ignore(g.whiteSpace),_.set([g.tt,g.zzz]));g.time=_.each(_.optional(_.ignore(_.stoken("T"))),g.hms,g.timeSuffix);g.d=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1]|\d)/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.dd=_.cache(_.process(_.each(_.rtoken(/^([0-2]\d|3[0-1])/),_.optional(g.ctoken2("ordinalSuffix"))),t.day));g.ddd=g.dddd=_.cache(_.process(g.ctoken("sun mon tue wed thu fri sat"),function(s){return function(){this.weekday=s;};}));g.M=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d|\d)/),t.month));g.MM=_.cache(_.process(_.rtoken(/^(1[0-2]|0\d)/),t.month));g.MMM=g.MMMM=_.cache(_.process(g.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),t.month));g.y=_.cache(_.process(_.rtoken(/^(\d\d?)/),t.year));g.yy=_.cache(_.process(_.rtoken(/^(\d\d)/),t.year));g.yyy=_.cache(_.process(_.rtoken(/^(\d\d?\d?\d?)/),t.year));g.yyyy=_.cache(_.process(_.rtoken(/^(\d\d\d\d)/),t.year));_fn=function(){return _.each(_.any.apply(null,arguments),_.not(g.ctoken2("timeContext")));};g.day=_fn(g.d,g.dd);g.month=_fn(g.M,g.MMM);g.year=_fn(g.yyyy,g.yy);g.orientation=_.process(g.ctoken("past future"),function(s){return function(){this.orient=s;};});g.operator=_.process(g.ctoken("add subtract"),function(s){return function(){this.operator=s;};});g.rday=_.process(g.ctoken("yesterday tomorrow today now"),t.rday);g.unit=_.process(g.ctoken("minute hour day week month year"),function(s){return function(){this.unit=s;};});g.value=_.process(_.rtoken(/^\d\d?(st|nd|rd|th)?/),function(s){return function(){this.value=s.replace(/\D/g,"");};});g.expression=_.set([g.rday,g.operator,g.value,g.unit,g.orientation,g.ddd,g.MMM]);_fn=function(){return _.set(arguments,g.datePartDelimiter);};g.mdy=_fn(g.ddd,g.month,g.day,g.year);g.ymd=_fn(g.ddd,g.year,g.month,g.day);g.dmy=_fn(g.ddd,g.day,g.month,g.year);g.date=function(s){return((g[Date.CultureInfo.dateElementOrder]||g.mdy).call(this,s));};g.format=_.process(_.many(_.any(_.process(_.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(fmt){if(g[fmt]){return g[fmt];}else{throw Date.Parsing.Exception(fmt);}}),_.process(_.rtoken(/^[^dMyhHmstz]+/),function(s){return _.ignore(_.stoken(s));}))),function(rules){return _.process(_.each.apply(null,rules),t.finishExact);});var _F={};var _get=function(f){return _F[f]=(_F[f]||g.format(f)[0]);};g.formats=function(fx){if(fx instanceof Array){var rx=[];for(var i=0;i<fx.length;i++){rx.push(_get(fx[i]));}
return _.any.apply(null,rx);}else{return _get(fx);}};g._formats=g.formats(["yyyy-MM-ddTHH:mm:ss","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","d"]);g._start=_.process(_.set([g.date,g.time,g.expression],g.generalDelimiter,g.whiteSpace),t.finish);g.start=function(s){try{var r=g._formats.call({},s);if(r[1].length===0){return r;}}catch(e){}
return g._start.call({},s);};}());Date._parse=Date.parse;Date.parse=function(s){var r=null;if(!s){return null;}
try{r=Date.Grammar.start.call({},s);}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};Date.getParseFunction=function(fx){var fn=Date.Grammar.formats(fx);return function(s){var r=null;try{r=fn.call({},s);}catch(e){return null;}
return((r[1].length===0)?r[0]:null);};};Date.parseExact=function(s,fx){return Date.getParseFunction(fx)(s);};
;
/* =========================================================
 * bootstrap-datetimepicker.js
 * =========================================================
 * Copyright 2012 Stefan Petre
 * Improvements by Andrew Rowls
 * Improvements by SÃ©bastien Malot
 * Improvements by Yun Lai
 * Improvements by Kenneth Henderick
 * Project URL : http://www.malot.fr/bootstrap-datetimepicker
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */

/*
 * Improvement by CuGBabyBeaR @ 2013-09-12
 *
 * Make it work in bootstrap v3
 */

!function ($) {

	function UTCDate() {
		return new Date(Date.UTC.apply(Date, arguments));
	}

	function UTCToday() {
		var today = new Date();
		return UTCDate(today.getUTCFullYear(), today.getUTCMonth(), today.getUTCDate(), today.getUTCHours(), today.getUTCMinutes(), today.getUTCSeconds(), 0);
	}

	// Picker object

	var Datetimepicker = function (element, options) {
		var that = this;

		this.element = $(element);

		// add container for single page application
		// when page switch the datetimepicker div will be removed also.
		this.container = options.container || 'body';

		this.language = options.language || this.element.data('date-language') || "en";
		this.language = this.language in dates ? this.language : "en";
		this.isRTL = dates[this.language].rtl || false;
		this.formatType = options.formatType || this.element.data('format-type') || 'standard';
		this.format = DPGlobal.parseFormat(options.format || this.element.data('date-format') || dates[this.language].format || DPGlobal.getDefaultFormat(this.formatType, 'input'), this.formatType);
		this.isInline = false;
		this.isVisible = false;
		this.isInput = this.element.is('input');
		this.fontAwesome = options.fontAwesome || this.element.data('font-awesome') || false;

		this.bootcssVer = options.bootcssVer || (this.isInput ? (this.element.is('.form-control') ? 3 : 2) : ( this.bootcssVer = this.element.is('.input-group') ? 3 : 2 ));

		this.component = this.element.is('.date') ? ( this.bootcssVer == 3 ? this.element.find('.input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-calendar, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o').parent() : this.element.find('.add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar .fa-calendar .fa-clock-o').parent()) : false;
		this.componentReset = this.element.is('.date') ? ( this.bootcssVer == 3 ? this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent()) : false;
		this.hasInput = this.component && this.element.find('input').length;
		if (this.component && this.component.length === 0) {
			this.component = false;
		}
		this.linkField = options.linkField || this.element.data('link-field') || false;
		this.linkFormat = DPGlobal.parseFormat(options.linkFormat || this.element.data('link-format') || DPGlobal.getDefaultFormat(this.formatType, 'link'), this.formatType);
		this.minuteStep = options.minuteStep || this.element.data('minute-step') || 5;
		this.pickerPosition = options.pickerPosition || this.element.data('picker-position') || 'bottom-right';
		this.showMeridian = options.showMeridian || this.element.data('show-meridian') || false;
		this.initialDate = options.initialDate || new Date();
		this.zIndex = options.zIndex || this.element.data('z-index') || undefined;

		this.icons = {
			leftArrow: this.fontAwesome ? 'fa-arrow-left' : (this.bootcssVer === 3 ? 'glyphicon-chevron-left' : 'icon-arrow-left'),
			rightArrow: this.fontAwesome ? 'fa-arrow-right' : (this.bootcssVer === 3 ? 'glyphicon-chevron-right' : 'icon-arrow-right')
		};
		this.icontype = this.fontAwesome ? 'fa' : 'glyphicon';

		this._attachEvents();

		this.formatViewType = "datetime";
		if ('formatViewType' in options) {
			this.formatViewType = options.formatViewType;
		} else if ('formatViewType' in this.element.data()) {
			this.formatViewType = this.element.data('formatViewType');
		}

		this.minView = 0;
		if ('minView' in options) {
			this.minView = options.minView;
		} else if ('minView' in this.element.data()) {
			this.minView = this.element.data('min-view');
		}
		this.minView = DPGlobal.convertViewMode(this.minView);

		this.maxView = DPGlobal.modes.length - 1;
		if ('maxView' in options) {
			this.maxView = options.maxView;
		} else if ('maxView' in this.element.data()) {
			this.maxView = this.element.data('max-view');
		}
		this.maxView = DPGlobal.convertViewMode(this.maxView);

		this.wheelViewModeNavigation = false;
		if ('wheelViewModeNavigation' in options) {
			this.wheelViewModeNavigation = options.wheelViewModeNavigation;
		} else if ('wheelViewModeNavigation' in this.element.data()) {
			this.wheelViewModeNavigation = this.element.data('view-mode-wheel-navigation');
		}

		this.wheelViewModeNavigationInverseDirection = false;

		if ('wheelViewModeNavigationInverseDirection' in options) {
			this.wheelViewModeNavigationInverseDirection = options.wheelViewModeNavigationInverseDirection;
		} else if ('wheelViewModeNavigationInverseDirection' in this.element.data()) {
			this.wheelViewModeNavigationInverseDirection = this.element.data('view-mode-wheel-navigation-inverse-dir');
		}

		this.wheelViewModeNavigationDelay = 100;
		if ('wheelViewModeNavigationDelay' in options) {
			this.wheelViewModeNavigationDelay = options.wheelViewModeNavigationDelay;
		} else if ('wheelViewModeNavigationDelay' in this.element.data()) {
			this.wheelViewModeNavigationDelay = this.element.data('view-mode-wheel-navigation-delay');
		}

		this.startViewMode = 2;
		if ('startView' in options) {
			this.startViewMode = options.startView;
		} else if ('startView' in this.element.data()) {
			this.startViewMode = this.element.data('start-view');
		}
		this.startViewMode = DPGlobal.convertViewMode(this.startViewMode);
		this.viewMode = this.startViewMode;

		this.viewSelect = this.minView;
		if ('viewSelect' in options) {
			this.viewSelect = options.viewSelect;
		} else if ('viewSelect' in this.element.data()) {
			this.viewSelect = this.element.data('view-select');
		}
		this.viewSelect = DPGlobal.convertViewMode(this.viewSelect);

		this.forceParse = true;
		if ('forceParse' in options) {
			this.forceParse = options.forceParse;
		} else if ('dateForceParse' in this.element.data()) {
			this.forceParse = this.element.data('date-force-parse');
		}
		var template = this.bootcssVer === 3 ? DPGlobal.templateV3 : DPGlobal.template;
		while (template.indexOf('{iconType}') !== -1) {
			template = template.replace('{iconType}', this.icontype);
		}
		while (template.indexOf('{leftArrow}') !== -1) {
			template = template.replace('{leftArrow}', this.icons.leftArrow);
		}
		while (template.indexOf('{rightArrow}') !== -1) {
			template = template.replace('{rightArrow}', this.icons.rightArrow);
		}
		this.picker = $(template)
			.appendTo(this.isInline ? this.element : this.container) // 'body')
			.on({
				click:     $.proxy(this.click, this),
				mousedown: $.proxy(this.mousedown, this)
			});

		if (this.wheelViewModeNavigation) {
			if ($.fn.mousewheel) {
				this.picker.on({mousewheel: $.proxy(this.mousewheel, this)});
			} else {
				console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option");
			}
		}

		if (this.isInline) {
			this.picker.addClass('datetimepicker-inline');
		} else {
			this.picker.addClass('datetimepicker-dropdown-' + this.pickerPosition + ' dropdown-menu');
		}
		if (this.isRTL) {
			this.picker.addClass('datetimepicker-rtl');
			var selector = this.bootcssVer === 3 ? '.prev span, .next span' : '.prev i, .next i';
			this.picker.find(selector).toggleClass(this.icons.leftArrow + ' ' + this.icons.rightArrow);
		}
		$(document).on('mousedown', function (e) {
			// Clicked outside the datetimepicker, hide it
			if ($(e.target).closest('.datetimepicker').length === 0) {
				that.hide();
			}
		});

		this.autoclose = false;
		if ('autoclose' in options) {
			this.autoclose = options.autoclose;
		} else if ('dateAutoclose' in this.element.data()) {
			this.autoclose = this.element.data('date-autoclose');
		}

		this.keyboardNavigation = true;
		if ('keyboardNavigation' in options) {
			this.keyboardNavigation = options.keyboardNavigation;
		} else if ('dateKeyboardNavigation' in this.element.data()) {
			this.keyboardNavigation = this.element.data('date-keyboard-navigation');
		}

		this.todayBtn = (options.todayBtn || this.element.data('date-today-btn') || false);
		this.todayHighlight = (options.todayHighlight || this.element.data('date-today-highlight') || false);

		this.weekStart = ((options.weekStart || this.element.data('date-weekstart') || dates[this.language].weekStart || 0) % 7);
		this.weekEnd = ((this.weekStart + 6) % 7);
		this.startDate = -Infinity;
		this.endDate = Infinity;
		this.daysOfWeekDisabled = [];
		this.setStartDate(options.startDate || this.element.data('date-startdate'));
		this.setEndDate(options.endDate || this.element.data('date-enddate'));
		this.setDaysOfWeekDisabled(options.daysOfWeekDisabled || this.element.data('date-days-of-week-disabled'));
		this.setMinutesDisabled(options.minutesDisabled || this.element.data('date-minute-disabled'));
		this.setHoursDisabled(options.hoursDisabled || this.element.data('date-hour-disabled'));
		this.fillDow();
		this.fillMonths();
		this.update();
		this.showMode();

		if (this.isInline) {
			this.show();
		}
	};

	Datetimepicker.prototype = {
		constructor: Datetimepicker,

		_events:       [],
		_attachEvents: function () {
			this._detachEvents();
			if (this.isInput) { // single input
				this._events = [
					[this.element, {
						focus:   $.proxy(this.show, this),
						keyup:   $.proxy(this.update, this),
						keydown: $.proxy(this.keydown, this)
					}]
				];
			}
			else if (this.component && this.hasInput) { // component: input + button
				this._events = [
					// For components that are not readonly, allow keyboard nav
					[this.element.find('input'), {
						focus:   $.proxy(this.show, this),
						keyup:   $.proxy(this.update, this),
						keydown: $.proxy(this.keydown, this)
					}],
					[this.component, {
						click: $.proxy(this.show, this)
					}]
				];
				if (this.componentReset) {
					this._events.push([
						this.componentReset,
						{click: $.proxy(this.reset, this)}
					]);
				}
			}
			else if (this.element.is('div')) {  // inline datetimepicker
				this.isInline = true;
			}
			else {
				this._events = [
					[this.element, {
						click: $.proxy(this.show, this)
					}]
				];
			}
			for (var i = 0, el, ev; i < this._events.length; i++) {
				el = this._events[i][0];
				ev = this._events[i][1];
				el.on(ev);
			}
		},

		_detachEvents: function () {
			for (var i = 0, el, ev; i < this._events.length; i++) {
				el = this._events[i][0];
				ev = this._events[i][1];
				el.off(ev);
			}
			this._events = [];
		},

		show: function (e) {
			this.picker.show();
			this.height = this.component ? this.component.outerHeight() : this.element.outerHeight();
			if (this.forceParse) {
				this.update();
			}
			this.place();
			$(window).on('resize', $.proxy(this.place, this));
			if (e) {
				e.stopPropagation();
				e.preventDefault();
			}
			this.isVisible = true;
			this.element.trigger({
				type: 'show',
				date: this.date
			});
		},

		hide: function (e) {
			if (!this.isVisible) return;
			if (this.isInline) return;
			this.picker.hide();
			$(window).off('resize', this.place);
			this.viewMode = this.startViewMode;
			this.showMode();
			if (!this.isInput) {
				$(document).off('mousedown', this.hide);
			}

			if (
				this.forceParse &&
					(
						this.isInput && this.element.val() ||
							this.hasInput && this.element.find('input').val()
						)
				)
				this.setValue();
			this.isVisible = false;
			this.element.trigger({
				type: 'hide',
				date: this.date
			});
		},

		remove: function () {
			this._detachEvents();
			this.picker.remove();
			delete this.picker;
			delete this.element.data().datetimepicker;
		},

		getDate: function () {
			var d = this.getUTCDate();
			return new Date(d.getTime() + (d.getTimezoneOffset() * 60000));
		},

		getUTCDate: function () {
			return this.date;
		},

		setDate: function (d) {
			this.setUTCDate(new Date(d.getTime() - (d.getTimezoneOffset() * 60000)));
		},

		setUTCDate: function (d) {
			if (d >= this.startDate && d <= this.endDate) {
				this.date = d;
				this.setValue();
				this.viewDate = this.date;
				this.fill();
			} else {
				this.element.trigger({
					type:      'outOfRange',
					date:      d,
					startDate: this.startDate,
					endDate:   this.endDate
				});
			}
		},

		setFormat: function (format) {
			this.format = DPGlobal.parseFormat(format, this.formatType);
			var element;
			if (this.isInput) {
				element = this.element;
			} else if (this.component) {
				element = this.element.find('input');
			}
			if (element && element.val()) {
				this.setValue();
			}
		},

		setValue: function () {
			var formatted = this.getFormattedDate();
			if (!this.isInput) {
				if (this.component) {
					this.element.find('input').val(formatted);
				}
				this.element.data('date', formatted);
			} else {
				this.element.val(formatted);
			}
			if (this.linkField) {
				$('#' + this.linkField).val(this.getFormattedDate(this.linkFormat));
			}
		},

		getFormattedDate: function (format) {
			if (format == undefined) format = this.format;
			return DPGlobal.formatDate(this.date, format, this.language, this.formatType);
		},

		setStartDate: function (startDate) {
			this.startDate = startDate || -Infinity;
			if (this.startDate !== -Infinity) {
				this.startDate = DPGlobal.parseDate(this.startDate, this.format, this.language, this.formatType);
			}
			this.update();
			this.updateNavArrows();
		},

		setEndDate: function (endDate) {
			this.endDate = endDate || Infinity;
			if (this.endDate !== Infinity) {
				this.endDate = DPGlobal.parseDate(this.endDate, this.format, this.language, this.formatType);
			}
			this.update();
			this.updateNavArrows();
		},

		setDaysOfWeekDisabled: function (daysOfWeekDisabled) {
			this.daysOfWeekDisabled = daysOfWeekDisabled || [];
			if (!$.isArray(this.daysOfWeekDisabled)) {
				this.daysOfWeekDisabled = this.daysOfWeekDisabled.split(/,\s*/);
			}
			this.daysOfWeekDisabled = $.map(this.daysOfWeekDisabled, function (d) {
				return parseInt(d, 10);
			});
			this.update();
			this.updateNavArrows();
		},

		setMinutesDisabled: function (minutesDisabled) {
			this.minutesDisabled = minutesDisabled || [];
			if (!$.isArray(this.minutesDisabled)) {
				this.minutesDisabled = this.minutesDisabled.split(/,\s*/);
			}
			this.minutesDisabled = $.map(this.minutesDisabled, function (d) {
				return parseInt(d, 10);
			});
			this.update();
			this.updateNavArrows();
		},

		setHoursDisabled: function (hoursDisabled) {
			this.hoursDisabled = hoursDisabled || [];
			if (!$.isArray(this.hoursDisabled)) {
				this.hoursDisabled = this.hoursDisabled.split(/,\s*/);
			}
			this.hoursDisabled = $.map(this.hoursDisabled, function (d) {
				return parseInt(d, 10);
			});
			this.update();
			this.updateNavArrows();
		},

		place: function () {
			if (this.isInline) return;

			if (!this.zIndex) {
				var index_highest = 0;
				$('div').each(function () {
					var index_current = parseInt($(this).css("zIndex"), 10);
					if (index_current > index_highest) {
						index_highest = index_current;
					}
				});
				this.zIndex = index_highest + 10;
			}

			var offset, top, left, containerOffset;
			if (this.container instanceof $) {
				containerOffset = this.container.offset();
			} else {
				containerOffset = $(this.container).offset();
			}

			if (this.component) {
				offset = this.component.offset();
				left = offset.left;
				if (this.pickerPosition == 'bottom-left' || this.pickerPosition == 'top-left') {
					left += this.component.outerWidth() - this.picker.outerWidth();
				}
			} else {
				offset = this.element.offset();
				left = offset.left;
			}

			if(left+220 > document.body.clientWidth){
            			left = document.body.clientWidth-220;
          		}

			if (this.pickerPosition == 'top-left' || this.pickerPosition == 'top-right') {
				top = offset.top - this.picker.outerHeight();
			} else {
				top = offset.top + this.height;
			}

			top = top - containerOffset.top;
			left = left - containerOffset.left;

			if(this.container != 'body') top = top + document.body.scrollTop

			this.picker.css({
				top:    top,
				left:   left,
				zIndex: this.zIndex
			});
		},

		update: function () {
			var date, fromArgs = false;
			if (arguments && arguments.length && (typeof arguments[0] === 'string' || arguments[0] instanceof Date)) {
				date = arguments[0];
				fromArgs = true;
			} else {
				date = (this.isInput ? this.element.val() : this.element.find('input').val()) || this.element.data('date') || this.initialDate;
				if (typeof date == 'string' || date instanceof String) {
				  date = date.replace(/^\s+|\s+$/g,'');
				}
			}

			if (!date) {
				date = new Date();
				fromArgs = false;
			}

			this.date = DPGlobal.parseDate(date, this.format, this.language, this.formatType);

			if (fromArgs) this.setValue();

			if (this.date < this.startDate) {
				this.viewDate = new Date(this.startDate);
			} else if (this.date > this.endDate) {
				this.viewDate = new Date(this.endDate);
			} else {
				this.viewDate = new Date(this.date);
			}
			this.fill();
		},

		fillDow: function () {
			var dowCnt = this.weekStart,
				html = '<tr>';
			while (dowCnt < this.weekStart + 7) {
				html += '<th class="dow">' + dates[this.language].daysMin[(dowCnt++) % 7] + '</th>';
			}
			html += '</tr>';
			this.picker.find('.datetimepicker-days thead').append(html);
		},

		fillMonths: function () {
			var html = '',
				i = 0;
			while (i < 12) {
				html += '<span class="month">' + dates[this.language].monthsShort[i++] + '</span>';
			}
			this.picker.find('.datetimepicker-months td').html(html);
		},

		fill: function () {
			if (this.date == null || this.viewDate == null) {
				return;
			}
			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth(),
				dayMonth = d.getUTCDate(),
				hours = d.getUTCHours(),
				minutes = d.getUTCMinutes(),
				startYear = this.startDate !== -Infinity ? this.startDate.getUTCFullYear() : -Infinity,
				startMonth = this.startDate !== -Infinity ? this.startDate.getUTCMonth() + 1 : -Infinity,
				endYear = this.endDate !== Infinity ? this.endDate.getUTCFullYear() : Infinity,
				endMonth = this.endDate !== Infinity ? this.endDate.getUTCMonth() + 1 : Infinity,
				currentDate = (new UTCDate(this.date.getUTCFullYear(), this.date.getUTCMonth(), this.date.getUTCDate())).valueOf(),
				today = new Date();
			this.picker.find('.datetimepicker-days thead th:eq(1)')
				.text(dates[this.language].months[month] + ' ' + year);
			if (this.formatViewType == "time") {
				var formatted = this.getFormattedDate();
				this.picker.find('.datetimepicker-hours thead th:eq(1)').text(formatted);
				this.picker.find('.datetimepicker-minutes thead th:eq(1)').text(formatted);
			} else {
				this.picker.find('.datetimepicker-hours thead th:eq(1)')
					.text(dayMonth + ' ' + dates[this.language].months[month] + ' ' + year);
				this.picker.find('.datetimepicker-minutes thead th:eq(1)')
					.text(dayMonth + ' ' + dates[this.language].months[month] + ' ' + year);
			}
			this.picker.find('tfoot th.today')
				.text(dates[this.language].today)
				.toggle(this.todayBtn !== false);
			this.updateNavArrows();
			this.fillMonths();
			/*var prevMonth = UTCDate(year, month, 0,0,0,0,0);
			 prevMonth.setUTCDate(prevMonth.getDate() - (prevMonth.getUTCDay() - this.weekStart + 7)%7);*/
			var prevMonth = UTCDate(year, month - 1, 28, 0, 0, 0, 0),
				day = DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(), prevMonth.getUTCMonth());
			prevMonth.setUTCDate(day);
			prevMonth.setUTCDate(day - (prevMonth.getUTCDay() - this.weekStart + 7) % 7);
			var nextMonth = new Date(prevMonth);
			nextMonth.setUTCDate(nextMonth.getUTCDate() + 42);
			nextMonth = nextMonth.valueOf();
			var html = [];
			var clsName;
			while (prevMonth.valueOf() < nextMonth) {
				if (prevMonth.getUTCDay() == this.weekStart) {
					html.push('<tr>');
				}
				clsName = '';
				if (prevMonth.getUTCFullYear() < year || (prevMonth.getUTCFullYear() == year && prevMonth.getUTCMonth() < month)) {
					clsName += ' old';
				} else if (prevMonth.getUTCFullYear() > year || (prevMonth.getUTCFullYear() == year && prevMonth.getUTCMonth() > month)) {
					clsName += ' new';
				}
				// Compare internal UTC date with local today, not UTC today
				if (this.todayHighlight &&
					prevMonth.getUTCFullYear() == today.getFullYear() &&
					prevMonth.getUTCMonth() == today.getMonth() &&
					prevMonth.getUTCDate() == today.getDate()) {
					clsName += ' today';
				}
				if (prevMonth.valueOf() == currentDate) {
					clsName += ' active';
				}
				if ((prevMonth.valueOf() + 86400000) <= this.startDate || prevMonth.valueOf() > this.endDate ||
					$.inArray(prevMonth.getUTCDay(), this.daysOfWeekDisabled) !== -1) {
					clsName += ' disabled';
				}
				html.push('<td class="day' + clsName + '">' + prevMonth.getUTCDate() + '</td>');
				if (prevMonth.getUTCDay() == this.weekEnd) {
					html.push('</tr>');
				}
				prevMonth.setUTCDate(prevMonth.getUTCDate() + 1);
			}
			this.picker.find('.datetimepicker-days tbody').empty().append(html.join(''));

			html = [];
			var txt = '', meridian = '', meridianOld = '';
			var hoursDisabled = this.hoursDisabled || [];
			for (var i = 0; i < 24; i++) {
				if (hoursDisabled.indexOf(i) !== -1) continue;
				var actual = UTCDate(year, month, dayMonth, i);
				clsName = '';
				// We want the previous hour for the startDate
				if ((actual.valueOf() + 3600000) <= this.startDate || actual.valueOf() > this.endDate) {
					clsName += ' disabled';
				} else if (hours == i) {
					clsName += ' active';
				}
				if (this.showMeridian && dates[this.language].meridiem.length == 2) {
					meridian = (i < 12 ? dates[this.language].meridiem[0] : dates[this.language].meridiem[1]);
					if (meridian != meridianOld) {
						if (meridianOld != '') {
							html.push('</fieldset>');
						}
						html.push('<fieldset class="hour"><legend>' + meridian.toUpperCase() + '</legend>');
					}
					meridianOld = meridian;
					txt = (i % 12 ? i % 12 : 12);
					html.push('<span class="hour' + clsName + ' hour_' + (i < 12 ? 'am' : 'pm') + '">' + txt + '</span>');
					if (i == 23) {
						html.push('</fieldset>');
					}
				} else {
					txt = i + ':00';
					html.push('<span class="hour' + clsName + '">' + txt + '</span>');
				}
			}
			this.picker.find('.datetimepicker-hours td').html(html.join(''));

			html = [];
			txt = '', meridian = '', meridianOld = '';
			var minutesDisabled = this.minutesDisabled || [];
			for (var i = 0; i < 60; i += this.minuteStep) {
				if (minutesDisabled.indexOf(i) !== -1) continue;
				var actual = UTCDate(year, month, dayMonth, hours, i, 0);
				clsName = '';
				if (actual.valueOf() < this.startDate || actual.valueOf() > this.endDate) {
					clsName += ' disabled';
				} else if (Math.floor(minutes / this.minuteStep) == Math.floor(i / this.minuteStep)) {
					clsName += ' active';
				}
				if (this.showMeridian && dates[this.language].meridiem.length == 2) {
					meridian = (hours < 12 ? dates[this.language].meridiem[0] : dates[this.language].meridiem[1]);
					if (meridian != meridianOld) {
						if (meridianOld != '') {
							html.push('</fieldset>');
						}
						html.push('<fieldset class="minute"><legend>' + meridian.toUpperCase() + '</legend>');
					}
					meridianOld = meridian;
					txt = (hours % 12 ? hours % 12 : 12);
					//html.push('<span class="minute'+clsName+' minute_'+(hours<12?'am':'pm')+'">'+txt+'</span>');
					html.push('<span class="minute' + clsName + '">' + txt + ':' + (i < 10 ? '0' + i : i) + '</span>');
					if (i == 59) {
						html.push('</fieldset>');
					}
				} else {
					txt = i + ':00';
					//html.push('<span class="hour'+clsName+'">'+txt+'</span>');
					html.push('<span class="minute' + clsName + '">' + hours + ':' + (i < 10 ? '0' + i : i) + '</span>');
				}
			}
			this.picker.find('.datetimepicker-minutes td').html(html.join(''));

			var currentYear = this.date.getUTCFullYear();
			var months = this.picker.find('.datetimepicker-months')
				.find('th:eq(1)')
				.text(year)
				.end()
				.find('span').removeClass('active');
			if (currentYear == year) {
				// getUTCMonths() returns 0 based, and we need to select the next one
				months.eq(this.date.getUTCMonth() + 2).addClass('active');
			}
			if (year < startYear || year > endYear) {
				months.addClass('disabled');
			}
			if (year == startYear) {
				months.slice(0, startMonth + 1).addClass('disabled');
			}
			if (year == endYear) {
				months.slice(endMonth).addClass('disabled');
			}

			html = '';
			year = parseInt(year / 10, 10) * 10;
			var yearCont = this.picker.find('.datetimepicker-years')
				.find('th:eq(1)')
				.text(year + '-' + (year + 9))
				.end()
				.find('td');
			year -= 1;
			for (var i = -1; i < 11; i++) {
				html += '<span class="year' + (i == -1 || i == 10 ? ' old' : '') + (currentYear == year ? ' active' : '') + (year < startYear || year > endYear ? ' disabled' : '') + '">' + year + '</span>';
				year += 1;
			}
			yearCont.html(html);
			this.place();
		},

		updateNavArrows: function () {
			var d = new Date(this.viewDate),
				year = d.getUTCFullYear(),
				month = d.getUTCMonth(),
				day = d.getUTCDate(),
				hour = d.getUTCHours();
			switch (this.viewMode) {
				case 0:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear()
						&& month <= this.startDate.getUTCMonth()
						&& day <= this.startDate.getUTCDate()
						&& hour <= this.startDate.getUTCHours()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear()
						&& month >= this.endDate.getUTCMonth()
						&& day >= this.endDate.getUTCDate()
						&& hour >= this.endDate.getUTCHours()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
				case 1:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear()
						&& month <= this.startDate.getUTCMonth()
						&& day <= this.startDate.getUTCDate()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear()
						&& month >= this.endDate.getUTCMonth()
						&& day >= this.endDate.getUTCDate()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
				case 2:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear()
						&& month <= this.startDate.getUTCMonth()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear()
						&& month >= this.endDate.getUTCMonth()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
				case 3:
				case 4:
					if (this.startDate !== -Infinity && year <= this.startDate.getUTCFullYear()) {
						this.picker.find('.prev').css({visibility: 'hidden'});
					} else {
						this.picker.find('.prev').css({visibility: 'visible'});
					}
					if (this.endDate !== Infinity && year >= this.endDate.getUTCFullYear()) {
						this.picker.find('.next').css({visibility: 'hidden'});
					} else {
						this.picker.find('.next').css({visibility: 'visible'});
					}
					break;
			}
		},

		mousewheel: function (e) {

			e.preventDefault();
			e.stopPropagation();

			if (this.wheelPause) {
				return;
			}

			this.wheelPause = true;

			var originalEvent = e.originalEvent;

			var delta = originalEvent.wheelDelta;

			var mode = delta > 0 ? 1 : (delta === 0) ? 0 : -1;

			if (this.wheelViewModeNavigationInverseDirection) {
				mode = -mode;
			}

			this.showMode(mode);

			setTimeout($.proxy(function () {

				this.wheelPause = false

			}, this), this.wheelViewModeNavigationDelay);

		},

		click: function (e) {
			e.stopPropagation();
			e.preventDefault();
			var target = $(e.target).closest('span, td, th, legend');
			if (target.is('.' + this.icontype)) {
				target = $(target).parent().closest('span, td, th, legend');
			}
			if (target.length == 1) {
				if (target.is('.disabled')) {
					this.element.trigger({
						type:      'outOfRange',
						date:      this.viewDate,
						startDate: this.startDate,
						endDate:   this.endDate
					});
					return;
				}
				switch (target[0].nodeName.toLowerCase()) {
					case 'th':
						switch (target[0].className) {
							case 'switch':
								this.showMode(1);
								break;
							case 'prev':
							case 'next':
								var dir = DPGlobal.modes[this.viewMode].navStep * (target[0].className == 'prev' ? -1 : 1);
								switch (this.viewMode) {
									case 0:
										this.viewDate = this.moveHour(this.viewDate, dir);
										break;
									case 1:
										this.viewDate = this.moveDate(this.viewDate, dir);
										break;
									case 2:
										this.viewDate = this.moveMonth(this.viewDate, dir);
										break;
									case 3:
									case 4:
										this.viewDate = this.moveYear(this.viewDate, dir);
										break;
								}
								this.fill();
								this.element.trigger({
									type:      target[0].className + ':' + this.convertViewModeText(this.viewMode),
									date:      this.viewDate,
									startDate: this.startDate,
									endDate:   this.endDate
								});
								break;
							case 'today':
								var date = new Date();
								date = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds(), 0);

								// Respect startDate and endDate.
								if (date < this.startDate) date = this.startDate;
								else if (date > this.endDate) date = this.endDate;

								this.viewMode = this.startViewMode;
								this.showMode(0);
								this._setDate(date);
								this.fill();
								if (this.autoclose) {
									this.hide();
								}
								break;
						}
						break;
					case 'span':
						if (!target.is('.disabled')) {
							var year = this.viewDate.getUTCFullYear(),
								month = this.viewDate.getUTCMonth(),
								day = this.viewDate.getUTCDate(),
								hours = this.viewDate.getUTCHours(),
								minutes = this.viewDate.getUTCMinutes(),
								seconds = this.viewDate.getUTCSeconds();

							if (target.is('.month')) {
								this.viewDate.setUTCDate(1);
								month = target.parent().find('span').index(target);
								day = this.viewDate.getUTCDate();
								this.viewDate.setUTCMonth(month);
								this.element.trigger({
									type: 'changeMonth',
									date: this.viewDate
								});
								if (this.viewSelect >= 3) {
									this._setDate(UTCDate(year, month, day, hours, minutes, seconds, 0));
								}
							} else if (target.is('.year')) {
								this.viewDate.setUTCDate(1);
								year = parseInt(target.text(), 10) || 0;
								this.viewDate.setUTCFullYear(year);
								this.element.trigger({
									type: 'changeYear',
									date: this.viewDate
								});
								if (this.viewSelect >= 4) {
									this._setDate(UTCDate(year, month, day, hours, minutes, seconds, 0));
								}
							} else if (target.is('.hour')) {
								hours = parseInt(target.text(), 10) || 0;
								if (target.hasClass('hour_am') || target.hasClass('hour_pm')) {
									if (hours == 12 && target.hasClass('hour_am')) {
										hours = 0;
									} else if (hours != 12 && target.hasClass('hour_pm')) {
										hours += 12;
									}
								}
								this.viewDate.setUTCHours(hours);
								this.element.trigger({
									type: 'changeHour',
									date: this.viewDate
								});
								if (this.viewSelect >= 1) {
									this._setDate(UTCDate(year, month, day, hours, minutes, seconds, 0));
								}
							} else if (target.is('.minute')) {
								minutes = parseInt(target.text().substr(target.text().indexOf(':') + 1), 10) || 0;
								this.viewDate.setUTCMinutes(minutes);
								this.element.trigger({
									type: 'changeMinute',
									date: this.viewDate
								});
								if (this.viewSelect >= 0) {
									this._setDate(UTCDate(year, month, day, hours, minutes, seconds, 0));
								}
							}
							if (this.viewMode != 0) {
								var oldViewMode = this.viewMode;
								this.showMode(-1);
								this.fill();
								if (oldViewMode == this.viewMode && this.autoclose) {
									this.hide();
								}
							} else {
								this.fill();
								if (this.autoclose) {
									this.hide();
								}
							}
						}
						break;
					case 'td':
						if (target.is('.day') && !target.is('.disabled')) {
							var day = parseInt(target.text(), 10) || 1;
							var year = this.viewDate.getUTCFullYear(),
								month = this.viewDate.getUTCMonth(),
								hours = this.viewDate.getUTCHours(),
								minutes = this.viewDate.getUTCMinutes(),
								seconds = this.viewDate.getUTCSeconds();
							if (target.is('.old')) {
								if (month === 0) {
									month = 11;
									year -= 1;
								} else {
									month -= 1;
								}
							} else if (target.is('.new')) {
								if (month == 11) {
									month = 0;
									year += 1;
								} else {
									month += 1;
								}
							}
							this.viewDate.setUTCFullYear(year);
							this.viewDate.setUTCMonth(month, day);
							this.element.trigger({
								type: 'changeDay',
								date: this.viewDate
							});
							if (this.viewSelect >= 2) {
								this._setDate(UTCDate(year, month, day, hours, minutes, seconds, 0));
							}
						}
						var oldViewMode = this.viewMode;
						this.showMode(-1);
						this.fill();
						if (oldViewMode == this.viewMode && this.autoclose) {
							this.hide();
						}
						break;
				}
			}
		},

		_setDate: function (date, which) {
			if (!which || which == 'date')
				this.date = date;
			if (!which || which == 'view')
				this.viewDate = date;
			this.fill();
			this.setValue();
			var element;
			if (this.isInput) {
				element = this.element;
			} else if (this.component) {
				element = this.element.find('input');
			}
			if (element) {
				element.change();
				if (this.autoclose && (!which || which == 'date')) {
					//this.hide();
				}
			}
			this.element.trigger({
				type: 'changeDate',
				date: this.date
			});
		},

		moveMinute: function (date, dir) {
			if (!dir) return date;
			var new_date = new Date(date.valueOf());
			//dir = dir > 0 ? 1 : -1;
			new_date.setUTCMinutes(new_date.getUTCMinutes() + (dir * this.minuteStep));
			return new_date;
		},

		moveHour: function (date, dir) {
			if (!dir) return date;
			var new_date = new Date(date.valueOf());
			//dir = dir > 0 ? 1 : -1;
			new_date.setUTCHours(new_date.getUTCHours() + dir);
			return new_date;
		},

		moveDate: function (date, dir) {
			if (!dir) return date;
			var new_date = new Date(date.valueOf());
			//dir = dir > 0 ? 1 : -1;
			new_date.setUTCDate(new_date.getUTCDate() + dir);
			return new_date;
		},

		moveMonth: function (date, dir) {
			if (!dir) return date;
			var new_date = new Date(date.valueOf()),
				day = new_date.getUTCDate(),
				month = new_date.getUTCMonth(),
				mag = Math.abs(dir),
				new_month, test;
			dir = dir > 0 ? 1 : -1;
			if (mag == 1) {
				test = dir == -1
					// If going back one month, make sure month is not current month
					// (eg, Mar 31 -> Feb 31 == Feb 28, not Mar 02)
					? function () {
					return new_date.getUTCMonth() == month;
				}
					// If going forward one month, make sure month is as expected
					// (eg, Jan 31 -> Feb 31 == Feb 28, not Mar 02)
					: function () {
					return new_date.getUTCMonth() != new_month;
				};
				new_month = month + dir;
				new_date.setUTCMonth(new_month);
				// Dec -> Jan (12) or Jan -> Dec (-1) -- limit expected date to 0-11
				if (new_month < 0 || new_month > 11)
					new_month = (new_month + 12) % 12;
			} else {
				// For magnitudes >1, move one month at a time...
				for (var i = 0; i < mag; i++)
					// ...which might decrease the day (eg, Jan 31 to Feb 28, etc)...
					new_date = this.moveMonth(new_date, dir);
				// ...then reset the day, keeping it in the new month
				new_month = new_date.getUTCMonth();
				new_date.setUTCDate(day);
				test = function () {
					return new_month != new_date.getUTCMonth();
				};
			}
			// Common date-resetting loop -- if date is beyond end of month, make it
			// end of month
			while (test()) {
				new_date.setUTCDate(--day);
				new_date.setUTCMonth(new_month);
			}
			return new_date;
		},

		moveYear: function (date, dir) {
			return this.moveMonth(date, dir * 12);
		},

		dateWithinRange: function (date) {
			return date >= this.startDate && date <= this.endDate;
		},

		keydown: function (e) {
			if (this.picker.is(':not(:visible)')) {
				if (e.keyCode == 27) // allow escape to hide and re-show picker
					this.show();
				return;
			}
			var dateChanged = false,
				dir, day, month,
				newDate, newViewDate;
			switch (e.keyCode) {
				case 27: // escape
					this.hide();
					e.preventDefault();
					break;
				case 37: // left
				case 39: // right
					if (!this.keyboardNavigation) break;
					dir = e.keyCode == 37 ? -1 : 1;
					viewMode = this.viewMode;
					if (e.ctrlKey) {
						viewMode += 2;
					} else if (e.shiftKey) {
						viewMode += 1;
					}
					if (viewMode == 4) {
						newDate = this.moveYear(this.date, dir);
						newViewDate = this.moveYear(this.viewDate, dir);
					} else if (viewMode == 3) {
						newDate = this.moveMonth(this.date, dir);
						newViewDate = this.moveMonth(this.viewDate, dir);
					} else if (viewMode == 2) {
						newDate = this.moveDate(this.date, dir);
						newViewDate = this.moveDate(this.viewDate, dir);
					} else if (viewMode == 1) {
						newDate = this.moveHour(this.date, dir);
						newViewDate = this.moveHour(this.viewDate, dir);
					} else if (viewMode == 0) {
						newDate = this.moveMinute(this.date, dir);
						newViewDate = this.moveMinute(this.viewDate, dir);
					}
					if (this.dateWithinRange(newDate)) {
						this.date = newDate;
						this.viewDate = newViewDate;
						this.setValue();
						this.update();
						e.preventDefault();
						dateChanged = true;
					}
					break;
				case 38: // up
				case 40: // down
					if (!this.keyboardNavigation) break;
					dir = e.keyCode == 38 ? -1 : 1;
					viewMode = this.viewMode;
					if (e.ctrlKey) {
						viewMode += 2;
					} else if (e.shiftKey) {
						viewMode += 1;
					}
					if (viewMode == 4) {
						newDate = this.moveYear(this.date, dir);
						newViewDate = this.moveYear(this.viewDate, dir);
					} else if (viewMode == 3) {
						newDate = this.moveMonth(this.date, dir);
						newViewDate = this.moveMonth(this.viewDate, dir);
					} else if (viewMode == 2) {
						newDate = this.moveDate(this.date, dir * 7);
						newViewDate = this.moveDate(this.viewDate, dir * 7);
					} else if (viewMode == 1) {
						if (this.showMeridian) {
							newDate = this.moveHour(this.date, dir * 6);
							newViewDate = this.moveHour(this.viewDate, dir * 6);
						} else {
							newDate = this.moveHour(this.date, dir * 4);
							newViewDate = this.moveHour(this.viewDate, dir * 4);
						}
					} else if (viewMode == 0) {
						newDate = this.moveMinute(this.date, dir * 4);
						newViewDate = this.moveMinute(this.viewDate, dir * 4);
					}
					if (this.dateWithinRange(newDate)) {
						this.date = newDate;
						this.viewDate = newViewDate;
						this.setValue();
						this.update();
						e.preventDefault();
						dateChanged = true;
					}
					break;
				case 13: // enter
					if (this.viewMode != 0) {
						var oldViewMode = this.viewMode;
						this.showMode(-1);
						this.fill();
						if (oldViewMode == this.viewMode && this.autoclose) {
							this.hide();
						}
					} else {
						this.fill();
						if (this.autoclose) {
							this.hide();
						}
					}
					e.preventDefault();
					break;
				case 9: // tab
					this.hide();
					break;
			}
			if (dateChanged) {
				var element;
				if (this.isInput) {
					element = this.element;
				} else if (this.component) {
					element = this.element.find('input');
				}
				if (element) {
					element.change();
				}
				this.element.trigger({
					type: 'changeDate',
					date: this.date
				});
			}
		},

		showMode: function (dir) {
			if (dir) {
				var newViewMode = Math.max(0, Math.min(DPGlobal.modes.length - 1, this.viewMode + dir));
				if (newViewMode >= this.minView && newViewMode <= this.maxView) {
					this.element.trigger({
						type:        'changeMode',
						date:        this.viewDate,
						oldViewMode: this.viewMode,
						newViewMode: newViewMode
					});

					this.viewMode = newViewMode;
				}
			}
			/*
			 vitalets: fixing bug of very special conditions:
			 jquery 1.7.1 + webkit + show inline datetimepicker in bootstrap popover.
			 Method show() does not set display css correctly and datetimepicker is not shown.
			 Changed to .css('display', 'block') solve the problem.
			 See https://github.com/vitalets/x-editable/issues/37

			 In jquery 1.7.2+ everything works fine.
			 */
			//this.picker.find('>div').hide().filter('.datetimepicker-'+DPGlobal.modes[this.viewMode].clsName).show();
			this.picker.find('>div').hide().filter('.datetimepicker-' + DPGlobal.modes[this.viewMode].clsName).css('display', 'block');
			this.updateNavArrows();
		},

		reset: function (e) {
			this._setDate(null, 'date');
		},

		convertViewModeText:  function (viewMode) {
			switch (viewMode) {
				case 4:
					return 'decade';
				case 3:
					return 'year';
				case 2:
					return 'month';
				case 1:
					return 'day';
				case 0:
					return 'hour';
			}
		}
	};

	var old = $.fn.datetimepicker;
	$.fn.datetimepicker = function (option) {
		var args = Array.apply(null, arguments);
		args.shift();
		var internal_return;
		this.each(function () {
			var $this = $(this),
				data = $this.data('datetimepicker'),
				options = typeof option == 'object' && option;
			if (!data) {
				$this.data('datetimepicker', (data = new Datetimepicker(this, $.extend({}, $.fn.datetimepicker.defaults, options))));
			}
			if (typeof option == 'string' && typeof data[option] == 'function') {
				internal_return = data[option].apply(data, args);
				if (internal_return !== undefined) {
					return false;
				}
			}
		});
		if (internal_return !== undefined)
			return internal_return;
		else
			return this;
	};

	$.fn.datetimepicker.defaults = {
	};
	$.fn.datetimepicker.Constructor = Datetimepicker;
	var dates = $.fn.datetimepicker.dates = {
		en: {
			days:        ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"],
			daysShort:   ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
			daysMin:     ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"],
			months:      ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
			monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
			meridiem:    ["am", "pm"],
			suffix:      ["st", "nd", "rd", "th"],
			today:       "Today"
		}
	};

	var DPGlobal = {
		modes:            [
			{
				clsName: 'minutes',
				navFnc:  'Hours',
				navStep: 1
			},
			{
				clsName: 'hours',
				navFnc:  'Date',
				navStep: 1
			},
			{
				clsName: 'days',
				navFnc:  'Month',
				navStep: 1
			},
			{
				clsName: 'months',
				navFnc:  'FullYear',
				navStep: 1
			},
			{
				clsName: 'years',
				navFnc:  'FullYear',
				navStep: 10
			}
		],
		isLeapYear:       function (year) {
			return (((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0))
		},
		getDaysInMonth:   function (year, month) {
			return [31, (DPGlobal.isLeapYear(year) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][month]
		},
		getDefaultFormat: function (type, field) {
			if (type == "standard") {
				if (field == 'input')
					return 'yyyy-mm-dd hh:ii';
				else
					return 'yyyy-mm-dd hh:ii:ss';
			} else if (type == "php") {
				if (field == 'input')
					return 'Y-m-d H:i';
				else
					return 'Y-m-d H:i:s';
			} else {
				throw new Error("Invalid format type.");
			}
		},
		validParts:       function (type) {
			if (type == "standard") {
				return /hh?|HH?|p|P|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;
			} else if (type == "php") {
				return /[dDjlNwzFmMnStyYaABgGhHis]/g;
			} else {
				throw new Error("Invalid format type.");
			}
		},
		nonpunctuation:   /[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,
		parseFormat:      function (format, type) {
			// IE treats \0 as a string end in inputs (truncating the value),
			// so it's a bad format delimiter, anyway
			var separators = format.replace(this.validParts(type), '\0').split('\0'),
				parts = format.match(this.validParts(type));
			if (!separators || !separators.length || !parts || parts.length == 0) {
				throw new Error("Invalid date format.");
			}
			return {separators: separators, parts: parts};
		},
		parseDate:        function (date, format, language, type) {
			if (date instanceof Date) {
				var dateUTC = new Date(date.valueOf() - date.getTimezoneOffset() * 60000);
				dateUTC.setMilliseconds(0);
				return dateUTC;
			}
			if (/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(date)) {
				format = this.parseFormat('yyyy-mm-dd', type);
			}
			if (/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(date)) {
				format = this.parseFormat('yyyy-mm-dd hh:ii', type);
			}
			if (/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(date)) {
				format = this.parseFormat('yyyy-mm-dd hh:ii:ss', type);
			}
			if (/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(date)) {
				var part_re = /([-+]\d+)([dmwy])/,
					parts = date.match(/([-+]\d+)([dmwy])/g),
					part, dir;
				date = new Date();
				for (var i = 0; i < parts.length; i++) {
					part = part_re.exec(parts[i]);
					dir = parseInt(part[1]);
					switch (part[2]) {
						case 'd':
							date.setUTCDate(date.getUTCDate() + dir);
							break;
						case 'm':
							date = Datetimepicker.prototype.moveMonth.call(Datetimepicker.prototype, date, dir);
							break;
						case 'w':
							date.setUTCDate(date.getUTCDate() + dir * 7);
							break;
						case 'y':
							date = Datetimepicker.prototype.moveYear.call(Datetimepicker.prototype, date, dir);
							break;
					}
				}
				return UTCDate(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), 0);
			}
			var parts = date && date.toString().match(this.nonpunctuation) || [],
				date = new Date(0, 0, 0, 0, 0, 0, 0),
				parsed = {},
				setters_order = ['hh', 'h', 'ii', 'i', 'ss', 's', 'yyyy', 'yy', 'M', 'MM', 'm', 'mm', 'D', 'DD', 'd', 'dd', 'H', 'HH', 'p', 'P'],
				setters_map = {
					hh:   function (d, v) {
						return d.setUTCHours(v);
					},
					h:    function (d, v) {
						return d.setUTCHours(v);
					},
					HH:   function (d, v) {
						return d.setUTCHours(v == 12 ? 0 : v);
					},
					H:    function (d, v) {
						return d.setUTCHours(v == 12 ? 0 : v);
					},
					ii:   function (d, v) {
						return d.setUTCMinutes(v);
					},
					i:    function (d, v) {
						return d.setUTCMinutes(v);
					},
					ss:   function (d, v) {
						return d.setUTCSeconds(v);
					},
					s:    function (d, v) {
						return d.setUTCSeconds(v);
					},
					yyyy: function (d, v) {
						return d.setUTCFullYear(v);
					},
					yy:   function (d, v) {
						return d.setUTCFullYear(2000 + v);
					},
					m:    function (d, v) {
						v -= 1;
						while (v < 0) v += 12;
						v %= 12;
						d.setUTCMonth(v);
						while (d.getUTCMonth() != v)
							if (isNaN(d.getUTCMonth()))
								return d;
							else
								d.setUTCDate(d.getUTCDate() - 1);
						return d;
					},
					d:    function (d, v) {
						return d.setUTCDate(v);
					},
					p:    function (d, v) {
						return d.setUTCHours(v == 1 ? d.getUTCHours() + 12 : d.getUTCHours());
					}
				},
				val, filtered, part;
			setters_map['M'] = setters_map['MM'] = setters_map['mm'] = setters_map['m'];
			setters_map['dd'] = setters_map['d'];
			setters_map['P'] = setters_map['p'];
			date = UTCDate(date.getFullYear(), date.getMonth(), date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds());
			if (parts.length == format.parts.length) {
				for (var i = 0, cnt = format.parts.length; i < cnt; i++) {
					val = parseInt(parts[i], 10);
					part = format.parts[i];
					if (isNaN(val)) {
						switch (part) {
							case 'MM':
								filtered = $(dates[language].months).filter(function () {
									var m = this.slice(0, parts[i].length),
										p = parts[i].slice(0, m.length);
									return m == p;
								});
								val = $.inArray(filtered[0], dates[language].months) + 1;
								break;
							case 'M':
								filtered = $(dates[language].monthsShort).filter(function () {
									var m = this.slice(0, parts[i].length),
										p = parts[i].slice(0, m.length);
									return m.toLowerCase() == p.toLowerCase();
								});
								val = $.inArray(filtered[0], dates[language].monthsShort) + 1;
								break;
							case 'p':
							case 'P':
								val = $.inArray(parts[i].toLowerCase(), dates[language].meridiem);
								break;
						}
					}
					parsed[part] = val;
				}
				for (var i = 0, s; i < setters_order.length; i++) {
					s = setters_order[i];
					if (s in parsed && !isNaN(parsed[s]))
						setters_map[s](date, parsed[s])
				}
			}
			return date;
		},
		formatDate:       function (date, format, language, type) {
			if (date == null) {
				return '';
			}
			var val;
			if (type == 'standard') {
				val = {
					// year
					yy:   date.getUTCFullYear().toString().substring(2),
					yyyy: date.getUTCFullYear(),
					// month
					m:    date.getUTCMonth() + 1,
					M:    dates[language].monthsShort[date.getUTCMonth()],
					MM:   dates[language].months[date.getUTCMonth()],
					// day
					d:    date.getUTCDate(),
					D:    dates[language].daysShort[date.getUTCDay()],
					DD:   dates[language].days[date.getUTCDay()],
					p:    (dates[language].meridiem.length == 2 ? dates[language].meridiem[date.getUTCHours() < 12 ? 0 : 1] : ''),
					// hour
					h:    date.getUTCHours(),
					// minute
					i:    date.getUTCMinutes(),
					// second
					s:    date.getUTCSeconds()
				};

				if (dates[language].meridiem.length == 2) {
					val.H = (val.h % 12 == 0 ? 12 : val.h % 12);
				}
				else {
					val.H = val.h;
				}
				val.HH = (val.H < 10 ? '0' : '') + val.H;
				val.P = val.p.toUpperCase();
				val.hh = (val.h < 10 ? '0' : '') + val.h;
				val.ii = (val.i < 10 ? '0' : '') + val.i;
				val.ss = (val.s < 10 ? '0' : '') + val.s;
				val.dd = (val.d < 10 ? '0' : '') + val.d;
				val.mm = (val.m < 10 ? '0' : '') + val.m;
			} else if (type == 'php') {
				// php format
				val = {
					// year
					y: date.getUTCFullYear().toString().substring(2),
					Y: date.getUTCFullYear(),
					// month
					F: dates[language].months[date.getUTCMonth()],
					M: dates[language].monthsShort[date.getUTCMonth()],
					n: date.getUTCMonth() + 1,
					t: DPGlobal.getDaysInMonth(date.getUTCFullYear(), date.getUTCMonth()),
					// day
					j: date.getUTCDate(),
					l: dates[language].days[date.getUTCDay()],
					D: dates[language].daysShort[date.getUTCDay()],
					w: date.getUTCDay(), // 0 -> 6
					N: (date.getUTCDay() == 0 ? 7 : date.getUTCDay()),       // 1 -> 7
					S: (date.getUTCDate() % 10 <= dates[language].suffix.length ? dates[language].suffix[date.getUTCDate() % 10 - 1] : ''),
					// hour
					a: (dates[language].meridiem.length == 2 ? dates[language].meridiem[date.getUTCHours() < 12 ? 0 : 1] : ''),
					g: (date.getUTCHours() % 12 == 0 ? 12 : date.getUTCHours() % 12),
					G: date.getUTCHours(),
					// minute
					i: date.getUTCMinutes(),
					// second
					s: date.getUTCSeconds()
				};
				val.m = (val.n < 10 ? '0' : '') + val.n;
				val.d = (val.j < 10 ? '0' : '') + val.j;
				val.A = val.a.toString().toUpperCase();
				val.h = (val.g < 10 ? '0' : '') + val.g;
				val.H = (val.G < 10 ? '0' : '') + val.G;
				val.i = (val.i < 10 ? '0' : '') + val.i;
				val.s = (val.s < 10 ? '0' : '') + val.s;
			} else {
				throw new Error("Invalid format type.");
			}
			var date = [],
				seps = $.extend([], format.separators);
			for (var i = 0, cnt = format.parts.length; i < cnt; i++) {
				if (seps.length) {
					date.push(seps.shift());
				}
				date.push(val[format.parts[i]]);
			}
			if (seps.length) {
				date.push(seps.shift());
			}
			return date.join('');
		},
		convertViewMode:  function (viewMode) {
			switch (viewMode) {
				case 4:
				case 'decade':
					viewMode = 4;
					break;
				case 3:
				case 'year':
					viewMode = 3;
					break;
				case 2:
				case 'month':
					viewMode = 2;
					break;
				case 1:
				case 'day':
					viewMode = 1;
					break;
				case 0:
				case 'hour':
					viewMode = 0;
					break;
			}

			return viewMode;
		},
		headTemplate:     '<thead>' +
							  '<tr>' +
							  '<th class="prev"><i class="{leftArrow}"/></th>' +
							  '<th colspan="5" class="switch"></th>' +
							  '<th class="next"><i class="{rightArrow}"/></th>' +
							  '</tr>' +
			'</thead>',
		headTemplateV3:   '<thead>' +
							  '<tr>' +
							  '<th class="prev"><span class="{iconType} {leftArrow}"></span> </th>' +
							  '<th colspan="5" class="switch"></th>' +
							  '<th class="next"><span class="{iconType} {rightArrow}"></span> </th>' +
							  '</tr>' +
			'</thead>',
		contTemplate:     '<tbody><tr><td colspan="7"></td></tr></tbody>',
		footTemplate:     '<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'
	};
	DPGlobal.template = '<div class="datetimepicker">' +
		'<div class="datetimepicker-minutes">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplate +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-hours">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplate +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-days">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplate +
		'<tbody></tbody>' +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-months">' +
		'<table class="table-condensed">' +
		DPGlobal.headTemplate +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-years">' +
		'<table class="table-condensed">' +
		DPGlobal.headTemplate +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'</div>';
	DPGlobal.templateV3 = '<div class="datetimepicker">' +
		'<div class="datetimepicker-minutes">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplateV3 +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-hours">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplateV3 +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-days">' +
		'<table class=" table-condensed">' +
		DPGlobal.headTemplateV3 +
		'<tbody></tbody>' +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-months">' +
		'<table class="table-condensed">' +
		DPGlobal.headTemplateV3 +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'<div class="datetimepicker-years">' +
		'<table class="table-condensed">' +
		DPGlobal.headTemplateV3 +
		DPGlobal.contTemplate +
		DPGlobal.footTemplate +
		'</table>' +
		'</div>' +
		'</div>';
	$.fn.datetimepicker.DPGlobal = DPGlobal;

	/* DATETIMEPICKER NO CONFLICT
	 * =================== */

	$.fn.datetimepicker.noConflict = function () {
		$.fn.datetimepicker = old;
		return this;
	};

	/* DATETIMEPICKER DATA-API
	 * ================== */

	$(document).on(
		'focus.datetimepicker.data-api click.datetimepicker.data-api',
		'[data-provide="datetimepicker"]',
		function (e) {
			var $this = $(this);
			if ($this.data('datetimepicker')) return;
			e.preventDefault();
			// component click requires us to explicitly show it
			$this.datetimepicker('show');
		}
	);
	$(function () {
		$('[data-provide="datetimepicker-inline"]').datetimepicker();
	});

}(window.jQuery);
;
!function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper"], t) : (window.blueimp = window.blueimp || {}, window.blueimp.Gallery = t(window.blueimp.helper || window.jQuery))
}
(function (t) {
	"use strict";
	function e(t, i) {
		return void 0 === document.body.style.maxHeight ? null : this && this.options === e.prototype.options ? t && t.length ? (this.list = t, this.num = t.length, this.initOptions(i), void this.initialize()) : void this.console.log("blueimp Gallery: No or empty list provided as first argument.", t) : new e(t, i)
	}
	return t.extend(e.prototype, {
		options : {
			container : "#blueimp-gallery",
			slidesContainer : "div",
			titleElement : "h3",
			displayClass : "blueimp-gallery-display",
			controlsClass : "blueimp-gallery-controls",
			singleClass : "blueimp-gallery-single",
			leftEdgeClass : "blueimp-gallery-left",
			rightEdgeClass : "blueimp-gallery-right",
			playingClass : "blueimp-gallery-playing",
			slideClass : "slide",
			slideLoadingClass : "slide-loading",
			slideErrorClass : "slide-error",
			slideContentClass : "slide-content",
			toggleClass : "toggle",
			prevClass : "prev",
			nextClass : "next",
			closeClass : "close",
			playPauseClass : "play-pause",
			typeProperty : "type",
			titleProperty : "title",
			urlProperty : "href",
			srcsetProperty : "urlset",
			displayTransition : !0,
			clearSlides : !0,
			stretchImages : !1,
			toggleControlsOnReturn : !0,
			toggleControlsOnSlideClick : !0,
			toggleSlideshowOnSpace : !0,
			enableKeyboardNavigation : !0,
			closeOnEscape : !0,
			closeOnSlideClick : !0,
			closeOnSwipeUpOrDown : !0,
			emulateTouchEvents : !0,
			stopTouchEventsPropagation : !1,
			hidePageScrollbars : !0,
			disableScroll : !0,
			carousel : !1,
			continuous : !0,
			unloadElements : !0,
			startSlideshow : !1,
			slideshowInterval : 5e3,
			index : 0,
			preloadRange : 2,
			transitionSpeed : 400,
			slideshowTransitionSpeed : void 0,
			event : void 0,
			onopen : void 0,
			onopened : void 0,
			onslide : void 0,
			onslideend : void 0,
			onslidecomplete : void 0,
			onclose : void 0,
			onclosed : void 0
		},
		carouselOptions : {
			hidePageScrollbars : !1,
			toggleControlsOnReturn : !1,
			toggleSlideshowOnSpace : !1,
			enableKeyboardNavigation : !1,
			closeOnEscape : !1,
			closeOnSlideClick : !1,
			closeOnSwipeUpOrDown : !1,
			disableScroll : !1,
			startSlideshow : !0
		},
		console : window.console && "function" == typeof window.console.log ? window.console : {
			log : function () {}

		},
		support : function (e) {
			function i() {
				var t,
				i,
				s = o.transition;
				document.body.appendChild(e),
				s && (t = s.name.slice(0, -9) + "ransform", void 0 !== e.style[t] && (e.style[t] = "translateZ(0)", i = window.getComputedStyle(e).getPropertyValue(s.prefix + "transform"), o.transform = {
							prefix : s.prefix,
							name : t,
							translate : !0,
							translateZ : !!i && "none" !== i
						})),
				void 0 !== e.style.backgroundSize && (o.backgroundSize = {}, e.style.backgroundSize = "contain", o.backgroundSize.contain = "contain" === window.getComputedStyle(e).getPropertyValue("background-size"), e.style.backgroundSize = "cover", o.backgroundSize.cover = "cover" === window.getComputedStyle(e).getPropertyValue("background-size")),
				document.body.removeChild(e)
			}
			var s,
			o = {
				touch : void 0 !== window.ontouchstart || window.DocumentTouch && document instanceof DocumentTouch
			},
			n = {
				webkitTransition : {
					end : "webkitTransitionEnd",
					prefix : "-webkit-"
				},
				MozTransition : {
					end : "transitionend",
					prefix : "-moz-"
				},
				OTransition : {
					end : "otransitionend",
					prefix : "-o-"
				},
				transition : {
					end : "transitionend",
					prefix : ""
				}
			};
			for (s in n)
				if (n.hasOwnProperty(s) && void 0 !== e.style[s]) {
					o.transition = n[s],
					o.transition.name = s;
					break
				}
			return document.body ? i() : t(document).on("DOMContentLoaded", i),
			o
		}
		(document.createElement("div")),
		requestAnimationFrame : window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame,
		initialize : function () {
			return this.initStartIndex(),
			this.initWidget() === !1 ? !1 : (this.initEventListeners(), this.onslide(this.index), this.ontransitionend(), void(this.options.startSlideshow && this.play()))
		},
		slide : function (t, e) {
			window.clearTimeout(this.timeout);
			var i,
			s,
			o,
			n = this.index;
			if (n !== t && 1 !== this.num) {
				if (e || (e = this.options.transitionSpeed), this.support.transform) {
					for (this.options.continuous || (t = this.circle(t)), i = Math.abs(n - t) / (n - t), this.options.continuous && (s = i, i = -this.positions[this.circle(t)] / this.slideWidth, i !== s && (t = -i * this.num + t)), o = Math.abs(n - t) - 1; o; )
						o -= 1, this.move(this.circle((t > n ? t : n) - o - 1), this.slideWidth * i, 0);
					t = this.circle(t),
					this.move(n, this.slideWidth * i, e),
					this.move(t, 0, e),
					this.options.continuous && this.move(this.circle(t - i),  - (this.slideWidth * i), 0)
				} else
					t = this.circle(t), this.animate(n * -this.slideWidth, t * -this.slideWidth, e);
				this.onslide(t)
			}
		},
		getIndex : function () {
			return this.index
		},
		getNumber : function () {
			return this.num
		},
		prev : function () {
			(this.options.continuous || this.index) && this.slide(this.index - 1)
		},
		next : function () {
			(this.options.continuous || this.index < this.num - 1) && this.slide(this.index + 1)
		},
		play : function (t) {
			var e = this;
			window.clearTimeout(this.timeout),
			this.interval = t || this.options.slideshowInterval,
			this.elements[this.index] > 1 && (this.timeout = this.setTimeout(!this.requestAnimationFrame && this.slide || function (t, i) {
						e.animationFrameId = e.requestAnimationFrame.call(window, function () {
								e.slide(t, i)
							})
					}, [this.index + 1, this.options.slideshowTransitionSpeed], this.interval)),
			this.container.addClass(this.options.playingClass)
		},
		pause : function () {
			window.clearTimeout(this.timeout),
			this.interval = null,
			this.container.removeClass(this.options.playingClass)
		},
		add : function (t) {
			var e;
			for (t.concat || (t = Array.prototype.slice.call(t)), this.list.concat || (this.list = Array.prototype.slice.call(this.list)), this.list = this.list.concat(t), this.num = this.list.length, this.num > 2 && null === this.options.continuous && (this.options.continuous = !0, this.container.removeClass(this.options.leftEdgeClass)), this.container.removeClass(this.options.rightEdgeClass).removeClass(this.options.singleClass), e = this.num - t.length; e < this.num; e += 1)
				this.addSlide(e), this.positionSlide(e);
			this.positions.length = this.num,
			this.initSlides(!0)
		},
		resetSlides : function () {
			this.slidesContainer.empty(),
			this.unloadAllSlides(),
			this.slides = []
		},
		handleClose : function () {
			var t = this.options;
			this.destroyEventListeners(),
			this.pause(),
			this.container[0].style.display = "none",
			this.container.removeClass(t.displayClass).removeClass(t.singleClass).removeClass(t.leftEdgeClass).removeClass(t.rightEdgeClass),
			t.hidePageScrollbars && (document.body.style.overflow = this.bodyOverflowStyle),
			this.options.clearSlides && this.resetSlides(),
			this.options.onclosed && this.options.onclosed.call(this)
		},
		close : function () {
			function t(i) {
				i.target === e.container[0] && (e.container.off(e.support.transition.end, t), e.handleClose())
			}
			var e = this;
			this.options.onclose && this.options.onclose.call(this),
			this.support.transition && this.options.displayTransition ? (this.container.on(this.support.transition.end, t), this.container.removeClass(this.options.displayClass)) : this.handleClose()
		},
		circle : function (t) {
			return (this.num + t % this.num) % this.num
		},
		move : function (t, e, i) {
			this.translateX(t, e, i),
			this.positions[t] = e
		},
		translate : function (t, e, i, s) {
			var o = this.slides[t].style,
			n = this.support.transition,
			l = this.support.transform;
			o[n.name + "Duration"] = s + "ms",
			o[l.name] = "translate(" + e + "px, " + i + "px)" + (l.translateZ ? " translateZ(0)" : "")
		},
		translateX : function (t, e, i) {
			this.translate(t, e, 0, i)
		},
		translateY : function (t, e, i) {
			this.translate(t, 0, e, i)
		},
		animate : function (t, e, i) {
			if (!i)
				return void(this.slidesContainer[0].style.left = e + "px");
			var s = this,
			o = (new Date).getTime(),
			n = window.setInterval(function () {
					var l = (new Date).getTime() - o;
					return l > i ? (s.slidesContainer[0].style.left = e + "px", s.ontransitionend(), void window.clearInterval(n)) : void(s.slidesContainer[0].style.left = (e - t) * (Math.floor(l / i * 100) / 100) + t + "px")
				}, 4)
		},
		preventDefault : function (t) {
			t.preventDefault ? t.preventDefault() : t.returnValue = !1
		},
		stopPropagation : function (t) {
			t.stopPropagation ? t.stopPropagation() : t.cancelBubble = !0
		},
		onresize : function () {
			this.initSlides(!0)
		},
		onmousedown : function (t) {
			t.which && 1 === t.which && "VIDEO" !== t.target.nodeName && (t.preventDefault(), (t.originalEvent || t).touches = [{
						pageX : t.pageX,
						pageY : t.pageY
					}
				], this.ontouchstart(t))
		},
		onmousemove : function (t) {
			this.touchStart && ((t.originalEvent || t).touches = [{
						pageX : t.pageX,
						pageY : t.pageY
					}
				], this.ontouchmove(t))
		},
		onmouseup : function (t) {
			this.touchStart && (this.ontouchend(t), delete this.touchStart)
		},
		onmouseout : function (e) {
			if (this.touchStart) {
				var i = e.target,
				s = e.relatedTarget;
				(!s || s !== i && !t.contains(i, s)) && this.onmouseup(e)
			}
		},
		ontouchstart : function (t) {
			this.options.stopTouchEventsPropagation && this.stopPropagation(t);
			var e = (t.originalEvent || t).touches[0];
			this.touchStart = {
				x : e.pageX,
				y : e.pageY,
				time : Date.now()
			},
			this.isScrolling = void 0,
			this.touchDelta = {}

		},
		ontouchmove : function (t) {
			this.options.stopTouchEventsPropagation && this.stopPropagation(t);
			var e,
			i,
			s = (t.originalEvent || t).touches[0],
			o = (t.originalEvent || t).scale,
			n = this.index;
			if (!(s.length > 1 || o && 1 !== o))
				if (this.options.disableScroll && t.preventDefault(), this.touchDelta = {
						x : s.pageX - this.touchStart.x,
						y : s.pageY - this.touchStart.y
					}, e = this.touchDelta.x, void 0 === this.isScrolling && (this.isScrolling = this.isScrolling || Math.abs(e) < Math.abs(this.touchDelta.y)), this.isScrolling)
					this.options.closeOnSwipeUpOrDown && this.translateY(n, this.touchDelta.y + this.positions[n], 0);
				else
					for (t.preventDefault(), window.clearTimeout(this.timeout), this.options.continuous ? i = [this.circle(n + 1), n, this.circle(n - 1)] : (this.touchDelta.x = e /= !n && e > 0 || n === this.num - 1 && 0 > e ? Math.abs(e) / this.slideWidth + 1 : 1, i = [n], n && i.push(n - 1), n < this.num - 1 && i.unshift(n + 1)); i.length; )
						n = i.pop(), this.translateX(n, e + this.positions[n], 0)
		},
		ontouchend : function (t) {
			this.options.stopTouchEventsPropagation && this.stopPropagation(t);
			var e,
			i,
			s,
			o,
			n,
			l = this.index,
			a = this.options.transitionSpeed,
			r = this.slideWidth,
			h = Number(Date.now() - this.touchStart.time) < 250,
			d = h && Math.abs(this.touchDelta.x) > 20 || Math.abs(this.touchDelta.x) > r / 2,
			c = !l && this.touchDelta.x > 0 || l === this.num - 1 && this.touchDelta.x < 0,
			u = !d && this.options.closeOnSwipeUpOrDown && (h && Math.abs(this.touchDelta.y) > 20 || Math.abs(this.touchDelta.y) > this.slideHeight / 2);
			this.options.continuous && (c = !1),
			e = this.touchDelta.x < 0 ? -1 : 1,
			this.isScrolling ? u ? this.close() : this.translateY(l, 0, a) : d && !c ? (i = l + e, s = l - e, o = r * e, n = -r * e, this.options.continuous ? (this.move(this.circle(i), o, 0), this.move(this.circle(l - 2 * e), n, 0)) : i >= 0 && i < this.num && this.move(i, o, 0), this.move(l, this.positions[l] + o, a), this.move(this.circle(s), this.positions[this.circle(s)] + o, a), l = this.circle(s), this.onslide(l)) : this.options.continuous ? (this.move(this.circle(l - 1), -r, a), this.move(l, 0, a), this.move(this.circle(l + 1), r, a)) : (l && this.move(l - 1, -r, a), this.move(l, 0, a), l < this.num - 1 && this.move(l + 1, r, a))
		},
		ontouchcancel : function (t) {
			this.touchStart && (this.ontouchend(t), delete this.touchStart)
		},
		ontransitionend : function (t) {
			var e = this.slides[this.index];
			t && e !== t.target || (this.interval && this.play(), this.setTimeout(this.options.onslideend, [this.index, e]))
		},
		oncomplete : function (e) {
			var i,
			s = e.target || e.srcElement,
			o = s && s.parentNode;
			s && o && (i = this.getNodeIndex(o), t(o).removeClass(this.options.slideLoadingClass), "error" === e.type ? (t(o).addClass(this.options.slideErrorClass), this.elements[i] = 3) : this.elements[i] = 2, s.clientHeight > this.container[0].clientHeight && (s.style.maxHeight = this.container[0].clientHeight), this.interval && this.slides[this.index] === o && this.play(), this.setTimeout(this.options.onslidecomplete, [i, o]))
		},
		onload : function (t) {
			this.oncomplete(t)
		},
		onerror : function (t) {
			this.oncomplete(t)
		},
		onkeydown : function (t) {
			switch (t.which || t.keyCode) {
			case 13:
				this.options.toggleControlsOnReturn && (this.preventDefault(t), this.toggleControls());
				break;
			case 27:
				this.options.closeOnEscape && (this.close(), t.stopImmediatePropagation());
				break;
			case 32:
				this.options.toggleSlideshowOnSpace && (this.preventDefault(t), this.toggleSlideshow());
				break;
			case 37:
				this.options.enableKeyboardNavigation && (this.preventDefault(t), this.prev());
				break;
			case 39:
				this.options.enableKeyboardNavigation && (this.preventDefault(t), this.next())
			}
		},
		handleClick : function (e) {
			function i(e) {
				return t(o).hasClass(e) || t(n).hasClass(e)
			}
			var s = this.options,
			o = e.target || e.srcElement,
			n = o.parentNode;
			i(s.toggleClass) ? (this.preventDefault(e), this.toggleControls()) : i(s.prevClass) ? (this.preventDefault(e), this.prev()) : i(s.nextClass) ? (this.preventDefault(e), this.next()) : i(s.closeClass) ? (this.preventDefault(e), this.close()) : i(s.playPauseClass) ? (this.preventDefault(e), this.toggleSlideshow()) : n === this.slidesContainer[0] ? s.closeOnSlideClick ? (this.preventDefault(e), this.close()) : s.toggleControlsOnSlideClick && (this.preventDefault(e), this.toggleControls()) : n.parentNode && n.parentNode === this.slidesContainer[0] && s.toggleControlsOnSlideClick && (this.preventDefault(e), this.toggleControls())
		},
		onclick : function (t) {
			return this.options.emulateTouchEvents && this.touchDelta && (Math.abs(this.touchDelta.x) > 20 || Math.abs(this.touchDelta.y) > 20) ? void delete this.touchDelta : this.handleClick(t)
		},
		updateEdgeClasses : function (t) {
			t ? this.container.removeClass(this.options.leftEdgeClass) : this.container.addClass(this.options.leftEdgeClass),
			t === this.num - 1 ? this.container.addClass(this.options.rightEdgeClass) : this.container.removeClass(this.options.rightEdgeClass)
		},
		handleSlide : function (t) {
			this.options.continuous || this.updateEdgeClasses(t),
			this.loadElements(t),
			this.options.unloadElements && this.unloadElements(t),
			this.setTitle(t)
		},
		onslide : function (t) {
			this.index = t,
			this.handleSlide(t),
			this.setTimeout(this.options.onslide, [t, this.slides[t]])
		},
		setTitle : function (t) {
			var e = this.slides[t].firstChild.title,
			i = this.titleElement;
			i.length && (this.titleElement.empty(), e && i[0].appendChild(document.createTextNode(e)))
		},
		setTimeout : function (t, e, i) {
			var s = this;
			return t && window.setTimeout(function () {
				t.apply(s, e || [])
			}, i || 0)
		},
		imageFactory : function (e, i) {
			function s(e) {
				if (!o) {
					if (e = {
							type : e.type,
							target : n
						}, !n.parentNode)
						return a.setTimeout(s, [e]);
					o = !0,
					t(r).off("load error", s),
					d && "load" === e.type && (n.style.background = 'url("' + h + '") center no-repeat', n.style.backgroundSize = d),
					i(e)
				}
			}
			var o,
			n,
			l,
			a = this,
			r = this.imagePrototype.cloneNode(!1),
			h = e,
			d = this.options.stretchImages;
			return "string" != typeof h && (h = this.getItemProperty(e, this.options.urlProperty), l = this.getItemProperty(e, this.options.titleProperty)),
			d === !0 && (d = "contain"),
			d = this.support.backgroundSize && this.support.backgroundSize[d] && d,
			d ? n = this.elementPrototype.cloneNode(!1) : (n = r, r.draggable = !1),
			l && (n.title = l),
			t(r).on("load error", s),
			r.src = h,
			n
		},
		createElement : function (e, i) {
			var s = e && this.getItemProperty(e, this.options.typeProperty),
			o = s && this[s.split("/")[0] + "Factory"] || this.imageFactory,
			n = e && o.call(this, e, i),
			l = this.getItemProperty(e, this.options.srcsetProperty);
			return n || (n = this.elementPrototype.cloneNode(!1), this.setTimeout(i, [{
							type : "error",
							target : n
						}
					])),
			l && n.setAttribute("srcset", l),
			t(n).addClass(this.options.slideContentClass),
			n
		},
		loadElement : function (e) {
			this.elements[e] || (this.slides[e].firstChild ? this.elements[e] = t(this.slides[e]).hasClass(this.options.slideErrorClass) ? 3 : 2 : (this.elements[e] = 1, t(this.slides[e]).addClass(this.options.slideLoadingClass), this.slides[e].appendChild(this.createElement(this.list[e], this.proxyListener))))
		},
		loadElements : function (t) {
			var e,
			i = Math.min(this.num, 2 * this.options.preloadRange + 1),
			s = t;
			for (e = 0; i > e; e += 1)
				s += e * (e % 2 === 0 ? -1 : 1), s = this.circle(s), this.loadElement(s)
		},
		unloadElements : function (t) {
			var e,
			i;
			for (e in this.elements)
				this.elements.hasOwnProperty(e) && (i = Math.abs(t - e), i > this.options.preloadRange && i + this.options.preloadRange < this.num && (this.unloadSlide(e), delete this.elements[e]))
		},
		addSlide : function (t) {
			var e = this.slidePrototype.cloneNode(!1);
			e.setAttribute("data-index", t),
			this.slidesContainer[0].appendChild(e),
			this.slides.push(e)
		},
		positionSlide : function (t) {
			var e = this.slides[t];
			e.style.width = this.slideWidth + "px",
			this.support.transform && (e.style.left = t * -this.slideWidth + "px", this.move(t, this.index > t ? -this.slideWidth : this.index < t ? this.slideWidth : 0, 0))
		},
		initSlides : function (e) {
			var i,
			s;
			for (e || (this.positions = [], this.positions.length = this.num, this.elements = {}, this.imagePrototype = document.createElement("img"), this.elementPrototype = document.createElement("div"), this.slidePrototype = document.createElement("div"), t(this.slidePrototype).addClass(this.options.slideClass), this.slides = this.slidesContainer[0].children, i = this.options.clearSlides || this.slides.length !== this.num), this.slideWidth = this.container[0].offsetWidth, this.slideHeight = this.container[0].offsetHeight, this.slidesContainer[0].style.width = this.num * this.slideWidth + "px", i && this.resetSlides(), s = 0; s < this.num; s += 1)
				i && this.addSlide(s), this.positionSlide(s);
			this.options.continuous && this.support.transform && (this.move(this.circle(this.index - 1), -this.slideWidth, 0), this.move(this.circle(this.index + 1), this.slideWidth, 0)),
			this.support.transform || (this.slidesContainer[0].style.left = this.index * -this.slideWidth + "px")
		},
		unloadSlide : function (t) {
			var e,
			i;
			e = this.slides[t],
			i = e.firstChild,
			null !== i && e.removeChild(i)
		},
		unloadAllSlides : function () {
			var t,
			e;
			for (t = 0, e = this.slides.length; e > t; t++)
				this.unloadSlide(t)
		},
		toggleControls : function () {
			var t = this.options.controlsClass;
			this.container.hasClass(t) ? this.container.removeClass(t) : this.container.addClass(t)
		},
		toggleSlideshow : function () {
			this.interval ? this.pause() : this.play()
		},
		getNodeIndex : function (t) {
			return parseInt(t.getAttribute("data-index"), 10)
		},
		getNestedProperty : function (t, e) {
			return e.replace(/\[(?:'([^']+)'|"([^"]+)"|(\d+))\]|(?:(?:^|\.)([^\.\[]+))/g, function (e, i, s, o, n) {
				var l = n || i || s || o && parseInt(o, 10);
				e && t && (t = t[l])
			}),
			t
		},
		getDataProperty : function (e, i) {
			if (e.getAttribute) {
				var s = e.getAttribute("data-" + i.replace(/([A-Z])/g, "-$1").toLowerCase());
				if ("string" == typeof s) {
					if (/^(true|false|null|-?\d+(\.\d+)?|\{[\s\S]*\}|\[[\s\S]*\])$/.test(s))
						try {
							return t.parseJSON(s)
						} catch (o) {}

					return s
				}
			}
		},
		getItemProperty : function (t, e) {
			var i = t[e];
			return void 0 === i && (i = this.getDataProperty(t, e), void 0 === i && (i = this.getNestedProperty(t, e))),
			i
		},
		initStartIndex : function () {
			var t,
			e = this.options.index,
			i = this.options.urlProperty;
			if (e && "number" != typeof e)
				for (t = 0; t < this.num; t += 1)
					if (this.list[t] === e || this.getItemProperty(this.list[t], i) === this.getItemProperty(e, i)) {
						e = t;
						break
					}
			this.index = this.circle(parseInt(e, 10) || 0)
		},
		initEventListeners : function () {
			function e(t) {
				var e = i.support.transition && i.support.transition.end === t.type ? "transitionend" : t.type;
				i["on" + e](t)
			}
			var i = this,
			s = this.slidesContainer;
			t(window).on("resize", e),
			t(document.body).on("keydown", e),
			this.container.on("click", e),
			this.support.touch ? s.on("touchstart touchmove touchend touchcancel", e) : this.options.emulateTouchEvents && this.support.transition && s.on("mousedown mousemove mouseup mouseout", e),
			this.support.transition && s.on(this.support.transition.end, e),
			this.proxyListener = e
		},
		destroyEventListeners : function () {
			var e = this.slidesContainer,
			i = this.proxyListener;
			t(window).off("resize", i),
			t(document.body).off("keydown", i),
			this.container.off("click", i),
			this.support.touch ? e.off("touchstart touchmove touchend touchcancel", i) : this.options.emulateTouchEvents && this.support.transition && e.off("mousedown mousemove mouseup mouseout", i),
			this.support.transition && e.off(this.support.transition.end, i)
		},
		handleOpen : function () {
			this.options.onopened && this.options.onopened.call(this)
		},
		initWidget : function () {
			function e(t) {
				t.target === i.container[0] && (i.container.off(i.support.transition.end, e), i.handleOpen())
			}
			var i = this;
			return this.container = t(this.options.container),
			this.container.length ? (this.slidesContainer = this.container.find(this.options.slidesContainer).first(), this.slidesContainer.length ? (this.titleElement = this.container.find(this.options.titleElement).first(), 1 === this.num && this.container.addClass(this.options.singleClass), this.options.onopen && this.options.onopen.call(this), this.support.transition && this.options.displayTransition ? this.container.on(this.support.transition.end, e) : this.handleOpen(), this.options.hidePageScrollbars && (this.bodyOverflowStyle = document.body.style.overflow, document.body.style.overflow = "hidden"), this.container[0].style.display = "block", this.initSlides(), void this.container.addClass(this.options.displayClass)) : (this.console.log("blueimp Gallery: Slides container not found.", this.options.slidesContainer), !1)) : (this.console.log("blueimp Gallery: Widget container not found.", this.options.container), !1)
		},
		initOptions : function (e) {
			this.options = t.extend({}, this.options),
			(e && e.carousel || this.options.carousel && (!e || e.carousel !== !1)) && t.extend(this.options, this.carouselOptions),
			t.extend(this.options, e),
			this.num < 3 && (this.options.continuous = this.options.continuous ? null : !1),
			this.support.transition || (this.options.emulateTouchEvents = !1),
			this.options.event && this.preventDefault(this.options.event)
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper", "./blueimp-gallery"], t) : t(window.blueimp.helper || window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	t.extend(e.prototype.options, {
		fullScreen : !1
	});
	var i = e.prototype.initialize,
	s = e.prototype.close;
	return t.extend(e.prototype, {
		getFullScreenElement : function () {
			return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement
		},
		requestFullScreen : function (t) {
			t.requestFullscreen ? t.requestFullscreen() : t.webkitRequestFullscreen ? t.webkitRequestFullscreen() : t.mozRequestFullScreen ? t.mozRequestFullScreen() : t.msRequestFullscreen && t.msRequestFullscreen()
		},
		exitFullScreen : function () {
			document.exitFullscreen ? document.exitFullscreen() : document.webkitCancelFullScreen ? document.webkitCancelFullScreen() : document.mozCancelFullScreen ? document.mozCancelFullScreen() : document.msExitFullscreen && document.msExitFullscreen()
		},
		initialize : function () {
			i.call(this),
			this.options.fullScreen && !this.getFullScreenElement() && this.requestFullScreen(this.container[0])
		},
		close : function () {
			this.getFullScreenElement() === this.container[0] && this.exitFullScreen(),
			s.call(this)
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper", "./blueimp-gallery"], t) : t(window.blueimp.helper || window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	t.extend(e.prototype.options, {
		indicatorContainer : "ol",
		activeIndicatorClass : "active",
		thumbnailProperty : "thumbnail",
		thumbnailIndicators : !0
	});
	var i = e.prototype.initSlides,
	s = e.prototype.addSlide,
	o = e.prototype.resetSlides,
	n = e.prototype.handleClick,
	l = e.prototype.handleSlide,
	a = e.prototype.handleClose;
	return t.extend(e.prototype, {
		createIndicator : function (e) {
			var i,
			s,
			o = this.indicatorPrototype.cloneNode(!1),
			n = this.getItemProperty(e, this.options.titleProperty),
			l = this.options.thumbnailProperty;
			return this.options.thumbnailIndicators && (l && (i = this.getItemProperty(e, l)), void 0 === i && (s = e.getElementsByTagName && t(e).find("img")[0], s && (i = s.src)), i && (o.style.backgroundImage = 'url("' + i + '")')),
			n && (o.title = n),
			o
		},
		addIndicator : function (t) {
			if (this.indicatorContainer.length) {
				var e = this.createIndicator(this.list[t]);
				e.setAttribute("data-index", t),
				this.indicatorContainer[0].appendChild(e),
				this.indicators.push(e)
			}
		},
		setActiveIndicator : function (e) {
			this.indicators && (this.activeIndicator && this.activeIndicator.removeClass(this.options.activeIndicatorClass), this.activeIndicator = t(this.indicators[e]), this.activeIndicator.addClass(this.options.activeIndicatorClass))
		},
		initSlides : function (t) {
			t || (this.indicatorContainer = this.container.find(this.options.indicatorContainer), this.indicatorContainer.length && (this.indicatorPrototype = document.createElement("li"), this.indicators = this.indicatorContainer[0].children)),
			i.call(this, t)
		},
		addSlide : function (t) {
			s.call(this, t),
			this.addIndicator(t)
		},
		resetSlides : function () {
			o.call(this),
			this.indicatorContainer.empty(),
			this.indicators = []
		},
		handleClick : function (t) {
			var e = t.target || t.srcElement,
			i = e.parentNode;
			if (i === this.indicatorContainer[0])
				this.preventDefault(t), this.slide(this.getNodeIndex(e));
			else {
				if (i.parentNode !== this.indicatorContainer[0])
					return n.call(this, t);
				this.preventDefault(t),
				this.slide(this.getNodeIndex(i))
			}
		},
		handleSlide : function (t) {
			l.call(this, t),
			this.setActiveIndicator(t)
		},
		handleClose : function () {
			this.activeIndicator && this.activeIndicator.removeClass(this.options.activeIndicatorClass),
			a.call(this)
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper", "./blueimp-gallery"], t) : t(window.blueimp.helper || window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	t.extend(e.prototype.options, {
		videoContentClass : "video-content",
		videoLoadingClass : "video-loading",
		videoPlayingClass : "video-playing",
		videoPosterProperty : "poster",
		videoSourcesProperty : "sources"
	});
	var i = e.prototype.handleSlide;
	return t.extend(e.prototype, {
		handleSlide : function (t) {
			i.call(this, t),
			this.playingVideo && this.playingVideo.pause()
		},
		videoFactory : function (e, i, s) {
			var o,
			n,
			l,
			a,
			r,
			h = this,
			d = this.options,
			c = this.elementPrototype.cloneNode(!1),
			u = t(c),
			p = [{
					type : "error",
					target : c
				}
			],
			y = s || document.createElement("video"),
			m = this.getItemProperty(e, d.urlProperty),
			f = this.getItemProperty(e, d.typeProperty),
			g = this.getItemProperty(e, d.titleProperty),
			v = this.getItemProperty(e, d.videoPosterProperty),
			C = this.getItemProperty(e, d.videoSourcesProperty);
			if (u.addClass(d.videoContentClass), g && (c.title = g), y.canPlayType)
				if (m && f && y.canPlayType(f))
					y.src = m;
				else
					for (; C && C.length; )
						if (n = C.shift(), m = this.getItemProperty(n, d.urlProperty), f = this.getItemProperty(n, d.typeProperty), m && f && y.canPlayType(f)) {
							y.src = m;
							break
						}
			return v && (y.poster = v, o = this.imagePrototype.cloneNode(!1), t(o).addClass(d.toggleClass), o.src = v, o.draggable = !1, c.appendChild(o)),
			l = document.createElement("a"),
			l.setAttribute("target", "_blank"),
			s || l.setAttribute("download", g),
			l.href = m,
			y.src && (y.controls = !0, (s || t(y)).on("error", function () {
					h.setTimeout(i, p)
				}).on("pause", function () {
					a = !1,
					u.removeClass(h.options.videoLoadingClass).removeClass(h.options.videoPlayingClass),
					r && h.container.addClass(h.options.controlsClass),
					delete h.playingVideo,
					h.interval && h.play()
				}).on("playing", function () {
					a = !1,
					u.removeClass(h.options.videoLoadingClass).addClass(h.options.videoPlayingClass),
					h.container.hasClass(h.options.controlsClass) ? (r = !0, h.container.removeClass(h.options.controlsClass)) : r = !1
				}).on("play", function () {
					window.clearTimeout(h.timeout),
					a = !0,
					u.addClass(h.options.videoLoadingClass),
					h.playingVideo = y
				}), t(l).on("click", function (t) {
					h.preventDefault(t),
					a ? y.pause() : y.play()
				}), c.appendChild(s && s.element || y)),
			c.appendChild(l),
			this.setTimeout(i, [{
						type : "load",
						target : c
					}
				]),
			c
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper", "./blueimp-gallery-video"], t) : t(window.blueimp.helper || window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	if (!window.postMessage)
		return e;
	t.extend(e.prototype.options, {
		vimeoVideoIdProperty : "vimeo",
		vimeoPlayerUrl : "//player.vimeo.com/video/VIDEO_ID?api=1&player_id=PLAYER_ID",
		vimeoPlayerIdPrefix : "vimeo-player-",
		vimeoClickToPlay : !0
	});
	var i = e.prototype.textFactory || e.prototype.imageFactory,
	s = function (t, e, i, s) {
		this.url = t,
		this.videoId = e,
		this.playerId = i,
		this.clickToPlay = s,
		this.element = document.createElement("div"),
		this.listeners = {}

	},
	o = 0;
	return t.extend(s.prototype, {
		canPlayType : function () {
			return !0
		},
		on : function (t, e) {
			return this.listeners[t] = e,
			this
		},
		loadAPI : function () {
			function e() {
				!s && o.playOnReady && o.play(),
				s = !0
			}
			for (var i, s, o = this, n = "//f.vimeocdn.com/js/froogaloop2.min.js", l = document.getElementsByTagName("script"), a = l.length; a; )
				if (a -= 1, l[a].src === n) {
					i = l[a];
					break
				}
			i || (i = document.createElement("script"), i.src = n),
			t(i).on("load", e),
			l[0].parentNode.insertBefore(i, l[0]),
			/loaded|complete/.test(i.readyState) && e()
		},
		onReady : function () {
			var t = this;
			this.ready = !0,
			this.player.addEvent("play", function () {
				t.hasPlayed = !0,
				t.onPlaying()
			}),
			this.player.addEvent("pause", function () {
				t.onPause()
			}),
			this.player.addEvent("finish", function () {
				t.onPause()
			}),
			this.playOnReady && this.play()
		},
		onPlaying : function () {
			this.playStatus < 2 && (this.listeners.playing(), this.playStatus = 2)
		},
		onPause : function () {
			this.listeners.pause(),
			delete this.playStatus
		},
		insertIframe : function () {
			var t = document.createElement("iframe");
			t.src = this.url.replace("VIDEO_ID", this.videoId).replace("PLAYER_ID", this.playerId),
			t.id = this.playerId,
			this.element.parentNode.replaceChild(t, this.element),
			this.element = t
		},
		play : function () {
			var t = this;
			this.playStatus || (this.listeners.play(), this.playStatus = 1),
			this.ready ? !this.hasPlayed && (this.clickToPlay || window.navigator && /iP(hone|od|ad)/.test(window.navigator.platform)) ? this.onPlaying() : this.player.api("play") : (this.playOnReady = !0, window.$f ? this.player || (this.insertIframe(), this.player = $f(this.element), this.player.addEvent("ready", function () {
						t.onReady()
					})) : this.loadAPI())
		},
		pause : function () {
			this.ready ? this.player.api("pause") : this.playStatus && (delete this.playOnReady, this.listeners.pause(), delete this.playStatus)
		}
	}),
	t.extend(e.prototype, {
		VimeoPlayer : s,
		textFactory : function (t, e) {
			var n = this.options,
			l = this.getItemProperty(t, n.vimeoVideoIdProperty);
			return l ? (void 0 === this.getItemProperty(t, n.urlProperty) && (t[n.urlProperty] = "//vimeo.com/" + l), o += 1, this.videoFactory(t, e, new s(n.vimeoPlayerUrl, l, n.vimeoPlayerIdPrefix + o, n.vimeoClickToPlay))) : i.call(this, t, e)
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["./blueimp-helper", "./blueimp-gallery-video"], t) : t(window.blueimp.helper || window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	if (!window.postMessage)
		return e;
	t.extend(e.prototype.options, {
		youTubeVideoIdProperty : "youtube",
		youTubePlayerVars : {
			wmode : "transparent"
		},
		youTubeClickToPlay : !0
	});
	var i = e.prototype.textFactory || e.prototype.imageFactory,
	s = function (t, e, i) {
		this.videoId = t,
		this.playerVars = e,
		this.clickToPlay = i,
		this.element = document.createElement("div"),
		this.listeners = {}

	};
	return t.extend(s.prototype, {
		canPlayType : function () {
			return !0
		},
		on : function (t, e) {
			return this.listeners[t] = e,
			this
		},
		loadAPI : function () {
			var t,
			e = this,
			i = window.onYouTubeIframeAPIReady,
			s = "//www.youtube.com/iframe_api",
			o = document.getElementsByTagName("script"),
			n = o.length;
			for (window.onYouTubeIframeAPIReady = function () {
				i && i.apply(this),
				e.playOnReady && e.play()
			}; n; )
				if (n -= 1, o[n].src === s)
					return;
			t = document.createElement("script"),
			t.src = s,
			o[0].parentNode.insertBefore(t, o[0])
		},
		onReady : function () {
			this.ready = !0,
			this.playOnReady && this.play()
		},
		onPlaying : function () {
			this.playStatus < 2 && (this.listeners.playing(), this.playStatus = 2)
		},
		onPause : function () {
			e.prototype.setTimeout.call(this, this.checkSeek, null, 2e3)
		},
		checkSeek : function () {
			(this.stateChange === YT.PlayerState.PAUSED || this.stateChange === YT.PlayerState.ENDED) && (this.listeners.pause(), delete this.playStatus)
		},
		onStateChange : function (t) {
			switch (t.data) {
			case YT.PlayerState.PLAYING:
				this.hasPlayed = !0,
				this.onPlaying();
				break;
			case YT.PlayerState.PAUSED:
			case YT.PlayerState.ENDED:
				this.onPause()
			}
			this.stateChange = t.data
		},
		onError : function (t) {
			this.listeners.error(t)
		},
		play : function () {
			var t = this;
			this.playStatus || (this.listeners.play(), this.playStatus = 1),
			this.ready ? !this.hasPlayed && (this.clickToPlay || window.navigator && /iP(hone|od|ad)/.test(window.navigator.platform)) ? this.onPlaying() : this.player.playVideo() : (this.playOnReady = !0, window.YT && YT.Player ? this.player || (this.player = new YT.Player(this.element, {
							videoId : this.videoId,
							playerVars : this.playerVars,
							events : {
								onReady : function () {
									t.onReady()
								},
								onStateChange : function (e) {
									t.onStateChange(e)
								},
								onError : function (e) {
									t.onError(e)
								}
							}
						})) : this.loadAPI())
		},
		pause : function () {
			this.ready ? this.player.pauseVideo() : this.playStatus && (delete this.playOnReady, this.listeners.pause(), delete this.playStatus)
		}
	}),
	t.extend(e.prototype, {
		YouTubePlayer : s,
		textFactory : function (t, e) {
			var o = this.options,
			n = this.getItemProperty(t, o.youTubeVideoIdProperty);
			return n ? (void 0 === this.getItemProperty(t, o.urlProperty) && (t[o.urlProperty] = "//www.youtube.com/watch?v=" + n), void 0 === this.getItemProperty(t, o.videoPosterProperty) && (t[o.videoPosterProperty] = "//img.youtube.com/vi/" + n + "/maxresdefault.jpg"), this.videoFactory(t, e, new s(n, o.youTubePlayerVars, o.youTubeClickToPlay))) : i.call(this, t, e)
		}
	}),
	e
}), function (t) {
	"use strict";
	"function" == typeof define && define.amd ? define(["jquery", "./blueimp-gallery"], t) : t(window.jQuery, window.blueimp.Gallery)
}
(function (t, e) {
	"use strict";
	t(document).on("click", "[data-gallery]", function (i) {
		var s = t(this).data("gallery"),
		o = t(s),
		n = o.length && o || t(e.prototype.options.container),
		l = {
			onopen : function () {
				n.data("gallery", this).trigger("open")
			},
			onopened : function () {
				n.trigger("opened")
			},
			onslide : function () {
				n.trigger("slide", arguments)
			},
			onslideend : function () {
				n.trigger("slideend", arguments)
			},
			onslidecomplete : function () {
				n.trigger("slidecomplete", arguments)
			},
			onclose : function () {
				n.trigger("close")
			},
			onclosed : function () {
				n.trigger("closed").removeData("gallery")
			}
		},
		a = t.extend(n.data(), {
				container : n[0],
				index : this,
				event : i
			}, l),
		r = t('[data-gallery="' + s + '"]');
		return a.filter && (r = r.filter(a.filter)),
		new e(r, a)
	})
});;
/*!
 * imagesLoaded PACKAGED v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */

/**
 * EvEmitter v1.0.1
 * Lil' event emitter
 * MIT License
 */

/* jshint unused: true, undef: true, strict: true */

( function( global, factory ) {
  // universal module definition
  /* jshint strict: false */ /* globals define, module */
  if ( typeof define == 'function' && define.amd ) {
    // AMD - RequireJS
    define( 'ev-emitter/ev-emitter',factory );
  } else if ( typeof module == 'object' && module.exports ) {
    // CommonJS - Browserify, Webpack
    module.exports = factory();
  } else {
    // Browser globals
    global.EvEmitter = factory();
  }

}( this, function() {



function EvEmitter() {}

var proto = EvEmitter.prototype;

proto.on = function( eventName, listener ) {
  if ( !eventName || !listener ) {
    return;
  }
  // set events hash
  var events = this._events = this._events || {};
  // set listeners array
  var listeners = events[ eventName ] = events[ eventName ] || [];
  // only add once
  if ( listeners.indexOf( listener ) == -1 ) {
    listeners.push( listener );
  }

  return this;
};

proto.once = function( eventName, listener ) {
  if ( !eventName || !listener ) {
    return;
  }
  // add event
  this.on( eventName, listener );
  // set once flag
  // set onceEvents hash
  var onceEvents = this._onceEvents = this._onceEvents || {};
  // set onceListeners array
  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || [];
  // set flag
  onceListeners[ listener ] = true;

  return this;
};

proto.off = function( eventName, listener ) {
  var listeners = this._events && this._events[ eventName ];
  if ( !listeners || !listeners.length ) {
    return;
  }
  var index = listeners.indexOf( listener );
  if ( index != -1 ) {
    listeners.splice( index, 1 );
  }

  return this;
};

proto.emitEvent = function( eventName, args ) {
  var listeners = this._events && this._events[ eventName ];
  if ( !listeners || !listeners.length ) {
    return;
  }
  var i = 0;
  var listener = listeners[i];
  args = args || [];
  // once stuff
  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];

  while ( listener ) {
    var isOnce = onceListeners && onceListeners[ listener ];
    if ( isOnce ) {
      // remove listener
      // remove before trigger to prevent recursion
      this.off( eventName, listener );
      // unset once flag
      delete onceListeners[ listener ];
    }
    // trigger listener
    listener.apply( this, args );
    // get next listener
    i += isOnce ? 0 : 1;
    listener = listeners[i];
  }

  return this;
};

return EvEmitter;

}));

/*!
 * imagesLoaded v4.1.0
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */

( function( window, factory ) { 'use strict';
  // universal module definition

  /*global define: false, module: false, require: false */

  if ( typeof define == 'function' && define.amd ) {
    // AMD
    define( [
      'ev-emitter/ev-emitter'
    ], function( EvEmitter ) {
      return factory( window, EvEmitter );
    });
  } else if ( typeof module == 'object' && module.exports ) {
    // CommonJS
    module.exports = factory(
      window,
      require('ev-emitter')
    );
  } else {
    // browser global
    window.imagesLoaded = factory(
      window,
      window.EvEmitter
    );
  }

})( window,

// --------------------------  factory -------------------------- //

function factory( window, EvEmitter ) {



var $ = window.jQuery;
var console = window.console;

// -------------------------- helpers -------------------------- //

// extend objects
function extend( a, b ) {
  for ( var prop in b ) {
    a[ prop ] = b[ prop ];
  }
  return a;
}

// turn element or nodeList into an array
function makeArray( obj ) {
  var ary = [];
  if ( Array.isArray( obj ) ) {
    // use object if already an array
    ary = obj;
  } else if ( typeof obj.length == 'number' ) {
    // convert nodeList to array
    for ( var i=0; i < obj.length; i++ ) {
      ary.push( obj[i] );
    }
  } else {
    // array of single index
    ary.push( obj );
  }
  return ary;
}

// -------------------------- imagesLoaded -------------------------- //

/**
 * @param {Array, Element, NodeList, String} elem
 * @param {Object or Function} options - if function, use as callback
 * @param {Function} onAlways - callback function
 */
function ImagesLoaded( elem, options, onAlways ) {
  // coerce ImagesLoaded() without new, to be new ImagesLoaded()
  if ( !( this instanceof ImagesLoaded ) ) {
    return new ImagesLoaded( elem, options, onAlways );
  }
  // use elem as selector string
  if ( typeof elem == 'string' ) {
    elem = document.querySelectorAll( elem );
  }

  this.elements = makeArray( elem );
  this.options = extend( {}, this.options );

  if ( typeof options == 'function' ) {
    onAlways = options;
  } else {
    extend( this.options, options );
  }

  if ( onAlways ) {
    this.on( 'always', onAlways );
  }

  this.getImages();

  if ( $ ) {
    // add jQuery Deferred object
    this.jqDeferred = new $.Deferred();
  }

  // HACK check async to allow time to bind listeners
  setTimeout( function() {
    this.check();
  }.bind( this ));
}

ImagesLoaded.prototype = Object.create( EvEmitter.prototype );

ImagesLoaded.prototype.options = {};

ImagesLoaded.prototype.getImages = function() {
  this.images = [];

  // filter & find items if we have an item selector
  this.elements.forEach( this.addElementImages, this );
};

/**
 * @param {Node} element
 */
ImagesLoaded.prototype.addElementImages = function( elem ) {
  // filter siblings
  if ( elem.nodeName == 'IMG' ) {
    this.addImage( elem );
  }
  // get background image on element
  if ( this.options.background === true ) {
    this.addElementBackgroundImages( elem );
  }

  // find children
  // no non-element nodes, #143
  var nodeType = elem.nodeType;
  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {
    return;
  }
  var childImgs = elem.querySelectorAll('img');
  // concat childElems to filterFound array
  for ( var i=0; i < childImgs.length; i++ ) {
    var img = childImgs[i];
    this.addImage( img );
  }

  // get child background images
  if ( typeof this.options.background == 'string' ) {
    var children = elem.querySelectorAll( this.options.background );
    for ( i=0; i < children.length; i++ ) {
      var child = children[i];
      this.addElementBackgroundImages( child );
    }
  }
};

var elementNodeTypes = {
  1: true,
  9: true,
  11: true
};

ImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {
  var style = getComputedStyle( elem );
  if ( !style ) {
    // Firefox returns null if in a hidden iframe https://bugzil.la/548397
    return;
  }
  // get url inside url("...")
  var reURL = /url\((['"])?(.*?)\1\)/gi;
  var matches = reURL.exec( style.backgroundImage );
  while ( matches !== null ) {
    var url = matches && matches[2];
    if ( url ) {
      this.addBackground( url, elem );
    }
    matches = reURL.exec( style.backgroundImage );
  }
};

/**
 * @param {Image} img
 */
ImagesLoaded.prototype.addImage = function( img ) {
  var loadingImage = new LoadingImage( img );
  this.images.push( loadingImage );
};

ImagesLoaded.prototype.addBackground = function( url, elem ) {
  var background = new Background( url, elem );
  this.images.push( background );
};

ImagesLoaded.prototype.check = function() {
  var _this = this;
  this.progressedCount = 0;
  this.hasAnyBroken = false;
  // complete if no images
  if ( !this.images.length ) {
    this.complete();
    return;
  }

  function onProgress( image, elem, message ) {
    // HACK - Chrome triggers event before object properties have changed. #83
    setTimeout( function() {
      _this.progress( image, elem, message );
    });
  }

  this.images.forEach( function( loadingImage ) {
    loadingImage.once( 'progress', onProgress );
    loadingImage.check();
  });
};

ImagesLoaded.prototype.progress = function( image, elem, message ) {
  this.progressedCount++;
  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;
  // progress event
  this.emitEvent( 'progress', [ this, image, elem ] );
  if ( this.jqDeferred && this.jqDeferred.notify ) {
    this.jqDeferred.notify( this, image );
  }
  // check if completed
  if ( this.progressedCount == this.images.length ) {
    this.complete();
  }

  if ( this.options.debug && console ) {
    console.log( 'progress: ' + message, image, elem );
  }
};

ImagesLoaded.prototype.complete = function() {
  var eventName = this.hasAnyBroken ? 'fail' : 'done';
  this.isComplete = true;
  this.emitEvent( eventName, [ this ] );
  this.emitEvent( 'always', [ this ] );
  if ( this.jqDeferred ) {
    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';
    this.jqDeferred[ jqMethod ]( this );
  }
};

// --------------------------  -------------------------- //

function LoadingImage( img ) {
  this.img = img;
}

LoadingImage.prototype = Object.create( EvEmitter.prototype );

LoadingImage.prototype.check = function() {
  // If complete is true and browser supports natural sizes,
  // try to check for image status manually.
  var isComplete = this.getIsImageComplete();
  if ( isComplete ) {
    // report based on naturalWidth
    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );
    return;
  }

  // If none of the checks above matched, simulate loading on detached element.
  this.proxyImage = new Image();
  this.proxyImage.addEventListener( 'load', this );
  this.proxyImage.addEventListener( 'error', this );
  // bind to image as well for Firefox. #191
  this.img.addEventListener( 'load', this );
  this.img.addEventListener( 'error', this );
  this.proxyImage.src = this.img.src;
};

LoadingImage.prototype.getIsImageComplete = function() {
  return this.img.complete && this.img.naturalWidth !== undefined;
};

LoadingImage.prototype.confirm = function( isLoaded, message ) {
  this.isLoaded = isLoaded;
  this.emitEvent( 'progress', [ this, this.img, message ] );
};

// ----- events ----- //

// trigger specified handler for event type
LoadingImage.prototype.handleEvent = function( event ) {
  var method = 'on' + event.type;
  if ( this[ method ] ) {
    this[ method ]( event );
  }
};

LoadingImage.prototype.onload = function() {
  this.confirm( true, 'onload' );
  this.unbindEvents();
};

LoadingImage.prototype.onerror = function() {
  this.confirm( false, 'onerror' );
  this.unbindEvents();
};

LoadingImage.prototype.unbindEvents = function() {
  this.proxyImage.removeEventListener( 'load', this );
  this.proxyImage.removeEventListener( 'error', this );
  this.img.removeEventListener( 'load', this );
  this.img.removeEventListener( 'error', this );
};

// -------------------------- Background -------------------------- //

function Background( url, element ) {
  this.url = url;
  this.element = element;
  this.img = new Image();
}

// inherit LoadingImage prototype
Background.prototype = Object.create( LoadingImage.prototype );

Background.prototype.check = function() {
  this.img.addEventListener( 'load', this );
  this.img.addEventListener( 'error', this );
  this.img.src = this.url;
  // check if image is already complete
  var isComplete = this.getIsImageComplete();
  if ( isComplete ) {
    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );
    this.unbindEvents();
  }
};

Background.prototype.unbindEvents = function() {
  this.img.removeEventListener( 'load', this );
  this.img.removeEventListener( 'error', this );
};

Background.prototype.confirm = function( isLoaded, message ) {
  this.isLoaded = isLoaded;
  this.emitEvent( 'progress', [ this, this.element, message ] );
};

// -------------------------- jQuery -------------------------- //

ImagesLoaded.makeJQueryPlugin = function( jQuery ) {
  jQuery = jQuery || window.jQuery;
  if ( !jQuery ) {
    return;
  }
  // set local variable
  $ = jQuery;
  // $().imagesLoaded()
  $.fn.imagesLoaded = function( options, callback ) {
    var instance = new ImagesLoaded( this, options, callback );
    return instance.jqDeferred.promise( $(this) );
  };
};
// try making plugin
ImagesLoaded.makeJQueryPlugin();

// --------------------------  -------------------------- //

return ImagesLoaded;

});

;
// jQuery Mask Plugin v1.6.5
// github.com/igorescobar/jQuery-Mask-Plugin
(function(g){"function"===typeof define&&define.amd?define(["jquery"],g):g(window.jQuery||window.Zepto)})(function(g){var z=function(b,f,d){var l=this,x,y;b=g(b);f="function"===typeof f?f(b.val(),void 0,b,d):f;l.init=function(){d=d||{};l.byPassKeys=[9,16,17,18,36,37,38,39,40,91];l.translation={0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}};l.translation=g.extend({},l.translation,d.translation);l=g.extend(!0,{},l,d);y=
c.getRegexMask();b.each(function(){!1!==d.maxlength&&b.attr("maxlength",f.length);d.placeholder&&b.attr("placeholder",d.placeholder);b.attr("autocomplete","off");c.destroyEvents();c.events();var a=c.getCaret();c.val(c.getMasked());c.setCaret(a+c.getMaskCharactersBeforeCount(a,!0))})};var c={getCaret:function(){var a;a=0;var e=b.get(0),c=document.selection,e=e.selectionStart;if(c&&!~navigator.appVersion.indexOf("MSIE 10"))a=c.createRange(),a.moveStart("character",b.is("input")?-b.val().length:-b.text().length),
a=a.text.length;else if(e||"0"===e)a=e;return a},setCaret:function(a){if(b.is(":focus")){var e;e=b.get(0);e.setSelectionRange?e.setSelectionRange(a,a):e.createTextRange&&(e=e.createTextRange(),e.collapse(!0),e.moveEnd("character",a),e.moveStart("character",a),e.select())}},events:function(){b.on("keydown.mask",function(){x=c.val()});b.on("keyup.mask",c.behaviour);b.on("paste.mask drop.mask",function(){setTimeout(function(){b.keydown().keyup()},100)});b.on("change.mask",function(){b.data("changeCalled",
!0)});b.on("blur.mask",function(a){a=g(a.target);a.prop("defaultValue")!==a.val()&&(a.prop("defaultValue",a.val()),a.data("changeCalled")||a.trigger("change"));a.data("changeCalled",!1)});b.on("focusout.mask",function(){d.clearIfNotMatch&&!y.test(c.val())&&c.val("")})},getRegexMask:function(){var a=[],e,b,c,d,k;for(k in f)(e=l.translation[f[k]])?(b=e.pattern.toString().replace(/.{1}$|^.{1}/g,""),c=e.optional,(e=e.recursive)?(a.push(f[k]),d={digit:f[k],pattern:b}):a.push(c||e?b+"?":b)):a.push("\\"+
f[k]);a=a.join("");d&&(a=a.replace(RegExp("("+d.digit+"(.*"+d.digit+")?)"),"($1)?").replace(RegExp(d.digit,"g"),d.pattern));return RegExp(a)},destroyEvents:function(){b.off("keydown.mask keyup.mask paste.mask drop.mask change.mask blur.mask focusout.mask").removeData("changeCalled")},val:function(a){var e=b.is("input");return 0<arguments.length?e?b.val(a):b.text(a):e?b.val():b.text()},getMaskCharactersBeforeCount:function(a,e){for(var b=0,c=0,d=f.length;c<d&&c<a;c++)l.translation[f.charAt(c)]||(a=
e?a+1:a,b++);return b},determineCaretPos:function(a,b,d,h){return l.translation[f.charAt(Math.min(a-1,f.length-1))]?Math.min(a+d-b-h,d):c.determineCaretPos(a+1,b,d,h)},behaviour:function(a){a=a||window.event;var b=a.keyCode||a.which;if(-1===g.inArray(b,l.byPassKeys)){var d=c.getCaret(),f=c.val(),n=f.length,k=d<n,p=c.getMasked(),m=p.length,q=c.getMaskCharactersBeforeCount(m-1)-c.getMaskCharactersBeforeCount(n-1);p!==f&&c.val(p);!k||65===b&&a.ctrlKey||(8!==b&&46!==b&&(d=c.determineCaretPos(d,n,m,q)),
c.setCaret(d));return c.callbacks(a)}},getMasked:function(a){var b=[],g=c.val(),h=0,n=f.length,k=0,p=g.length,m=1,q="push",s=-1,r,u;d.reverse?(q="unshift",m=-1,r=0,h=n-1,k=p-1,u=function(){return-1<h&&-1<k}):(r=n-1,u=function(){return h<n&&k<p});for(;u();){var v=f.charAt(h),w=g.charAt(k),t=l.translation[v];if(t)w.match(t.pattern)?(b[q](w),t.recursive&&(-1===s?s=h:h===r&&(h=s-m),r===s&&(h-=m)),h+=m):t.optional&&(h+=m,k-=m),k+=m;else{if(!a)b[q](v);w===v&&(k+=m);h+=m}}a=f.charAt(r);n!==p+1||l.translation[a]||
b.push(a);return b.join("")},callbacks:function(a){var e=c.val(),g=c.val()!==x;if(!0===g&&"function"===typeof d.onChange)d.onChange(e,a,b,d);if(!0===g&&"function"===typeof d.onKeyPress)d.onKeyPress(e,a,b,d);if("function"===typeof d.onComplete&&e.length===f.length)d.onComplete(e,a,b,d)}};l.remove=function(){var a=c.getCaret(),b=c.getMaskCharactersBeforeCount(a);c.destroyEvents();c.val(l.getCleanVal()).removeAttr("maxlength");c.setCaret(a-b)};l.getCleanVal=function(){return c.getMasked(!0)};l.init()};
g.fn.mask=function(b,f){this.unmask();return this.each(function(){g(this).data("mask",new z(this,b,f))})};g.fn.unmask=function(){return this.each(function(){try{g(this).data("mask").remove()}catch(b){}})};g.fn.cleanVal=function(){return g(this).data("mask").getCleanVal()};g("*[data-mask]").each(function(){var b=g(this),f={};"true"===b.attr("data-mask-reverse")&&(f.reverse=!0);"false"===b.attr("data-mask-maxlength")&&(f.maxlength=!1);"true"===b.attr("data-mask-clearifnotmatch")&&(f.clearIfNotMatch=
!0);b.mask(b.attr("data-mask"),f)})});
;
!function(e,i){"function"==typeof define&&define.amd?define(i):"object"==typeof exports?module.exports=i(require,exports,module):e.ouibounce=i()}(this,function(){return function(e,i){function n(e,i){return"undefined"==typeof e?i:e}function o(e){var i=24*e*60*60*1e3,n=new Date;return n.setTime(n.getTime()+i),"; expires="+n.toGMTString()}function t(){y.addEventListener("mouseleave",u),y.addEventListener("keydown",r)}function u(e){e.clientY>s||c("viewedOuibounceModal","true")&&!f||(d(),v())}function r(e){b||c("viewedOuibounceModal","true")&&!f||e.metaKey&&76==e.keyCode&&(b=!0,d(),v())}function c(e,i){var n=document.cookie.split("; ").reduce(function(e,i){var n=i.split("=");return e[n[0]]=n[1],e},{});return n[e]===i}function d(){e&&(e.style.display="block"),a()}function a(e){var e=e||{};"undefined"!=typeof e.cookieExpire&&(l=o(e.cookieExpire)),e.sitewide===!0&&(k=";path=/"),"undefined"!=typeof e.cookieDomain&&(p=";domain="+e.cookieDomain),document.cookie="viewedOuibounceModal=true"+l+p+k,y.removeEventListener("mouseleave",u),y.removeEventListener("keydown",r)}var i=i||{},f=i.aggressive||!1,s=n(i.sensitivity,20),m=n(i.timer,1e3),v=i.callback||function(){},l=o(i.cookieExpire)||"",p=i.cookieDomain?";domain="+i.cookieDomain:"",k=i.sitewide===!0?";path=/":"",y=document.getElementsByTagName("html")[0];setTimeout(t,m);var b=!1;return{fire:d,disable:a}}});;
(function(c){function g(b,a){this.element=b;this.options=c.extend({},h,a);c(this.element).data("max-height",this.options.maxHeight);c(this.element).data("height-margin",this.options.heightMargin);delete this.options.maxHeight;if(this.options.embedCSS&&!k){var d=".readmore-js-toggle, .readmore-js-section { "+this.options.sectionCSS+" } .readmore-js-section { overflow: hidden; }",e=document.createElement("style");e.type="text/css";e.styleSheet?e.styleSheet.cssText=d:e.appendChild(document.createTextNode(d));
document.getElementsByTagName("head")[0].appendChild(e);k=!0}this._defaults=h;this._name=f;this.init()}var f="readmore",h={speed:100,maxHeight:200,heightMargin:16,moreLink:'<a href="#">Read More</a>',lessLink:'<a href="#">Close</a>',embedCSS:!0,sectionCSS:"display: block; width: 100%;",startOpen:!1,expandedClass:"readmore-js-expanded",collapsedClass:"readmore-js-collapsed",beforeToggle:function(){},afterToggle:function(){}},k=!1;g.prototype={init:function(){var b=this;c(this.element).each(function(){var a=
c(this),d=a.css("max-height").replace(/[^-\d\.]/g,"")>a.data("max-height")?a.css("max-height").replace(/[^-\d\.]/g,""):a.data("max-height"),e=a.data("height-margin");"none"!=a.css("max-height")&&a.css("max-height","none");b.setBoxHeight(a);if(a.outerHeight(!0)<=d+e)return!0;a.addClass("readmore-js-section "+b.options.collapsedClass).data("collapsedHeight",d);a.after(c(b.options.startOpen?b.options.lessLink:b.options.moreLink).on("click",function(c){b.toggleSlider(this,a,c)}).addClass("readmore-js-toggle"));
b.options.startOpen||a.css({height:d})});c(window).on("resize",function(a){b.resizeBoxes()})},toggleSlider:function(b,a,d){d.preventDefault();var e=this;d=newLink=sectionClass="";var f=!1;d=c(a).data("collapsedHeight");c(a).height()<=d?(d=c(a).data("expandedHeight")+"px",newLink="lessLink",f=!0,sectionClass=e.options.expandedClass):(newLink="moreLink",sectionClass=e.options.collapsedClass);e.options.beforeToggle(b,a,f);c(a).animate({height:d},{duration:e.options.speed,complete:function(){e.options.afterToggle(b,
a,f);c(b).replaceWith(c(e.options[newLink]).on("click",function(b){e.toggleSlider(this,a,b)}).addClass("readmore-js-toggle"));c(this).removeClass(e.options.collapsedClass+" "+e.options.expandedClass).addClass(sectionClass)}})},setBoxHeight:function(b){var a=b.clone().css({height:"auto",width:b.width(),overflow:"hidden"}).insertAfter(b),c=a.outerHeight(!0);a.remove();b.data("expandedHeight",c)},resizeBoxes:function(){var b=this;c(".readmore-js-section").each(function(){var a=c(this);b.setBoxHeight(a);
(a.height()>a.data("expandedHeight")||a.hasClass(b.options.expandedClass)&&a.height()<a.data("expandedHeight"))&&a.css("height",a.data("expandedHeight"))})},destroy:function(){var b=this;c(this.element).each(function(){var a=c(this);a.removeClass("readmore-js-section "+b.options.collapsedClass+" "+b.options.expandedClass).css({"max-height":"",height:"auto"}).next(".readmore-js-toggle").remove();a.removeData()})}};c.fn[f]=function(b){var a=arguments;if(void 0===b||"object"===typeof b)return this.each(function(){if(c.data(this,
"plugin_"+f)){var a=c.data(this,"plugin_"+f);a.destroy.apply(a)}c.data(this,"plugin_"+f,new g(this,b))});if("string"===typeof b&&"_"!==b[0]&&"init"!==b)return this.each(function(){var d=c.data(this,"plugin_"+f);d instanceof g&&"function"===typeof d[b]&&d[b].apply(d,Array.prototype.slice.call(a,1))})}})(jQuery);
;
/*! Lazy Load 1.9.7 - MIT license - Copyright 2010-2015 Mika Tuupola */
!function(a,b,c,d){var e=a(b);a.fn.lazyload=function(f){function g(){var b=0;i.each(function(){var c=a(this);if(!j.skip_invisible||c.is(":visible"))if(a.abovethetop(this,j)||a.leftofbegin(this,j));else if(a.belowthefold(this,j)||a.rightoffold(this,j)){if(++b>j.failure_limit)return!1}else c.trigger("appear"),b=0})}var h,i=this,j={threshold:0,failure_limit:0,event:"scroll",effect:"show",container:b,data_attribute:"original",skip_invisible:!1,appear:null,load:null,placeholder:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"};return f&&(d!==f.failurelimit&&(f.failure_limit=f.failurelimit,delete f.failurelimit),d!==f.effectspeed&&(f.effect_speed=f.effectspeed,delete f.effectspeed),a.extend(j,f)),h=j.container===d||j.container===b?e:a(j.container),0===j.event.indexOf("scroll")&&h.bind(j.event,function(){return g()}),this.each(function(){var b=this,c=a(b);b.loaded=!1,(c.attr("src")===d||c.attr("src")===!1)&&c.is("img")&&c.attr("src",j.placeholder),c.one("appear",function(){if(!this.loaded){if(j.appear){var d=i.length;j.appear.call(b,d,j)}a("<img />").bind("load",function(){var d=c.attr("data-"+j.data_attribute);c.hide(),c.is("img")?c.attr("src",d):c.css("background-image","url('"+d+"')"),c[j.effect](j.effect_speed),b.loaded=!0;var e=a.grep(i,function(a){return!a.loaded});if(i=a(e),j.load){var f=i.length;j.load.call(b,f,j)}}).attr("src",c.attr("data-"+j.data_attribute))}}),0!==j.event.indexOf("scroll")&&c.bind(j.event,function(){b.loaded||c.trigger("appear")})}),e.bind("resize",function(){g()}),/(?:iphone|ipod|ipad).*os 5/gi.test(navigator.appVersion)&&e.bind("pageshow",function(b){b.originalEvent&&b.originalEvent.persisted&&i.each(function(){a(this).trigger("appear")})}),a(c).ready(function(){g()}),this},a.belowthefold=function(c,f){var g;return g=f.container===d||f.container===b?(b.innerHeight?b.innerHeight:e.height())+e.scrollTop():a(f.container).offset().top+a(f.container).height(),g<=a(c).offset().top-f.threshold},a.rightoffold=function(c,f){var g;return g=f.container===d||f.container===b?e.width()+e.scrollLeft():a(f.container).offset().left+a(f.container).width(),g<=a(c).offset().left-f.threshold},a.abovethetop=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollTop():a(f.container).offset().top,g>=a(c).offset().top+f.threshold+a(c).height()},a.leftofbegin=function(c,f){var g;return g=f.container===d||f.container===b?e.scrollLeft():a(f.container).offset().left,g>=a(c).offset().left+f.threshold+a(c).width()},a.inviewport=function(b,c){return!(a.rightoffold(b,c)||a.leftofbegin(b,c)||a.belowthefold(b,c)||a.abovethetop(b,c))},a.extend(a.expr[":"],{"below-the-fold":function(b){return a.belowthefold(b,{threshold:0})},"above-the-top":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-screen":function(b){return a.rightoffold(b,{threshold:0})},"left-of-screen":function(b){return!a.rightoffold(b,{threshold:0})},"in-viewport":function(b){return a.inviewport(b,{threshold:0})},"above-the-fold":function(b){return!a.belowthefold(b,{threshold:0})},"right-of-fold":function(b){return a.rightoffold(b,{threshold:0})},"left-of-fold":function(b){return!a.rightoffold(b,{threshold:0})}})}(jQuery,window,document);;


// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");
	
// Repeat the creation and type-checking code for the next level
if (!com.site.Util) com.site.Util = {}
else if (typeof com.site.Util != "object")
    throw new Error("com.site.Util already exists and is not an object");
	
var allSlides = ["year", "make", "model", "trim", "vin", "titleType", "conditionType", "location", "tires", "keyAndBattery", "drivable", "underTheHood", "taxiUsage", "mileage", "bodyPanel", "bodyDamage", "glassAndLight", "interiorItems", "floodAndFire", "preInstantOffer", "instantOffer", "charityReference", "carLocation", "color", "nameInfo", "payment", "mailing", "payWho", "contact", "whatIsVin", "titleIssued", "owner", "canSign", "liens", "addPhotos", "acceptOffer"];
	
/**
 * jQuery.browser.mobile (http://detectmobilebrowser.com/)
 *
 * jQuery.browser.mobile will be true if the browser is a mobile device
 *
 **/
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);


/* Clearable input text*/

$(function () {
    $(".ui-input input, .ui-input textarea").keyup(function () {
        $(this).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").show();
        $(this).closest('.ui-input').children(".icon-ok-circled.ui-icon-input").hide();
    });
	$(".ui-input input, .ui-input textarea").focus(function () {
        if (!!$(this).parent().find("input").val() && $(this).parent().find("input").val() != "") {            
            $(this).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").show();
			$(this).closest('.ui-input').children(".icon-ok-circled.ui-icon-input").hide();
        }
		if (!!$(this).parent().find("textarea").val() && $(this).parent().find("textarea").val() != "") {            
            $(this).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").show();
			$(this).closest('.ui-input').children(".icon-ok-circled.ui-icon-input").hide();
        }
    });
    $(".ui-input input, .ui-input textarea").blur(function () {
        if (!!$(this).parent().find("input").val() && $(this).parent().find("input").val() == "") {            
            $(this).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
        }
		if (!!$(this).parent().find("textarea").val() && $(this).parent().find("textarea").val() == "") {            
            $(this).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
        }
    });

    $(".ui-icon-input.icon-cancel-circled").click(function () {
        $(this).parent().find("input").val("");
        $(this).parent().find("textarea").val("");
        $(this).hide();
    });
	
});

function addressTracker() {};	//  dummy function to stop unwanted request from address jquery
	
function PageTracking(pageName){
       dataLayer.push({PageName : pageName,event : 'TrackPageView'});
};

function EventTracking(category,action,label){
       dataLayer.push({Category : category,Action : action,Label : label,event : 'TrackEvent'});
};

function QuantcastHomePageTracking(){
       dataLayer.push({"event" : "QuantcastHomePage"});
};

//Adding support of trim in IE8
if(typeof String.prototype.trim !== 'function') {
	String.prototype.trim = function() {
		return this.replace(/^\s+|\s+$/g, ''); 
	};
}

// Number to text converter 
var NUMBER2TEXT = {
    ones: ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'],
    tens: ['', '', 'twenty', 'thirty', 'fourty', 'fifty', 'sixty', 'seventy', 'eighty', 'ninety'],
    sep: ['', ' thousand ', ' million ', ' billion ', ' trillion ', ' quadrillion ', ' quintillion ', ' sextillion ']
};

com.site.Util.getTextFromNumberValue = function(value){
	var arr = [], str = '', index = 0;
	var ones = 	NUMBER2TEXT.ones;	
	var tens = 	NUMBER2TEXT.tens;	
	var sep = 	NUMBER2TEXT.sep;
	
	if ( value.length === 0 ) {
		return;  
	}
	
	value = parseInt( value, 10 );
	if ( isNaN( value ) ) {
		output.textContent = 'Invalid input.';
		return;   
	}
	
	while ( value ) {
		arr.push( value % 1000 );
		value = parseInt( value / 1000, 10 );   
	}
	
	while ( arr.length ) {
		str = (function( a ) {
			var x = Math.floor( a / 100 ),
				y = Math.floor( a / 10 ) % 10,
				z = a % 10;
			
			return ( x > 0 ? ones[x] + ' hundred ' : '' ) +                 
				   ( y >= 2 ? tens[y] + (ones[z]!= '' ? '-' : ' ') + ones[z] : ones[10*y + z] ); 
		})( arr.shift() ) + sep[index++] + str;                     
	}
	
	return str; 
};

com.site.Util.getTextFromNumber = function(value){
	var numberString = com.site.Util.getTextFromNumberValue(value);
	var numberValue = value;

	//if string is not ending with "hundred"
	if(!com.site.Util.checkIfHundredIsLastElement(numberValue)){
		numberString = numberString.replace('hundred ', 'hundred and ');
	}

	//if string is not ending with thousand and there is no "and" in the string
	if(!com.site.Util.checkIfThousandIsLastElement(numberValue) && !com.site.Util.checkForWordInString(' and ',numberString)){
		numberString = numberString.replace('thousand ', 'thousand and ');
	}

	//if string has thousand, not having "thousand and" and not ending with thousand then...
	if(com.site.Util.checkForWordInString('thousand',numberString) && !com.site.Util.checkForWordInString('thousand and',numberString) && !com.site.Util.checkIfThousandIsLastElement(numberValue)){
		numberString = numberString.replace('thousand', 'thousand,');
		numberString = numberString.replace(' and ', ' ');
	}
	
	return numberString;   		
};

com.site.Util.checkIfHundredIsLastElement = function(numberText){
	var numberTextArray = com.site.Util.getTextFromNumberValue(numberText).split(" ");
	var indexOfHundred = $.inArray('hundred', numberTextArray);
	var result = false;
	if((numberTextArray.length -2) == indexOfHundred && numberTextArray[numberTextArray.length-1] == ""){
		result = true;
	}
	return result;
};

com.site.Util.checkIfThousandIsLastElement = function(numberText){
	var numberTextArray = com.site.Util.getTextFromNumberValue(numberText).split(" ");
	var indexOfThousand = $.inArray('thousand', numberTextArray);
	var result = false;
	if((numberTextArray.length -2) == indexOfThousand && numberTextArray[numberTextArray.length-1] == ""){
		result = true;
	}
	return result;
};

com.site.Util.checkForWordInString = function(word,numberStringText){
	var indexOfWord = numberStringText.indexOf(word);
	var result = false;
	if(indexOfWord >= 0){
		result = true;
	}
	return result;
};

com.site.Util.getScrollBarWidth = function() {
   var $outer = $('<div>').css({visibility: 'hidden', width: 100, overflow: 'scroll'}).appendTo('body'),
	widthWithScroll = $('<div>').css({width: '100%'}).appendTo($outer).outerWidth();
	$outer.remove();
	return 100 - widthWithScroll;
};

com.site.Util.isiPhone = function(){
    return (
        (navigator.platform.indexOf("iPhone") != -1) ||
        (navigator.platform.indexOf("iPod") != -1)
    );
};

com.site.Util.showErrorAlert = function(textAlert) {
	if(!!textAlert) {
		$(".errorAlertText").html(textAlert);
	}
	else {
		$(".errorAlertText").html("Select the appropriate statement.");
	}
	$(".slideError").show();
	$(".wrapperScroll").addClass("wrapperScrollForError");	
	$(".wrapperScrollForError").css('bottom',($("#moreInfoFooter").outerHeight()) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
};

com.site.Util.hideErrorAlert = function(keepInfoAlert) {
	$(".slideError").hide();
	if(!!keepInfoAlert == false){
		com.site.Util.hideTireAlert();
		com.site.Util.hideKeyAndBatteryAlert();
	}
	var mobileFooterHeight = $('#footerNavButtonContainer').outerHeight() > 0 ? $('#footerNavButtonContainer').outerHeight() : "58px";
	$(".wrapperScrollForError").css('bottom', (mobileFooterHeight + 16) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
	$(".wrapperScroll").removeClass("wrapperScrollForError");
};

com.site.Util.showTireAlert = function(textAlert) {
	$(".vehicleInfoAlertTires").show();
	$(".wrapperScroll").addClass("wrapperScrollForError");	
	$(".wrapperScrollForError").css('bottom',($("#moreInfoFooter").outerHeight()) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
};

com.site.Util.hideTireAlert = function() {
	$(".vehicleInfoAlertTires").hide();
	var mobileFooterHeight = $('#footerNavButtonContainer').outerHeight() > 0 ? $('#footerNavButtonContainer').outerHeight() : "58px";
	$(".wrapperScrollForError").css('bottom', (mobileFooterHeight + 16) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
	$(".wrapperScroll").removeClass("wrapperScrollForError");
};

com.site.Util.showKeyAndBatteryAlert = function(textAlert) {
	$(".vehicleInfoAlertKeyAndBattery").show();
	$(".wrapperScroll").addClass("wrapperScrollForError");	
	$(".wrapperScrollForError").css('bottom',($("#moreInfoFooter").outerHeight()) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
};

com.site.Util.hideKeyAndBatteryAlert = function() {
	$(".vehicleInfoAlertKeyAndBattery").hide();
	var mobileFooterHeight = $('#footerNavButtonContainer').outerHeight() > 0 ? $('#footerNavButtonContainer').outerHeight() : "58px";
	$(".wrapperScrollForError").css('bottom', (mobileFooterHeight + 16) + "px");
	if(parseInt($(window).width()) > 767)
	{
		$(".wrapperScrollForError").css('bottom',"0px");
	}
	$(".wrapperScroll").removeClass("wrapperScrollForError");
};

com.site.Util.resetInputState = function (id, isGroupField) {
    $("#" + id).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
    $("#" + id).closest('.ui-input').children(".icon-ok-circled.ui-icon-input").hide();
    $("#" + id).removeClass("formControlError inputErrorState");
};

com.site.Util.removeErrorStateToInput = function(id, isGroupField) {
	$("#" + id).removeClass("formControlError inputErrorState");
	if(com.site.Util.isBlank(id)){
		$("#" + id).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();  // Hide close icon when field is blank. 
	}
};

com.site.Util.addErrorStateToInput = function(id, isGroupField){
    //$("#" + id).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
	$("#" + id).addClass("formControlError inputErrorState");
};

com.site.Util.addSuccessStateToInput = function (id, isGroupField) {
    $("#" + id).removeClass("formControlError inputErrorState");
    $("#" + id).closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
    $("#" + id).closest('.ui-input').children(".icon-ok-circled.ui-icon-input").show();
};

com.site.Util.add_commas = function(nStr) {
  nStr += '';
  return nStr.replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
};

com.site.Util.removeLeadingZero = function(nStr){
	nStr += '';
	return nStr.replace(/^0+/, '');
};

// checkCharacter function for check only for number,left and rignt arrow, delete, end, home,back space and enter
com.site.Util.checkCharacter = function(evt) {
	var keyCode = com.site.Util.returnKeyCode(evt);
	var checkV = String.fromCharCode(keyCode);
	if ((keyCode >= 48 && keyCode <= 57) || keyCode == 8 || keyCode == 37 || keyCode == 39 || keyCode == 9 || keyCode == 46 || keyCode == 35 || keyCode == 36 || keyCode == 13 || ((evt.ctrlKey || evt.metaKey) && (checkV == "v" || checkV == "V")))
	{
		if (!evt.shiftKey)
		{
			return true;
		}
		return false;        
	}
	return false;
};

com.site.Util.returnKeyCode = function (evt) {
    return evt ? (evt.which ? evt.which : evt.keyCode) : evt.keyCode;
};

com.site.Util.isBlank = function (divInputId) {
	if ($.trim($("#" + divInputId).val()) == "" || $.trim($("#" + divInputId).val()) == null) {
		return true;
	}
	return false;
};

com.site.Util.isBlankValue = function (val) {
	return $.trim(val)=='' || val==undefined?true:false; 
};

com.site.Util.checkVINCharecter = function (event) {
	var keyCode = com.site.Util.returnKeyCode(event);
	var NUMBER_RANGE_START = 48, NUMBER_RANGE_END = 57;
	var CAP_ALPHABET_RANGE_START = 96, CAP_ALPHABET_RANGE_END = 122;
	var SMALL_ALPHABET_RANGE_START = 65, SMALL_ALPHABET_RANGE_END = 90;
	var RIGHT_ARROW = 39, LEFT_ARROW = 37, DELETE = 46, BACKSPACE = 8, SPACE = 32;
	if (((keyCode >= NUMBER_RANGE_START && keyCode <= NUMBER_RANGE_END) || (keyCode >= CAP_ALPHABET_RANGE_START && keyCode <= CAP_ALPHABET_RANGE_END) || (keyCode >= SMALL_ALPHABET_RANGE_START && keyCode <= SMALL_ALPHABET_RANGE_END) || keyCode == SPACE || com.site.Util.checkCharacter(event))) {
		return true;
	}
	return false;
};

com.site.Util.getCaretPosition = function (ctrl) {
	var caretPos = 0;
	// IE
	if (document.selection) {
		ctrl.focus();
		var sel = document.selection.createRange();
		sel.moveStart('character', -ctrl.value.length);
		caretPos = sel.text.length;
	}
	// Firefox
	else if (ctrl.selectionStart || ctrl.selectionStart == '0') {
		caretPos = ctrl.selectionStart;
	}

	return caretPos;
};
	
com.site.Util.setCaretPosition = function (ctrl, pos) {
	if (ctrl.setSelectionRange) {
		ctrl.focus();
		ctrl.setSelectionRange(pos, pos);
	}
	else if (ctrl.createTextRange) {
		var range = ctrl.createTextRange();
		range.collapse(true);
		range.moveEnd('character', pos);
		range.moveStart('character', pos);
		range.select();
	}
};

com.site.Util.checkDigits = function (value) {
	return false || /^\d+$/.test(value);
};
	
com.site.Util.validatePhoneAmerica = function (eleName) {
	var subjectString = $("#" + eleName).val().substring(0,14);
	var regexObj = /^\(?([2-9][0-8][0-9])\)?[-. ]?([2-9][0-9]{2})[-. ]?([0-9]{4})$/;
	if (regexObj.test(subjectString)) {
		return true;
	}
	// TO Do : event tracking for invalid phone
	EventTracking('Invalid Phone', 'Click', 'Invalid Phone-' + subjectString); // unique wrong phone decode events
	return false;
};

com.site.Util.reformatPhoneNumberText = function (phonenumber) {
	var result = "";
	var result = "";
	var sizeOfNumber = 10;
	phonenumber = phonenumber.replace(/-/g, "");
	phonenumber = phonenumber.replace(/\(/g, "");
	phonenumber = phonenumber.replace(/\)/g, "");
	phonenumber = phonenumber.replace(/ /g, "");
	for (var index = 0; index < phonenumber.length; index++) {
		if (com.site.Util.checkDigits(phonenumber.charAt(index)) && index < sizeOfNumber) {
			if (result.length == 0) {
				result += "(";
				index--;
			}
			else if (result.length == 4) {
				result += ") ";
				index--;
			}
			else if (result.length != 9) {
				result += phonenumber.charAt(index);
			}
			else {
				result += "-";
				index--;
			}
		}
	}
    return result;
};
	
com.site.Util.reformatPhoneNumber = function (sourceObj) {
	var phonenumber = sourceObj.val();
	var result = "";
	var sizeOfNumber = 10;
	phonenumber = phonenumber.replace(/-/g, "");
	phonenumber = phonenumber.replace(/\(/g, "");
	phonenumber = phonenumber.replace(/\)/g, "");
	phonenumber = phonenumber.replace(/ /g, "");
	for (var index = 0; index < phonenumber.length; index++) {
		if (com.site.Util.checkDigits(phonenumber.charAt(index)) && index < sizeOfNumber) {
			if (result.length == 0) {
				result += "(";
				index--;
			}
			else if (result.length == 4) {
				result += ") ";
				index--;
			}
			else if (result.length != 9) {
				result += phonenumber.charAt(index);
			}
			else {
				result += "-";
				index--;
			}
		}
	}
	sourceObj.val(result);
};

com.site.Util.formatPhoneNumber = function(value) {
	var phonenumber = value;
	var result = "";
	var sizeOfNumber=10;
        phonenumber = phonenumber.replace(/-/g,"");
        phonenumber = phonenumber.replace(/\(/g,"");
        phonenumber = phonenumber.replace(/\)/g,"");
        phonenumber = phonenumber.replace(/ /g,"");
	for(var index=0;index<phonenumber.length;index++)
	{
		if(com.site.Util.checkDigits(phonenumber.charAt(index)) && index < sizeOfNumber)
		{
			if(result.length != 3 && result.length != 7)
			{
				result += phonenumber.charAt(index);
			}
			else
			{
				result += "-";
				index--;
			}
		}
	}
	return result;
};

com.site.Util.checkForValidPassword = function(value) {
	var reValue=/[^\w\d\s\!@#$%^&*~=\`\[\](){},.:;|_\'<>+?\-\/\"]/g;
	return !reValue.test(value);
};
	
com.site.Util.validateAllowedNameCharacter = function (value) {
	var reValue = /^[\w\d\s\,.'-]$/;
	return reValue.test(value);
};

com.site.Util.validateAllowedNameCharacterAll = function(value) {
	var reValue = /^[\w\d\s\,.'-]+$/;
	return reValue.test(value);
};
	
com.site.Util.formatAllowedNameCharacter = function (sourceObj) {
	var sourceValue = sourceObj.value;
	var result = "";
	for (var index = 0; index < sourceValue.length; index++) {
		if (com.site.Util.validateAllowedNameCharacter(sourceValue.charAt(index))) {
			result += sourceValue.charAt(index);
		}
	}
	return result;
};

com.site.Util.formatAllowedCharacter = function (sourceObj) {	
	var sourceValue = sourceObj.value;
	return sourceValue.replace(/[%^_=<>\{\}\[\]\\\/]/gi, '');
};
	
com.site.Util.validateAndFormateName = function (objName) {
	objName.value = com.site.Util.formatAllowedNameCharacter(objName);
};
	
com.site.Util.capatilizeFirstValue = function (ele) {
	var val = ele.value;
	ele.value = com.site.Util.convertFirstLetterTocapital(val);
};

com.site.Util.convertFirstLetterTocapital = function(val){
	/*
	* Commented auto casing code
	* as per PED-3959: 16.Turn off auto casing from fields
	*/
	return val.charAt(0).toUpperCase() + val.substring(1, val.length);
};

com.site.Util.isAlphaNumeric = function (argVal) {
	var reAlphaNum = /^[A-Za-z0-9]+$/;
	return reAlphaNum.test(argVal);
};

com.site.Util.formatAlphaNum = function(sourceObj) {
	var sourceValue = sourceObj.value;
	var result = "";
	for(var index=0;index<sourceValue.length;index++)
	{
		if(com.site.Util.isAlphaNumeric(sourceValue.charAt(index)))
		{
			result += sourceValue.charAt(index);
		}
	}
	return result.toUpperCase();
};

com.site.Util.validateAndFormateVIN = function(objName) {
	objName.value=com.site.Util.formatAlphaNum(objName);
};

com.site.Util.isValidEmail = function(email){
	return false || (/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~])+)*))@((([a-z]|\d)|(([a-z]|\d)([a-z]|\d|-|\.)*([a-z]|\d)))\.)+(([a-z])|(([a-z])([a-z]|\d|-|\.)*([a-z]))){1,}$/i.test(email));
};

com.site.Util.getURLParameter = function(sParam) {
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0].toLowerCase() == sParam.toLowerCase())
        {
            return sParameterName[1];
        }
    }
	return "";
};

com.site.Util.getCurrentPageUrl = function () {
    return document.location.href;
};

com.site.Util.isIEMobile = function() {
    var regExp = new RegExp("IEMobile", "i");
    return navigator.userAgent.match(regExp);
};

com.site.Util.areCookiesEnabled = function() {
    var cookieEnabled = (navigator.cookieEnabled) ? true : false;

    if (typeof navigator.cookieEnabled == "undefined" && !cookieEnabled)
    { 
        document.cookie="testcookie";
        cookieEnabled = (document.cookie.indexOf("testcookie") != -1) ? true : false;
    }
    return (cookieEnabled);
};

com.site.Util.setCookie = function(cname,cvalue,exdays){
	var d = new Date();
	d.setTime(d.getTime()+(exdays*24*60*60*1000));
	var expires = "expires="+d.toGMTString();
	document.cookie = cname + "=" + cvalue + "; " + expires;
};

com.site.Util.getCookie = function(cname) {
	var name = cname + "=";
	var ca = document.cookie.split(';');
	for(var i=0; i<ca.length; i++) 
	{
		var c = ca[i].trim();
		if (c.indexOf(name)==0) return c.substring(name.length,c.length);
	}
	return "";
};

// Reset Agent Session Timer on page load, AJAX request and filling form data.
com.site.Util.resetAgentSessionTimer = function() {
	clearTimeout(com.site.Config.AgentSessionTimeoutWindowOpen);	// reset timer
	clearTimeout(com.site.Config.AgentSessionTimeout);	// reset timer
	// check if agent user and is currently logged in as seller
	if($("#adminUser").val() != "" && com.site.Config.SellerSessionActive == true)
	{
		com.site.Config.AgentSessionTimeoutWindowOpen = setTimeout(function(){window.open(com.site.Config.AgentSessionTimeoutWindow, '_blank', 'width=450,height=300,top=0px,left=0px');}, com.site.Config.WindowOpenTime * com.site.Config.AgentSellerTimeForCheckPerSecond * 1000);

		com.site.Config.AgentSessionTimeout = setTimeout(function () { com.site.Util.sendRequestForSessionExpire(com.site.Config.LogoutLink); }, com.site.Config.AgentSellerSessionTimeout * com.site.Config.AgentSellerTimeForCheckPerSecond * 1000); 
	}
};

 // used to send AJAX request for session expire
com.site.Util.sendRequestForSessionExpire = function(url) {
	var xmlhttp;
	if (window.XMLHttpRequest) {
		xmlhttp = new XMLHttpRequest();
	} else {
		xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
	}

	xmlhttp.onreadystatechange = function () {
		if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
			response = xmlhttp.responseText;
		}
	}
	xmlhttp.open("GET", url, false);
	xmlhttp.send();
};	

com.site.Util.getBrowserTimeZone = function(){
	var d = new Date();
	var usertime = d.toLocaleString();
	 
	// Some browsers / OSs provide the timezone name in their local string:
	var tzsregex = /\b(ACDT|ACST|ACT|ADT|AEDT|AEST|AFT|AKDT|AKST|AMST|AMT|ART|AST|AWDT|AWST|AZOST|AZT|BDT|BIOT|BIT|BOT|BRT|BST|BTT|CAT|CCT|CDT|CEDT|CEST|CET|CHADT|CHAST|CIST|CKT|CLST|CLT|COST|COT|CST|CT|CVT|CXT|CHST|DFT|EAST|EAT|ECT|EDT|EEDT|EEST|EET|EST|FJT|FKST|FKT|GALT|GET|GFT|GILT|GIT|GMT|GST|GYT|HADT|HAEC|HAST|HKT|HMT|HST|ICT|IDT|IRKT|IRST|IST|JST|KRAT|KST|LHST|LINT|MART|MAGT|MDT|MET|MEST|MIT|MSD|MSK|MST|MUT|MYT|NDT|NFT|NPT|NST|NT|NZDT|NZST|OMST|PDT|PETT|PHOT|PKT|PST|RET|SAMT|SAST|SBT|SCT|SGT|SLT|SST|TAHT|THA|UYST|UYT|VET|VLAT|WAT|WEDT|WEST|WET|WST|YAKT|YEKT)\b/gi;
	 
	// In other browsers the timezone needs to be estimated based on the offset:
	var timezonenames = {"UTC+0":"GMT","UTC+1":"CET","UTC+2":"EET","UTC+3":"EEDT","UTC+3.5":"IRST","UTC+4":"MSD","UTC+4.5":"AFT","UTC+5":"PKT","UTC+5.5":"IST","UTC+6":"BST","UTC+6.5":"MST","UTC+7":"THA","UTC+8":"AWST","UTC+9":"AWDT","UTC+9.5":"ACST","UTC+10":"AEST","UTC+10.5":"ACDT","UTC+11":"AEDT","UTC+11.5":"NFT","UTC+12":"NZST","UTC-1":"AZOST","UTC-2":"GST","UTC-3":"BRT","UTC-3.5":"NST","UTC-4":"CLT","UTC-4.5":"VET","UTC-5":"EST","UTC-6":"CST","UTC-7":"MST","UTC-8":"PST","UTC-9":"AKST","UTC-9.5":"MIT","UTC-10":"HST","UTC-11":"SST","UTC-12":"BIT"};
	 
	var timezone = usertime.match(tzsregex);
	if (timezone) {
		timezone = timezone[timezone.length-1];
	} else {
		var offset = -1*d.getTimezoneOffset()/60;
		offset = "UTC" + (offset >= 0 ? "+" + offset : offset);
		timezone = timezonenames[offset];
	}
	
	return timezone;
};

com.site.Util.isBrowserTimeZoneInsideUSA = function(timezone){
	var d = new Date();
	var offset = -1*d.getTimezoneOffset()/60;
	// "UTC-5":"EST","UTC-6":"CST","UTC-7":"MST","UTC-8":"PST","UTC-9":"AKST","UTC-10"
	if(offset <= -5 && offset >= -10 && (timezone == "EST" || timezone == "CST" || timezone == "MST" || timezone == "PST" || timezone == "AKST" || timezone == "HST"))
	{
		return true;
	}
	return false;
};

// set this default image if image fails to load
com.site.Util.setDefaultImage = function(id) {
	$("#"+id).attr("src","/images/carNotAvailableImage.png");
}
com.site.Util.setDefaultContentImageFromObj = function(obj) {
	$(obj).attr("src","/images/carNotAvailableImage.png");
	$(obj).parent().css('background','url(/images/carNotAvailableImage.png) no-repeat scroll center center rgba(0, 0, 0, 0)')
}

com.site.Util.getKeyCode = function(evt) {
    var keyCode = evt ? (evt.which ? evt.which : evt.keyCode) : event.keyCode;
    return keyCode;
}

com.site.Util.getOfferIdFromHashValueOfUrlParameter = function(){
	var offerId = 0;
	var s=window.location.hash;
	s = s.toLowerCase();
	//s = s.substr(s.indexOf('#')).match(/OfferId\/(\d+)/);
	s = s.split("/");
	if(s!=null && s.length>0)
	{
		for(var i=0;i<s.length;i++)
		{
			if(s[i]=="#"+com.site.Config.OfferIdHashName.toLowerCase())
			{
				var nextArray = s[i+1];
				nextArray = nextArray!=null && nextArray!="" ? nextArray.replace( /^\D+/g, '') : ""; // Remove P from offerId
				if(nextArray!=null && nextArray!="" && !isNaN(parseInt(nextArray)) && parseInt(nextArray)>0)
				{
					offerId = parseInt(nextArray);
				}
				break;
			}
		}
	}
	return offerId;
};

com.site.Util.checkForHttpUrl = function(url) {
   var strNumber = url;
   var result = "";
   if (strNumber.length == 0)
       return;
   if (!(strNumber.indexOf("https://") != -1 || strNumber.indexOf("http://") != -1)) {
       result = result.concat("http://", strNumber);
   }
   else {
       result = strNumber;
   }
   return result;
};

com.site.Util.showFullPageLoadingMask = function(){
	$.blockUI.defaults.message = '<div style="padding:20px;width: 90px; margin: auto;"><i class="icon-spin5 spinner animate-spin" style="font-size:30px;"></i></div>'; 
	$.blockUI.defaults.overlayCSS.opacity = '0.6';
	$.blockUI.defaults.overlayCSS.backgroundColor = '#fff';
	$.blockUI.defaults.overlayCSS.cursor = 'default';
	$.blockUI.defaults.fadeIn = 0;
	$.blockUI.defaults.fadeOut = 0;
	$.blockUI.defaults.baseZ = 1100;
	$.blockUI.defaults.css.border = 'none';
	$.blockUI.defaults.css.backgroundColor = 'transparent';
	$.blockUI.defaults.css.cursor = 'default';
	$.blockUI(); 
};

com.site.Util.showLoadingMaskOnElement = function(id){
	$(id).block({ 
		message: null,
		overlayCSS: { 
			opacity: '0.6',
			backgroundColor : '#fff',
			cursor : 'default'
		},
		css: { 
			border: 'none',
			backgroundColor : 'transparent',
			cursor : 'default'
		},
		baseZ : 1100,
		fadeIn : 0,
		fadeOut : 0,
	}); 
};

com.site.Util.hideLoadingMaskOnElement = function(id){
	$(id).unblock(); 
};

//To shuffle selector elements of jQuery
com.site.Util.shuffleSelection = function(selector){
	$.fn.shuffle = function() {
        var allElems = this.get(),
            getRandom = function(max) {
                return Math.floor(Math.random() * max);
            },
            shuffled = $.map(allElems, function(){
			
                var random = getRandom(allElems.length),
                    randEl = $(allElems[random]).clone(true)[0];
                allElems.splice(random, 1);
                return randEl;
				
            });
        this.each(function(i){
            $(this).replaceWith($(shuffled[i]));
        });
        return $(shuffled);
    };
	$(selector).shuffle();
}
	
// Call this on page start

// To support overflow scroll in windows mobile
if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
	var msViewportStyle = document.createElement('style')
	msViewportStyle.appendChild(
	document.createTextNode(
	'@-ms-viewport{width:auto!important}'
	)
	)
	document.querySelector('head').appendChild(msViewportStyle)
}

com.site.Util.getCookie = function(cname) {
	var name = cname + "=";
	var ca = document.cookie.split(';');
	for(var i=0; i<ca.length; i++) 
	{
		var c = ca[i].trim();
		if (c.indexOf(name)==0) return c.substring(name.length,c.length);
	}
	return "";
};

com.site.Util.decodeHtml = function(html) {
    var txt = document.createElement("textarea");
    txt.innerHTML = html;
    return txt.value;
};

com.site.Util.getFormatedMileage = function(mileage) {
    var milesText = mileage > 1 ? " miles" : " mile";
	return mileage > 0 ? com.site.Util.add_commas(mileage) + milesText: "Unable to verify mileage";
};

/* Google call tracking started */
window.pti_replaceNumber=function(a,b){
	$(".phoneNumberText").text(a);
	$(".phoneLink").attr("href","tel:"+b);
	EventTracking('Google Phone Tracked', 'onload', a + " " + b);
};
var waitForGoogleFnc=function(){"undefined"===typeof _googWcmGet||"undefined"===typeof jQuery?window.setTimeout(waitForGoogleFnc,50):_googWcmGet(window.pti_replaceNumber,com.site.Config.PhoneNumber);
};

// Init function for google call tracking
waitForGoogleFnc();

/* Google call tracking End */


com.site.Util.trackPage = function(page){

	var User = "";
	
	// If publisher view, track all event as Publisher.
	if($("#publisherViewId").length != 0 && $("#publisherViewId").val() != "") {
		User = "Publisher";
	}
	// If agent view(offer and loyalty), track all event as Agent.
	else if($("#adminUser").length != 0 && $("#adminUser").val() != "") {
		User = "Agent";
	}
	
	var fromJMC = com.site.Util.getURLParameter("FromJMC");
	var trackFromJMC = false;
	if(!!fromJMC && fromJMC == "true" && com.site.Util.supports_html5_storage()){
		if(!!sessionStorage["site.fromJMC"] == false)
			trackFromJMC = true;
	}
	
	switch (page) {
		case 'home':
			PageTracking('/home'+User);
		break;
		case 'vehicleinfo':
			PageTracking('/getOfferClick'+User);
		break;
		case 'year':
			PageTracking('/year'+User);
		break;
		case 'make':
			PageTracking('/make'+User);
		break;
		case 'model':
			PageTracking('/model'+User);
		break;
		case 'trim':
			PageTracking('/trim'+User);
		break;
		case 'vin':
			PageTracking('/vinSearch'+User);
		break;
		case 'titleType':
			PageTracking('/titleType'+User);
		break;
		case 'location':
			PageTracking('/zipcode'+User);
			if(trackFromJMC) {
				EventTracking('Redirected from JMC move forward', 'onload', 'Move forward');
				sessionStorage["site.fromJMC"] = true;
			}
		break;
		case 'keyAndBattery':
			PageTracking('/keyAndBattery'+User);
		break;
		case 'drivable':
			PageTracking('/drivable'+User);
		break;
		case 'underTheHood':
			PageTracking('/underHood'+User);
		break;
		case 'taxiUsage':
			PageTracking('/taxiUsage'+User);
		break;
		case 'mileage':
			PageTracking('/mileage'+User);
		break;
		case 'bodyPanel':
			PageTracking('/bodyPanels'+User);
		break;
		case 'interiorItems':
			PageTracking('/interior'+User);
		break;
		case 'tires':
			PageTracking('/tires'+User);
		break;
		case 'bodyDamage':
			PageTracking('/bodyDamage'+User);
		break;
		case 'glassAndLight':
			PageTracking('/glassDamage'+User);
		break;
		case 'floodAndFire':
			PageTracking('/floodAndFire'+User);
		break;
		case 'preInstantOffer':
			PageTracking('/preInstantOffer'+User);
		break;
		case 'instantOffer':
			PageTracking('/instantOffer'+User);
		break;
		case 'acceptInstantOffer':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/getListedClick'+User);
			}
			else {
				PageTracking('/getPaidClick'+User);
			}
		break;
		case 'carLocation':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/locationList'+User);
			}
			else {
				PageTracking('/location'+User);
			}			
		break;
		case 'charityReference':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/charityReferenceList'+User);
			}
			else {
				PageTracking('/charityReference'+User);
			}			
		break;
		case 'color':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/colorList'+User);
			}
			else {
				PageTracking('/color'+User);
			}	
		break;
		case 'nameInfo':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/nameInfoList'+User);
			}
			else {
				PageTracking('/nameInfo'+User);
			}	
		break;
		case 'payWho':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/payeeList'+User);
			}
			else {
				PageTracking('/payee'+User);
			}	
		break;
		case 'contact':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/contactList'+User);
			}
			else {
				PageTracking('/contact'+User);
			}	
		break;
		case 'whatIsVin':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/vinList'+User);
			}
			else {
				PageTracking('/vin'+User);
			}	
			
			if(!!com.site.AcceptOffer && com.site.AcceptOffer.IsVINOptional){
				EventTracking('Direct offer VIN', 'onload', 'vin Optional slide viewed');
			}
		break;
		case 'title':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/titleType2List'+User);
			}
			else {
				PageTracking('/titleType2'+User);
			}	
			
			// For direct claim If VIN optional slide is filled and moved to title slide.
			if(!!com.site.AcceptOffer && com.site.AcceptOffer.IsVINOptional && !com.site.AcceptOffer.vinOptionalStatus()){
				EventTracking('Direct offer VIN', 'onload', 'vin Optional slide filled');
			}
			// For direct claim, track title slide.
			if(!!com.site.AcceptOffer && com.site.AcceptOffer.IsVINOptional){
				EventTracking('Direct offer Title', 'onload', 'title slide viewed');
			}
		break;
		case 'titleIssued':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/titleIssuedList'+User);
			}
			else {
				PageTracking('/titleIssued'+User);
			}	
			
			// For direct claim, track title in state issued slide.
			if(!!com.site.AcceptOffer && com.site.AcceptOffer.IsVINOptional){
				EventTracking('Direct offer Title', 'onload', 'title in state slide viewed');
			}
		break;
		case 'owner':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/ownerList'+User);
			}
			else {
				PageTracking('/owner'+User);
			}	
		break;
		case 'canSign':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/ownerSignList'+User);
			}
			else {
				PageTracking('/ownerSign'+User);
			}	
		break;
		case 'liens':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/liensList'+User);
			}
			else {
				PageTracking('/leins'+User);
			}	
		break;		
		case 'addPhotos':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/photosList'+User);
			}
			else {
				PageTracking('/photos'+User);
			}	
		break;
		case 'acceptOffer':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/acceptOfferList'+User);
			}
			else {
				PageTracking('/acceptOffer'+User);
			}	
		break;
		case 'acceptAvailableOfferAccepted':
			// If asking price is set track 
			if(instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/lisitngCreated'+User);
			}
			else {
				PageTracking('/offerAccepted'+User);
			}	
		break;
		case 'createaccount':
			// If asking price is set track 
			if(typeof instantOfferPageObj != "undefined" && instantOfferPageObj.getAskingPriceStatus()){
				PageTracking('/createAccountList'+User);
			}
			else {
				PageTracking('/createAccount'+User);
			}				
		break;
		case 'login':
			PageTracking('/login'+User);
		break;
		case '/about-us':
			PageTracking('/aboutUs'+User);
		break;
		case '/terms':
			PageTracking('/terms'+User);
		break;
		case '/privacy':
			PageTracking('/privacy'+User);
		break;
		case 'resetpassword':
			PageTracking('/resetPassword'+User);
		break;
		case 'offerstatus':
			PageTracking('/status'+User);
		break;
		case 'myoffers':
			PageTracking('/myOffers'+User);
		break;
		case 'myaccount':
			PageTracking('/myAccount'+User);
		break;
		case 'forgotpassword':
			PageTracking('/forgotPassword'+User);
		break;
		case 'initialOfferPush':
			PageTracking('/initialOfferPush'+User);
		break;
		case 'initialOffer':
			PageTracking('/initialOffer'+User);
		break;
		case 'contactInfo':
			PageTracking('/contactInfo'+User);
		break;
		case 'imageUpload':
			PageTracking('/photoUpload'+User);
		break;
	}
};

// Add dropOff amount if seller delivery is selected.
com.site.Util.checkAndGetNewOfferWithDropOffCharges = function(transportType,offer,dropOffOffer){
	if(!!transportType && transportType.toLowerCase() == "seller"){
		offer = offer + dropOffOffer;
	}
	return offer;
};

com.site.Util.fillGCLIDIAsCookie = function(){
	var GCLID = com.site.Util.getURLParameter("gclid");
	// Only track first click for GCLID
	if(!!GCLID && !!com.site.Util.getCookie("_gclId") == false){
		var GCLSRC = com.site.Util.getURLParameter('gclsrc');
		if(!GCLSRC || GCLSRC.indexOf('aw') !== -1){
			com.site.Util.setCookie("_gclId",GCLID,30);
		}
	}
};

com.site.Util.fillQuanticMindParamAsCookie = function(){
	var QuanticMindParam = com.site.Util.getURLParameter("iv_");
	// Only track first click for QuanticMindParam
	if(!!QuanticMindParam && !!com.site.Util.getCookie("_Quantic_iv_") == false){
		com.site.Util.setCookie("_Quantic_iv_",QuanticMindParam,30);		
	}
};

com.site.Util.supports_html5_storage = function() {
	var testKey = 'test', storage = window.sessionStorage;
    try 
    {	
		// Added sample test storage to check if its supported.
        storage.setItem(testKey, '1');
        storage.removeItem(testKey);
        return 'localStorage' in window && window['localStorage'] !== null;
    } 
    catch (error) 
    {
        return false;
    }
};

com.site.Util.checkIfRedirectedFromJMC = function(){
	var fromJMC = com.site.Util.getURLParameter("FromJMC");
	if(!!fromJMC && fromJMC == "true" && com.site.Util.supports_html5_storage() && !!sessionStorage["site.fromJMC"] == false){
		EventTracking('Redirected from JMC', 'onload', 'Redirected from JMC');
	}
};

com.site.Util.returnAddPhotosModalData = function(containerId){
	var containerData = {
		//other
		0:{},
		
		//Front
		1:{
			title:"Front of car",
			text: "Upload a photo of the front of your vehicle. Try to take the photo as close as possible while getting the entire front of the car in the frame.",
			img: "/Images/AddPhotos/front.jpg"
		},
		
		//Rear
		2:{
			title:"Rear of car",
			text: "Upload a photo of the back of your vehicle. Try to take the photo as close as possible while getting the entire rear of the car in the frame.",
			img: "/Images/AddPhotos/rear.jpg"
		},
		
		//Instrument cluster
		3:{
			title:"Instrument cluster",
			text: "Upload a photo of the instrument cluster. Include the speedometer (MPH), odometer (Mileage), and tachometer (RPM) in the photo, with the car running (if it starts).",
			img: "/Images/AddPhotos/instrument-cluster.jpg"
			
		},
		
		//Title front
		4:{
			title:"Front of title",
			text: "Upload a photo of the front of your title. Try to take the photo as close as possible while getting the entire title in the frame.",
			img: "/Images/AddPhotos/title-front.jpg"
		},
		
		//Title rear
		5:{
			title:"Back of title",
			text: "Upload a photo of the back of your title. Try to take the photo as close as possible while getting the entire title in the frame.",
			img: "/Images/AddPhotos/title-back.jpg"
		},
		
		//Lien release
		6:{
			title:"Lien release",
			text: "Upload a photo of the front of your lien release letter. Try to take the photo as close as possible while getting the entire letter in the frame.",
			img: "/Images/AddPhotos/lein-release.jpg"
		},
		
		//Under hood
		7:{
			title:"Under the hood",
			text: "Open the hood and upload a photo of your engine compartment. Try to take the photo as close as possible while getting the entire compartment in the frame.",
			img: "/Images/AddPhotos/under-the-hood.jpg"
		},
		
		//Interior
		8:{
			title:"Interior of car",
			text: "Upload a photo of the interior of your car. Try to get as many interior components in frame as possible including steering wheel, radio, seats, and anything missing.",
			img: "/Images/AddPhotos/interior.jpg"
		},
		
		//Driver front
		9:{
			title:"Front driver side corner",
			text: "Upload a photo of the front driver side corner of your vehicle. Try to take the photo as close as possible while getting the entire width of the car in the frame.",
			img: "/Images/AddPhotos/front-driver.jpg"
		},
		
		//Driver rear
		10:{
			title:"Rear driver side corner",
			text: "Upload a photo of the back driver side corner of your vehicle. Try to take the photo as close as possible while getting the entire width of the car in the frame.",
			img: "/Images/AddPhotos/rear-driver.jpg"
		},
		
		//Passenger front
		11:{
			title:"Front passenger side corner",
			text: "Upload a photo of the front passenger side corner of your vehicle. Try to take the photo as close as possible while getting the entire width of the car in the frame.",
			img: "/Images/AddPhotos/front-passenger.jpg"
		},
		
		//Passenger rear
		12:{
			title:"Rear passenger side corner",
			text: "Upload a photo of the back passenger side corner of your vehicle. Try to take the photo as close as possible while getting the entire width of the car in the frame.",
			img: "/Images/AddPhotos/rear-passenger.jpg"
		}
	}
	return !!containerData[containerId] == true ? containerData[containerId] : "";
};

com.site.Util.getModalOptionsFromObject = function(damageLocation){
	var damageLocationModal = { DSFOption: false, PSFOption: false, DSROption: false, PSROption: false };

	damageLocationModal.DSFOption = damageLocation.FrontLeftDamageLocation;
	damageLocationModal.PSFOption = damageLocation.FrontRightDamageLocation;
	damageLocationModal.PSROption = damageLocation.RearRightDamageLocation;
	damageLocationModal.DSROption = damageLocation.RearLeftDamageLocation;		
	
	return damageLocationModal;
};
com.site.Util.autoSuggest = function(id){
	var domainListStr = "" // string of domains (comma separated)
	var emailInput = {}, emailInputLen = 0; //email input objects
	var arrayOfInputPluginObj = []; //(array of object) it will contain id and plug-in Objects of each input
	var domainsArray = ""; // we will store domains as array of string here
	var _self = this;
	
	// initialize values
	initObj = function(){
		domainListStr = $("#popularDomains").val(); // string of domains
		emailInput = $(".applyAutoSuggestEmail"), emailInputLen = emailInput.length;
		arrayOfInputPluginObj = [];
		if(!!domainListStr){
			domainsArray = domainListStr.split(","); // making array from string
		}
	};
	
	//get plugin object from id
	getPluginObj = function(id){
		var pluginObj = {};
		$.map(arrayOfInputPluginObj, function(obj,i){
			if(id == obj.id){
				pluginObj = obj.pluginObj;
			}
		});
		return pluginObj;
	};
	
	// fill object with all plugin instances of auto suggest
	fillObjs = function(){
		$.map(emailInput,function(input,i){
			var obj = {};
			obj.id = $(input).attr("id");
			var autoSuggest = $(input).emailautocomplete({ domains: domainsArray });
			obj.pluginObj = autoSuggest.data().yz_emailautocomplete;
			arrayOfInputPluginObj.push(obj);
			
			
			/* 
			 * To add status of input, whether input was hide/visible at a time initialization
			 * There issue with hidden inputs
			 * Plug-in is not functioning properly on hidden elements
			 * As per status, we will know whether we will need to re-initialize plugin at time 
			 * when input is visible
			*/
			if( $(input).is(":visible") ){
				$(input).attr("isVisible", true);
			}else{
				$(input).attr("isVisible", false);
			}
		});
	};
	
	// binding events
	bindEvent = function(){
		// In case of blur, fire plugin auto complete method to fill suggested value
		emailInput.on({
			blur:function(){ 
				if(!!$(this).val()){
					getPluginObj( $(this).attr("id") ).autocomplete();
				}
			},
			keyup:function(){
				var _selfObj = $(this);
				if( $(_selfObj).attr("isVisible") == "false" ){
					// When input is not visible, we re-initialize plugin
					_self.recallInitOnPlugin( $(_selfObj).attr("id") );
					$(_selfObj).attr("isVisible",true);
				}
				
			},
			paste: function(e){
				var _selfObj = $(this);
				if( $(this).attr("isVisible") == "false" ){
					// When input is not visible, we re-initialize plugin
					_self.recallInitOnPlugin( $(this).attr("id") );
					$(this).attr("isVisible",true);
				}
				setTimeout(function(){
					getPluginObj( $(_selfObj).attr("id") ).displaySuggestion(e);
				},50)
			}
		});
	};
	
	// to re-initialize plug-in by id of input
	this.recallInitOnPlugin = function(id){
		getPluginObj(id).resetFieldLeftOffset();
	};
	
	// initialize object
	this.init = function(){
		initObj();
		if(!!domainListStr == false || !!emailInputLen == false ){return} // when no value in domains, do not initialize
		fillObjs();
		bindEvent();
	};
};
com.site.Util.autoSuggestObj = new com.site.Util.autoSuggest();



com.site.Util.initKeyNavigationPlugin = function(id){
		
	$(id + ' .tab-index-flow').keydown(function(e) {
		//up - 38 or // Shift + tab - 9
		if (e.keyCode==38 || (e.shiftKey && e.keyCode==9)) {
			
			if(e.keyCode==38 || e.keyCode==9){
				e.stopPropagation();
				e.preventDefault();
			}
			
			var $items = $(id + ' .tab-index-flow').not(".disabled").not(":hidden");
			var index = $items.index(this);
			var $el;
			if(index > 0){
				$el = $($items[index-1]).focus();
			}else{
				$el = $($items[$items.length-1]).focus();
			}
		}
		//down - 40 or //tab - 9
		else if (e.keyCode==40 || e.keyCode==9) {
			
			if(e.keyCode==40 || e.keyCode==9){
				e.stopPropagation();
				e.preventDefault();
			}
				
			var $items = $(id + ' .tab-index-flow').not(".disabled").not(":hidden");
			var index = $items.index(this);
			var $el;
			if($items.length > index+1){
				$el = $($items[index+1]).focus();
			}else{
				$el = $($items[0]).focus();
			}	
		}
		//space or Enter key
		else if (e.keyCode==32) {		
			$(this).click();
		}
	});
};

com.site.Util.getSourceMediumforWeb = function(){
	var sourceCookies = com.site.Util.getCookie("__utmz");
	var ga_source = '';
	var ga_campaign = '';
	var ga_medium = '';
	var sourceMedium = '';
	if (sourceCookies!="")
	{
		var b = sourceCookies; 
		var a = "utmcsr";
		ga_source = (a = b.match(a + "=(.*?)(?:\\|utm|$)")) && 2 == a.length ? a[1] : void 0;
		a = "utmccn";
		ga_campaign = (a = b.match(a + "=(.*?)(?:\\|utm|$)")) && 2 == a.length ? a[1] : void 0;
		a = "utmcmd";
		ga_medium = (a = b.match(a + "=(.*?)(?:\\|utm|$)")) && 2 == a.length ? a[1] : void 0;
		
		if(!!ga_source == false){
			a = "utmgclid";
			ga_source = (a = b.match(a + "=(.*?)(?:\\|utm|$)")) && 2 == a.length ? a[1] : void 0;
			if (!!ga_source)
			{
				ga_source = "google";
				ga_medium = "cpc";
			}
		}
		
		// If source and medium are present then only make request.
		if(!!ga_source && !!ga_medium){
			sourceMedium = ga_source + " / " + ga_medium;
		}
	}
	
	return sourceMedium;
};

// PED-12813 PPC to Phone On Page Dynamic Tracking
com.site.Util.setDynamicPhone = function(){
	
	var dynamicPhone = "";
	var fromJMC = com.site.Util.getURLParameter("FromJMC");
	var dynamicPhoneCookieValue = com.site.Util.getCookie("_dynamicPhone");
	// If cookie is available the get phone number from cookie.
	if(!!dynamicPhoneCookieValue){
		if(dynamicPhoneCookieValue == "Adwords CTC JMC"){
			dynamicPhone = com.site.Config.AdwordsCTCJMCPhoneNumber;
		}
		else if(dynamicPhoneCookieValue == "Bing CTC JMC"){
			dynamicPhone = com.site.Config.BingCTCJMCPhoneNumber;
		}
		else if(dynamicPhoneCookieValue == "Adwords CTC Peddle"){
			dynamicPhone = com.site.Config.AdwordsCTCPeddlePhoneNumber;
		}
		else if(dynamicPhoneCookieValue == "Bing CTC Peddle"){
			dynamicPhone = com.site.Config.BingCTCPeddlePhoneNumber;
		}
	}
	else {
		// If from JMC and source is google / cpc then show JMC google ads phone number
		if(!!fromJMC && fromJMC == "true" && !!com.site.Util.getSourceMediumforWeb() && com.site.Util.getSourceMediumforWeb().toLowerCase() == "google / cpc"){
			dynamicPhone = com.site.Config.AdwordsCTCJMCPhoneNumber;
			dynamicPhoneCookieValue = "Adwords CTC JMC";		
		}		
		// If from JMC and source is bing / cpc then show JMC Bing ads phone number
		else if(!!fromJMC && fromJMC == "true" && !!com.site.Util.getSourceMediumforWeb() && com.site.Util.getSourceMediumforWeb().toLowerCase() == "bing / cpc"){
			dynamicPhone = com.site.Config.BingCTCJMCPhoneNumber;
			dynamicPhoneCookieValue = "Bing CTC JMC";
		}				
		// If from peddle and source is google / cpc then show peddle google ads phone number
		else if(!!com.site.Util.getSourceMediumforWeb() && com.site.Util.getSourceMediumforWeb().toLowerCase() == "google / cpc"){
			dynamicPhone = com.site.Config.AdwordsCTCPeddlePhoneNumber;
			dynamicPhoneCookieValue = "Adwords CTC Peddle";		
		}		
		// If from peddle and source is bing / cpc then show peddle bing phone number
		else if(!!com.site.Util.getSourceMediumforWeb() && com.site.Util.getSourceMediumforWeb().toLowerCase() == "bing / cpc"){
			dynamicPhone = com.site.Config.BingCTCPeddlePhoneNumber;
			dynamicPhoneCookieValue = "Bing CTC Peddle";		
		}
		
		if(!!dynamicPhone && !!com.site.Util.getCookie("_dynamicPhone") == false){
			com.site.Util.setCookie("_dynamicPhone",dynamicPhoneCookieValue,30);
		}
	}
	
	if(!!dynamicPhone){
		$(".phoneNumberText").text(dynamicPhone);
		$(".phoneLink").attr("href","tel:"+dynamicPhone);
		if(!!$('.headerPopover').data('tooltipster')){
			$('.headerPopover').tooltipster('content', $('#HeaderSupportMenu').html());			
		}
	}	
};

com.site.Util.isOfferAgent = function() {	
	return $("#adminUser").val() != "" ? true : false;
};

com.site.Util.isAdminAgent = function() {	
	return ($("#hiddenAdminAgent").length > 0 && $("#hiddenAdminAgent").val() == "true") ? true : false;
};

com.site.Util.isPublisherView = function() {	
	return ($("#publisherViewId").length != 0 && $("#publisherViewId").val() != "") ? true : false;
};

com.site.Util.checkToFireExperiment = function(isVINRequired, offerType, selectedYear){
	// Fire experiment for sellers only and offer type is direct and VIN is optional and year >= 1981.
	if(!com.site.Util.isOfferAgent() && !isVINRequired && offerType == "Direct" && parseInt(selectedYear) >= com.site.Config.OptionalTrimAndVINForPreYear){
		com.site.Config.VINExperimentSet = true;
	}
};

com.site.Util.getSlideNoFromName = function (slideName) {
    for (var index = 0; index < allSlides.length; index++) {
        if (allSlides[index] == slideName) {
            return index;
        }
    }
    return "";
};

com.site.Util.getSlideNameFromNumber = function(slideNumber) {
	return allSlides[slideNumber];
};

com.site.Util.getSlideNoFromNameForAcceptOffer = function(slideName) {
	return (com.site.Util.getSlideNoFromName(slideName) - com.site.Util.getSlideNoFromName("charityReference"));
};

com.site.Util.isVisitorsCookieSet = function(){	
	return !!com.site.Util.getCookie("_visitor_peddle");
};

com.site.Util.setVisitorsCookie = function(source){	
	com.site.Util.setCookie("_visitor_peddle",source,30);
};

com.site.Util.openHelpInWindow = function(){
	window.open(com.site.Config.HelpURLLink);
};

$(document).ready(function () {

	/* Global : This flag is fix for adding smooth tap in touch devices as click events takes longer time to respond. */
	var flag = false;
		
	$('.slideError .customSlideError').on("click tap", function (event) {
		if (!flag) {
            flag = true;
            setTimeout(function () { flag = false; }, 100);
            // do something
            com.site.Util.hideErrorAlert(true);
            return false;
        }
	});	
	
	$('.vehicleInfoAlertTires .customSlideError').on("click tap", function (event) {
		if (!flag) {
            flag = true;
            setTimeout(function () { flag = false; }, 100);
            // do something
            com.site.Util.hideTireAlert();
            return false;
        }
	});	
	
	$('.vehicleInfoAlertKeyAndBattery .customSlideError').on("click tap", function (event) {
		if (!flag) {
            flag = true;
            setTimeout(function () { flag = false; }, 100);
            // do something
            com.site.Util.hideKeyAndBatteryAlert();
            return false;
        }
	});	
	
	$('.errorMessageAlert .customSlideError').on("click tap", function (event) {
		if (!flag) {
            flag = true;
            setTimeout(function () { flag = false; }, 100);
            // do something
            $(".errorMessageAlert").hide();
            return false;
        }
	});	

	$('.successMessageAlert .customSlideError').on("click tap", function (event) {
		if (!flag) {
            flag = true;
            setTimeout(function () { flag = false; }, 100);
            // do something
            $(".successMessageAlert").hide();
            return false;
        }
	});	
	
	// Add no touch class to document if touch is not supported.
    if (!("ontouchstart" in document.documentElement)) {
        document.documentElement.className += " no-touch";
    }
	
	com.site.Util.resetAgentSessionTimer();  // Reset Agent Session Timer
	
	com.site.Util.fillGCLIDIAsCookie(); // Set GCL ID into cookies PED-9062
	
	com.site.Util.fillQuanticMindParamAsCookie(); // Set Quantic Mind Param into cookies PED-20860
	
	com.site.Util.checkIfRedirectedFromJMC();  // Set session storage variable if redirect from JMC to track JMC to Peddle .
	
	com.site.Util.autoSuggestObj.init();
	
	// If utmz is not loaded then fire event to set that cookie.
	if(!!com.site.Util.getCookie("__utmz") == false){
		dataLayer.push({Category : 'Page loaded',Action : 'onload',Label : "pageLoaded",event : 'TrackEvent', eventCallback : function() {
			com.site.Util.setDynamicPhone();
		}});
	}
	com.site.Util.setDynamicPhone();
	
	$(window).on("resize",function(){
		setTimeout(function(){			
			var id = $(".modal.custom-modal:visible").attr("id");
			if(id != "createAccountLoginModal" && id != "declineOffer" && id != "rateOffer"){				
				if(!!com.site.Modal){
					// PED-16069 when window gets resize system hides modal so to prevent colse event to run automatically we was reset modal name on close of modal. So when we open it, we again keep that name for open modal.
					var modalName = "";					
					if(typeof infoPopUpModalObj != "undefined" && !!infoPopUpModalObj && !!infoPopUpModalObj.getCurrentOpenModel()){
						modalName = infoPopUpModalObj.getCurrentOpenModel();
						infoPopUpModalObj.setCurrentOpenModel("");
					}
					$("#"+id).modal('hide');
					com.site.Modal.attachAllModalsEvent(id);
					if(typeof infoPopUpModalObj != "undefined" && !!infoPopUpModalObj && !!infoPopUpModalObj.getCurrentOpenModel() == false){
						infoPopUpModalObj.setCurrentOpenModel(modalName);
					}
					$("#"+id).modal('show');
				}
			}
		},300);
	});
	
	
	// PED-16518 /PED-17967  Disable Damage Location if Damage Location is disable for perticular seller.
	if((!!$("#isDamageLocationDisabled").val() && $("#isDamageLocationDisabled").val().toLowerCase() == "true")){
		com.site.Config.IsConditionModalEnable = false;
	}
	
	// Init lazy load for images.
	$(".footerBBBLogoIconImage").lazyload({
		threshold : 200
	});
	
});


// Missing text
LoggingInButtonText = "Logging in";
CreatingInButtonText = "Creating account";;
/** ------------------------------------------creating head object of name-space---------------------------------------------- **/

// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site.AjaxEngine) com.site.AjaxEngine = {}
else if (typeof com.site.AjaxEngine != "object")
    throw new Error("com.site.AjaxEngine already exists and is not an object");
	
/** ------------------------------------------creating head object of name-space end---------------------------------------------- **/

com.site.AjaxEngine.sendRequest = function (url, orgCallback, callback, parameters, methodType, isAsync) {
	com.site.Util.resetAgentSessionTimer();  // Reset Agent Session Timer
	parameters = parameters || {};
    parameters.SID = new Date().getTime();
	
	if(methodType == "PUT"){
		parameters = JSON.stringify(parameters);		
	}
	$.ajax({
		url : url,
		timeout : 130000,
		async : isAsync,
		cache : false,
		type : methodType,
		data : parameters,
		dataType : "json",
		success : function (response) {			
			if (response.Success == false && response.ErrorMessage == "Access Denied") {
				com.site.AjaxEngine.accessDenied();
            }
			else if (response.Success == false && response.SessionExpired != undefined && response.SessionExpired == true) {
               com.site.AjaxEngine.sessionTimeoutPopupOpen();
            }
            else {
				orgCallback.callback = typeof orgCallback.callback == 'function' ? orgCallback.callback : $.noop;
				callback(response, orgCallback);
            }
			
		},
		error : function (jqXHR, textStatus, errorThrown) {
			if (jqXHR.status === 0 || jqXHR.readyState === 0 || jqXHR.statusText == "abort") {
				return;
			}
			com.site.AjaxEngine.systemErrorPopupOpen();
		}
	});
};

// Use below function in each inidividual page.
com.site.AjaxEngine.systemErrorPopupOpen = function() {
	
};

com.site.AjaxEngine.accessDenied = function() {
	
};

com.site.AjaxEngine.sessionTimeoutPopupOpen = function() {
	EventTracking('Session Timeout', 'Click', 'Session Timeout');
};

com.site.AjaxEngine.showLoadingMask = function(){
	$.blockUI.defaults.message = null; 
	$.blockUI.defaults.overlayCSS.opacity = '0';
	$.blockUI.defaults.overlayCSS.cursor = 'default';
	$.blockUI.defaults.fadeIn = 0;
	$.blockUI.defaults.fadeOut = 0;
	$.blockUI.defaults.baseZ = 1100;
	$.blockUI(); 
};

com.site.AjaxEngine.hideLoadingMask = function(){
	$.unblockUI();
};

com.site.AjaxEngine.showMask = true;
com.site.AjaxEngine.hideMask = true;

$(document).on({
	ajaxStart : function(){
		if(com.site.AjaxEngine.showMask){
			com.site.AjaxEngine.showLoadingMask();
		}
		com.site.AjaxEngine.showMask = true;
	},
	ajaxStop : function () {
		if(com.site.AjaxEngine.hideMask){
			setTimeout(function(){	
				com.site.AjaxEngine.hideLoadingMask();
			},0);
		}
	},
	ajaxError : function () {
		com.site.AjaxEngine.hideLoadingMask();
	}
});

/**---- AJAX COMMON SERVICE FUNCTION----**/
com.site.AjaxEngine.service = function (url, callbackObject, parameters, methodType, isAsync) {
	/*Trim all parameter values*/
	com.site.AjaxEngine.trim(parameters);
	com.site.AjaxEngine.sendRequest(url, callbackObject, com.site.AjaxEngine.serviceCallback, parameters, methodType, isAsync);
};

com.site.AjaxEngine.serviceCallback = function (responseObjData, callbackObject) {
	if (responseObjData != null) {
		com.site.AjaxEngine.decodeAllResponse(responseObjData);
		callbackObject.callback.call(callbackObject.context, responseObjData);
	}
};

/**---- TRIM ALL PARAMETER VALUES------**/
com.site.AjaxEngine.trim = function(obj){
	$.each( obj, function( key, value ) {
	  obj[key] = $.trim(value);
	});
};

com.site.AjaxEngine.decodeAllResponse = function(obj){
	$.each( obj, function( key, value ) {
		obj[key] = com.site.AjaxEngine.recursiveFunctionToDecodeString(key, value);		
	});
};

com.site.AjaxEngine.recursiveFunctionToDecodeString = function(key, value){
	if(typeof value != "undefined" && !!value && typeof value === "object"){
		$.each(value, function(key, val) {
			value[key] = com.site.AjaxEngine.recursiveFunctionToDecodeString(key, val)
		});
	}
	else if(typeof value != "undefined" && !!value && typeof value === "string"){
		value = com.site.Util.decodeHtml(value);		
	}
	return value;
	
};

;
/**----creating head object of name-space----**/

// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site.DataService) com.site.DataService = {}
else if (typeof com.site.DataService != "object")
    throw new Error("com.site.DataService already exists and is not an object");
	
/**----creating head object of name-space end----**/

com.site.DataService.getRelatedParameter = function (command, postDataObj) {
	var command = command.toLowerCase();
	switch (command) {
	case 'year':
		var parameter = {
			command : 'GetYears'
		}
		break;
	case 'make':
		var parameter = {
			command : 'GetMakes',
			yearId : postDataObj.year
		}
		break;
	case 'model':
		var parameter = {
			command : 'GetModels',
			yearId : postDataObj.year,
			makeId : postDataObj.make
		}
		break;
	case 'trim':
		var parameter = {
			command : 'GetTrims',
			yearId : postDataObj.year,
			makeId : postDataObj.make,
			modelId : postDataObj.model,
			bodyTypeId : postDataObj.bodyTypeId,
			cabTypeId : postDataObj.cabTypeId,
			doors : postDataObj.doors
		}
		break;
	}
	return parameter;
};

/**GET YEAR MAKE MODEL TRIM DATA**/
/* command : its custom given parameter can be 'year','make','model','trim' */
com.site.DataService.getYMMSData = function (command, postDataObj, _callback ) {
	com.site.AjaxEngine.showLoadingMask();
	/* returns related parameter as per command */
	var parameters = com.site.DataService.getRelatedParameter(command, postDataObj);
    setTimeout(function() {
        com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
            callback: _callback,
            context: this
        }, parameters, "GET", true);
    }, 1000);
};

/**----ZIP DECOODE ----**/
com.site.DataService.zipDecode = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'DecodeZipcode',
		zipcode : postDataObj.zipCode
	}

	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----VIN DECOODE ----**/
com.site.DataService.vinDecode = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'DecodeVIN',
		vin : postDataObj.vin
	}	

	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----VIN VERIFY ----**/
com.site.DataService.verifyVIN = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'VerifyVIN'
	}	
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----VIN RESET ----**/
com.site.DataService.resetVIN = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'ResetVIN'
	}	
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};


/**----VIN Duplicate ----**/
com.site.DataService.checkDuplicateVin = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'DuplicateVin'
	}	
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----VIN save And Continue ----**/
com.site.DataService.saveAndContinueVin = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'ContinueAndRecalculate'
	}	
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----CREATE OFFER----**/
com.site.DataService.createOffer = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'CreateOffer'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----CREATE INSTANT OFFER FROM DECLINE STATUS----**/
com.site.DataService.createOfferFromDecline = function (postDataObj, _callback) {

    var parameters = {
        command : 'createOfferFromDecline'
    }
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/**----UPDATE OFFER----**/
com.site.DataService.updateOffer = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'UpdateOffer'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----Early OFFER Request----**/
com.site.DataService.requestEarlyOffer = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'RequestEarlyOffer'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----Attribute Instant Offer Source Request----**/
com.site.DataService.AttributeInstantOfferSource = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'AttributeInstantOfferSource'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----Attribute Claim Source Request----**/
com.site.DataService.AttributeClaimSource = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'AttributeClaimSource'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----GET INSTANT OFFER----**/
com.site.DataService.getInstantOffer = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'GetInstantOffer'
	}
	$.extend( parameters, postDataObj);
	
	com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "GET", true);	
};

/**----GET OFFER----**/
com.site.DataService.getOffer = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'GetOffer'
	}
	$.extend( parameters, postDataObj);
	
	com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "GET", true);	
};

/**----GetRevertToListing----**/
com.site.DataService.getRevertToListing = function (postDataObj, _callback) {

    var parameters = {
        command: 'GetRevertToListing'
    }
    $.extend(parameters, postDataObj);

    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/**----GET TESTIMONIAL DATA----**/
com.site.DataService.getTestimonialData = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'SocialNetwork'
	}
	$.extend( parameters, postDataObj);
	
	com.site.AjaxEngine.service(com.site.Config.loginProcessorUrl, {
		callback : _callback,
		context : this
	}, parameters, "POST", true);	
};

/**----LOGIN----**/
com.site.DataService.login = function(postDataObj, _callback){
	var parameters = {
		command : 'Login'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**----BUYER LOGIN----**/
com.site.DataService.loginBuyer = function(postDataObj, _callback){
	var parameters = {
		command : 'Login'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.LoginRequestHandlerUrlForBuyer, {
		callback : _callback,
		context : this
	}, parameters, "POST", true);	
};

/**----CHARITY LOGIN----**/
com.site.DataService.loginCharity = function(postDataObj, _callback){
	var parameters = {
	};
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.LoginRequestHandlerUrlForCharity, {
		callback : _callback,
		context : this
	}, parameters, "POST", true);	
};

/**FACEBOOK LOGIN**/
com.site.DataService.facebookLogin = function(postDataObj, _callback){
	var parameters = {
		command : 'LoginUsingFacebook'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**GOOGLE LOGIN**/
com.site.DataService.googleLogin = function(postDataObj, _callback){
	var parameters = {
		command : 'LoginUsingGoogle'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**SEND FORGOT PASSWORD LINK**/
com.site.DataService.sendForgotPasswordLink = function(postDataObj, _callback){
	var parameters = {
		command : 'ForgotPassword'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**SEND Reset Password LINK**/
com.site.DataService.resetPassword = function(postDataObj, _callback){
	var parameters = {
		command : 'ResetPassword'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**CHECK AGENT AVAILABILITY**/
com.site.DataService.checkAgentAvailability = function(postDataObj, _callback){
	var parameters = {}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service('/IsCompanyWorkingTime.ashx', {
		callback : _callback,
		context : this
	}, parameters, "POST", true);	
};

/**CREATE ACCOUNT**/
com.site.DataService.createAccount = function(postDataObj, _callback){
	var parameters = {
		command : 'CreateAccount'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service( com.site.Config.PutRequestHandlerUrl , {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**TRANSFER OWNERSHIP**/
com.site.DataService.transferOwnership = function(postDataObj, _callback){
	var parameters = {
		command : 'TransferOwnership'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**CHECK FOR DUPLICATE VEHICLE**/
com.site.DataService.checkForDuplicateVehicle = function(postDataObj, _callback){
	var parameters = {
		command : 'CheckForDuplicateVehicle'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};

/**CREATE CLAIM FROM OFFER**/
com.site.DataService.createClaimFromOffer = function(postDataObj, _callback){
	var parameters = {
		command : 'CreateClaimFromOffer'
	}
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "PUT", true);	
};
/**GET MY ACCOUNT DATA**/
com.site.DataService.getMyAccountData = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetAccountDetail'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/**SET MY ACCOUNT DATA**/
com.site.DataService.setMyAccountData = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateAccountDetail'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/**GET SOCIAL NETWORK DATA**/
com.site.DataService.getSocialNetworkData = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetSocialNetworkData'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/**GET MY OFFER DATA**/
com.site.DataService.getMyOfferData = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetMyOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/**GET OFFER STSTUS DATA**/
com.site.DataService.getOfferStatus = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetClaimDetailForOfferStatus'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/**GET ALL VEHICLE INFORMATION FOR INSTANT OFFER**/
com.site.DataService.getVehicleDetailForInstantOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetVehicleDetailForInstantOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/**GET ALL VEHICLE INFORMATION FOR INSTANT OFFER**/
com.site.DataService.getVehicleDetailForPartialOffer = function (postDataObj, _callback) {
	var parameters = {
		command: 'GetVehicleDetailForPartialOffer'
	};
	$.extend(parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
		callback: _callback,
		context: this
	}, parameters, "GET", true);
};

/**GET ALL VEHICLE INFORMATION FOR ACCEPT OFFER**/
com.site.DataService.getVehicleDetailForOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetVehicleDetailForOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Update Vehicle Information **/
com.site.DataService.updateVehicleInformation = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateVehicleInformation'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Accept Offer**/
com.site.DataService.acceptOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'AcceptOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Cancel Offer**/
com.site.DataService.cancelOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'CancelOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};


/** Get Twilio Caller Phone Number**/
com.site.DataService.getTwilioCallerPhoneNumber = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetTwilioCallerPhoneNumber'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Send BOT SMS **/
com.site.DataService.sendSMSBot = function (postDataObj, _callback) {
    var parameters = {
        command: 'SendSMSBot'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Send VIN SMS Help **/
com.site.DataService.sendVINSMS = function (postDataObj, _callback) {
    var parameters = {
        command: 'SendVINHelpSMS' 
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Get VIN SMS Short URL **/
com.site.DataService.getShortUrlForVINSMS = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetShortUrlForVinSms' 
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Get Short URL **/
com.site.DataService.getShortUrl = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetShortUrl' 
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Get Recently Peddle Car Info **/
com.site.DataService.getRecentlyPeddleCarInfo = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetRecentlyPeddleCarInfo'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Set Ratings **/
com.site.DataService.setRatings = function (postDataObj, _callback) {
    var parameters = {
        command: 'SetRatings'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Get Publisher Detail **/
com.site.DataService.getPublisherDetail = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetPublisherDetail'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/** Update On Finish Laters **/
com.site.DataService.updateOnFinishLaters = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateOnFinishLaters'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

/** Update Claim Details **/
com.site.DataService.updateClaimDetails = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateClaimDetails'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};


/** Get Title In State Detail**/
com.site.DataService.getTitleInStateDetail = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetTitleInStateDetail'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};


com.site.DataService.DeleteVehicleImage = function (postDataObj, _callback) {
    var parameters = {
        command: 'DeleteVehicleImages'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.RotateVehicleImage = function (postDataObj, _callback) {
    var parameters = {
        command: 'RotateVehicleImages'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.GetVehicleImages = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetVehicleImages'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

com.site.DataService.UpdateInstantOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateInstantOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.UpdateClaimOffer = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateClaimOffer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.UpdateInstantTransportType = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateInitialTransportType'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.UpdateClaimTransportType = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateClaimTransportType'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.AcceptInitialOfferPushLead = function (postDataObj, _callback) {
    var parameters = {
        command: 'AcceptInitialOfferPushLead'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.AutoLoginAgentUsingEmail = function (postDataObj, _callback) {
    var parameters = {
        command: 'AutoLoginAgentUsingEmail'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.EmailCaptureAndClaimCreation = function (postDataObj, _callback) {
    var parameters = {
        command: 'EmailCaptureAndClaimCreation'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.UpdateAskingPrice = function (postDataObj, _callback) {
    var parameters = {
        command: 'UpdateAskingPrice'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.PutRequestHandlerReadUrl, {
        callback: _callback,
        context: this
    }, parameters, "PUT", true);
};

com.site.DataService.GetVehicleImagesContainer = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetVehicleImagesContainer'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

com.site.DataService.getStreetToStreetDistance = function (postDataObj, _callback) {
    var parameters = {
        command: 'GetStreetToStreetDistance'
    };
    $.extend(parameters, postDataObj);
    com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
        callback: _callback,
        context: this
    }, parameters, "GET", true);
};

/**----Get Eligible Advance Questions ----**/
com.site.DataService.getEligibleAdvanceQuestions = function (postDataObj, _callback ) {
	
	var parameters = {
		command : 'GetEligibleAdvanceQuestions'
	}	
	$.extend( parameters, postDataObj);
	com.site.AjaxEngine.service(com.site.Config.RequestHandlerUrl, {
		callback : _callback,
		context : this
	}, parameters, "GET", true);	
};
;

// Code related to geolocation starts --------------------------

var geoLocationTimeout = null;
var fromGeoLocationZip = false;

initiate_geolocation = function() {
    if (navigator && navigator.geolocation) {
		// Show loading mask.
		$(".zipInput").closest('.ui-input').children(".icon-cancel-circled.ui-icon-input").hide();
        $(".zipInput").closest('.ui-input').children(".icon-ok-circled.ui-icon-input").hide();
        $(".zipInput").closest('.ui-input').children(".icon-spin5.ui-icon-input").show();
		
        navigator.geolocation.getCurrentPosition(handle_geolocation_query, handle_errors/*, { maximumAge: 600000, timeout: 0 }*/);
		
		if (geoLocationTimeout) {
			clearTimeout(geoLocationTimeout); //cancel the previous timer.
			geoLocationTimeout = null;
		}
		// Added timer if 1 minute to hide loading mask if seller do not responds to location authentication.
		geoLocationTimeout = setTimeout(function() { 
			// Hide loading mask.
			$(".zipInput").closest('.ui-input').children(".icon-spin5.ui-icon-input").hide();
			com.site.Util.showErrorAlert("Location sharing not authorized.");
		},30000);
    }
};

handle_geolocation_query = function(position) {
	clearTimeout(geoLocationTimeout); //cancel the previous timer.
	geoLocationTimeout = null;
	
    var lat = parseFloat(position.coords.latitude);
    var lng = parseFloat(position.coords.longitude);
    initializeGeoCode();
    zipcodeLatLng(lat, lng);
};

initializeGeoCode = function() {
    geocoder = new google.maps.Geocoder();
};

zipcodeLatLng = function (lat, lng)
{

    var latlng = new google.maps.LatLng(lat, lng);

    geocoder.geocode({ 'latLng': latlng }, function (results, status)
    {

        if (status == google.maps.GeocoderStatus.OK)
        {

            var decodedGeo = getGeoLocationZipANDCity(results); // get geolocation zip and city of "US" 

            if (decodedGeo != false)
            {
				// Function to be included when ever GeoLocation.js file is added.
				postGeoLocationDecode(decodedGeo.zip, decodedGeo.state,decodedGeo.stateCode);                
            }
        }
    });
};

getGeoLocationZipANDCity = function(geoResults) {
    var geoResultsLength = geoResults.length;
    var geoZip = false;
    var geoCountry = false;
    var geoCity = false;
    var geoStateCode = false;

    for (var index = 0; index < geoResultsLength; index++) {
        if (geoResults[index].types[0] == "postal_code") {
            geoZip = getZipFromGeoData(geoResults[index].address_components);
        }
    }

    if (geoZip != false) {
        return { zip: geoZip.zip,
            state: geoZip.state,
            stateCode: geoZip.stateCode
        }
    }
	// Hide loading mask.
	$(".zipInput").closest('.ui-input').children(".icon-spin5.ui-icon-input").hide();
    return false;
};

getZipFromGeoData = function (geoAdd) {
    var geoAddLength = geoAdd.length;
    var geoData = {
        zip: "",
        state: "",
        stateCode: ""
    };
    for (var j = 0; j < geoAddLength; j++)
    {
        if (geoAdd[j].types[0] == "postal_code" && geoAdd[j].long_name.length == 5)
        {
            geoData.zip = geoAdd[j].long_name;
        }

        if (geoAdd[j].types[0] == "administrative_area_level_1" && geoData.zip.length > 0)
        {
            geoData.state = geoAdd[j].long_name;
            geoData.stateCode = geoAdd[j].short_name;
            return geoData;
        }
    }

    return false;
};

handle_errors = function(error) {
	// Hide loading mask.
	$(".zipInput").closest('.ui-input').children(".icon-spin5.ui-icon-input").hide();
	
	clearTimeout(geoLocationTimeout); //cancel the previous timer.
	geoLocationTimeout = null;
			
    switch (error.code) {
        case error.PERMISSION_DENIED:
            /* Permission denied */
			com.site.Util.showErrorAlert("Location sharing not authorized.");
            break;
        
        case error.POSITION_UNAVAILABLE:
            
            break;

        case error.TIMEOUT:
            
            break;

        case error.UNKNOWN_ERROR:
            
            break;
    }
};

// Code related to geolocation Ends --------------------------;

// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site.Modal) com.site.Modal = {}
else if (typeof com.site.Modal != "object")
    throw new Error("com.site.Modal already exists and is not an object");



// noOverflowScroll = function() {
	// if(overthrow.support == "native"){
		// return true;
	// }
	// return false;
// }

// checkAndAddForNativeScrollSupport = function() {
	// if (!noOverflowScroll()) {
		// $('body')
		// .addClass('no-overflow-scroll')
		// .on('show.bs.modal', function(event) {
		  // $(event.target).css('padding-top', $(window).scrollTop());
		// });
	// }
// };

com.site.Modal.checkAndSetScrollablePopup = function (id) {

    var headerFooterHeight = parseInt($('#'+id+' .modal-header').outerHeight() + $('#'+id+' .modal-footer').outerHeight(true));
    var winHeight = parseInt($(window).height());
	$('#'+id+' .nano').nanoScroller({ stop: true });
	
	//shadowhr
	$('#'+id).parent().find('.shadowHr-modal').hide();
	
	$('#'+id+' .custom-modal-body-nano').removeClass('nano');
	$('#'+id+' .modal-body').removeClass('padding0');
	$('#'+id+' .custom-modal-body-nano').css('cssText', "height: auto !important;");
	$("html").removeClass("noscroll");   // starts scrolling of back page when modal is open.
	
    if (winHeight < headerFooterHeight + $('#'+id+' .modal-body').outerHeight(true)) {
		var height = winHeight - headerFooterHeight -2;
		if(parseInt($(window).width()) > 767)
		{
			height = winHeight - headerFooterHeight - parseInt($(window).height()*0.01)*2 ;
		}
        $('#'+id+' .modal-body').addClass('padding0');
        $('#'+id+' .custom-modal-body-nano').addClass('nano');
        $('#'+id+' .custom-modal-body-nano').css('cssText', "height: " + height + "px !important;");
        $('#'+id+' .nano').nanoScroller({ 
			iOSNativeScrolling: true ,
			sliderClass: 'scrollNanoSlider',
			preventPageScrolling: true
		});
		
		//shadowhr
		$('#'+id+' .nano').parent().find('.shadowHr-modal').show();
		$('#'+id+' .nano').bind("scrollend", function(e){
			/* console.log("hide"); */
			$(this).parent().find('.shadowHr-modal').hide("fast");	
		});
		$('#'+id+' .nano').bind("scrolling", function(e,data){
			var trigger = 5;
			var diff = Math.abs(data.scroll - data.prevScroll);
			if( (data.scroll < data.prevScroll) && (diff > trigger) ){
				/* console.log("show"); */
				$(this).parent().find('.shadowHr-modal').show();
			}
		});
		//shadowhr
		
		$("html").addClass("noscroll");    // stops scrolling of back page when modal is open.
		return;
    }
	
	
	if(parseInt($(window).width()) <= 767)
	{
		var height = winHeight - headerFooterHeight -2 - 20;
		$('#'+id+' .custom-modal-body-nano').css('cssText', "height: " + height + "px !important;");
	}
	
};

// Properties related to condition question modal options.
com.site.Modal.optionQuestionProperty = 
	[
		{
		    name: 'driverSideFront', answer: "",
		    setAnswer: function (val) {
		        this.answer = val;
		    },
		    getAnswer: function () {
		        return this.answer;
		    }
		},
		{
		    name: 'passengerSideFront', answer: "",
		    setAnswer: function (val) {
		        this.answer = val;
		    },
		    getAnswer: function () {
		        return this.answer;
		    }
		},
		{
		    name: 'driverSideRear', answer: "",
		    setAnswer: function (val) {
		        this.answer = val;
		    },
		    getAnswer: function () {
		        return this.answer;
		    }
		},
		{
		    name: 'passengerSideRear', answer: "",
		    setAnswer: function (val) {
		        this.answer = val;
		    },
		    getAnswer: function () {
		        return this.answer;
		    }
		}
	];

// Properties related to condition question having option modal as one of the question.
com.site.Modal.optionModalProperty =
	[
		{
		    title: 'Indicate missing panel locations. <span class="custom-modal-header-subtext"> (Select all that apply)</span>', 
		    id: "missingPanel",
		    modalAnswer: "No"
		},
		{
		    title: 'Indicate damaged locations. <span class="custom-modal-header-subtext"> (Select all that apply)</span>',
		    id: "bodyDamage",
		    modalAnswer: "No"
		},
		{
		    title: 'Indicate flat tires. <span class="custom-modal-header-subtext"> (Select all that apply)</span>',
		    id: "flatTire",
		    modalAnswer: "Partial"
		},
        {
            title: 'Indicate missing wheels. <span class="custom-modal-header-subtext"> (Select all that apply)</span>',
            id: "missingTire",
            modalAnswer: "No"
        },
		{
		    title: 'Indicate damaged locations. <span class="custom-modal-header-subtext"> (Select all that apply)</span>',
		    id: "glassDamage",
		    modalAnswer: "No"
		}
	];

// Control functions related to condition question having option modal as one of the question.
com.site.Modal.ConditionPagePopUpModalControl = function (init) {
	this.setSuccessButtonAction = init.setSuccessButtonAction;
	this.setCancelButtonAction = init.setCancelButtonAction;
	this.onResetAction = init.onResetAction;
	this.modalOptionId = com.site.Modal.optionQuestionProperty;
	this.modalInfoId = com.site.Modal.optionModalProperty;
	this.currentOpenModelId = "";
	this.AttachModalEvents();
};

com.site.Modal.ConditionPagePopUpModalControl.prototype = {
    setCurrentOpenModel: function (value)
    {
        this.currentOpenModelId = value;
    },
    getCurrentOpenModel: function ()
    {
        return this.currentOpenModelId;
    },
    getCurrentOpenModelAnswer: function ()
    {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                return this.modalInfoId[index].modalAnswer;
            }
        }
        return "";
    },
	
    setModalOption: function (name, value)
    {
        for (var index = 0; index < this.modalOptionId.length; index++)
        {
            if (this.modalOptionId[index].name == name)
            {
                this.modalOptionId[index].setAnswer(value);
                if (value)
                {
                    this.selectModelOption(name);
                }
                else
                {
                    this.deSelectModelOption(name);
                }

                break;
            }
        }
    },
    getModalOption: function (name)
    {
        for (var index = 0; index < this.modalOptionId.length; index++)
        {
            if (this.modalOptionId[index].name == name)
            {
                return this.modalOptionId[index].getAnswer();
            }
        }
        return "";
    },
    selectModelOption: function (name)
    {
        $("#" + name).addClass("modalOptionClicked");
        $("#" + name).find(".modalOptionHoverIconBackground").addClass("modalOptionIconClicked");
    },
    deSelectModelOption: function (name)
    {
        $("#" + name).removeClass("modalOptionClicked");
        $("#" + name).find(".modalOptionHoverIconBackground").removeClass("modalOptionIconClicked");
    },
    setPSFOption: function (value)
    {
        this.modalOptionId[1].setAnswer(value);
    },
    setDSROption: function (value)
    {
        this.modalOptionId[2].setAnswer(value);
    },
    setPSROption: function (value)
    {
        this.modalOptionId[3].setAnswer(value);
    },
    getDSFOption: function ()
    {
        return this.modalOptionId[0].getAnswer();
    },
    getPSFOption: function ()
    {
        return this.modalOptionId[1].getAnswer();
    },
    getDSROption: function ()
    {
        return this.modalOptionId[2].getAnswer();
    },
    getPSROption: function ()
    {
        return this.modalOptionId[3].getAnswer();
    },
    openModal: function (options)
    {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == options.id)
            {
                this.setCurrentOpenModel(this.modalInfoId[index].id);
                this.setModalTitle(this.modalInfoId[index].title);
                this.setModalOption(this.modalOptionId[0].name, options.DSFOption);
                this.setModalOption(this.modalOptionId[1].name, options.PSFOption);
                this.setModalOption(this.modalOptionId[2].name, options.DSROption);
                this.setModalOption(this.modalOptionId[3].name, options.PSROption);
            }
        }

        com.site.Modal.attachAllModalsEvent("responsive");
        $('#responsive').modal('show');
        this.AttachConditionModalCloseEvent();
		// On open of modal keep focus on close to support key navigation PED-10444.
		$("#responsive .close").focus();
    },
    closeModal: function ()
    {
        $('#responsive').modal('hide');
    },
    getCurrentOpenModelData: function ()
    {
        return {
            id: this.getCurrentOpenModel(),
            modalAnswer: this.getCurrentOpenModelAnswer(),
            DSFOption: this.getModalOption(this.modalOptionId[0].name),
            PSFOption: this.getModalOption(this.modalOptionId[1].name),
            DSROption: this.getModalOption(this.modalOptionId[2].name),
            PSROption: this.getModalOption(this.modalOptionId[3].name)
        };
    },
    setModalTitle: function (val)
    {
        $("#modalTitle").html(val);
    },
    IsAnyOptionsSet: function ()
    {
        for (var index = 0; index < this.modalOptionId.length; index++)
        {
            if (this.modalOptionId[index].getAnswer() == true)
            {
                return true;
            }
        }
        return false;
    },
    AttachConditionModalCloseEvent: function () {
        var self = this;
        $('#responsive').on('hide.bs.modal', function (e)
        {
            self.setCancelButtonAction(self.getCurrentOpenModelData);
        });
    },
    AttachModalEvents: function ()
    {
        var self = this;
        var flag = false;

		// Hover state for mobile device
		$('#doneButtonId').bind('touchstart touchend', function(e) {
			$(this).toggleClass('buttonTapClass');
		});
		
        $('#doneButtonId').on('tap click', function (event)
        {
            if (!flag)
            {
                flag = true;
                setTimeout(function () { flag = false; }, 100);
                // do something
                if (self.IsAnyOptionsSet())
                {
                    self.setSuccessButtonAction(self.getCurrentOpenModelData);
                    self.closeModal();
                }
				else {					
					self.onResetAction(self.getCurrentOpenModelData);
					self.closeModal();
				}
                return false;
            }

            return false;
        });

        $('#driverSideFront, #passengerSideFront, #driverSideRear, #passengerSideRear').bind({
            mouseenter: function ()
            {
                $(this).addClass("modalOptionsOnhover");
            },
            mouseleave: function ()
            {
                $(this).removeClass("modalOptionsOnhover");
            },
			focus: function ()
            {
				if(!jQuery.browser.mobile) {
					$(this).addClass("modalOptionsOnhover");
				}
            },
            blur: function ()
            {
				if(!jQuery.browser.mobile) {
					$(this).removeClass("modalOptionsOnhover");
				}
            }
        });

        $('#driverSideFront, #passengerSideFront, #driverSideRear, #passengerSideRear').on('touchstart touchend tap click', function ()
        {
            // removeClass or remove styles, in here you set it to default so even if it is focused, it makes no difference
            $(this).removeClass("modalOptionsOnhover");
        });

        $('#driverSideFront, #passengerSideFront, #driverSideRear, #passengerSideRear').on('tap click', function (event)
        {
            // Here flag is used for smooth tap event in mobile.
            if (!flag)
            {
                flag = true;
                setTimeout(function () { flag = false; }, 100);
                // do something
                if (!self.getModalOption(this.id))
                {
                    self.setModalOption(this.id, true);
                    return false;
                }
                self.setModalOption(this.id, false);
                return false;
            }
            return false;
        });

		// Init key navigation for condition modal.
		if(!jQuery.browser.mobile) {
			com.site.Util.initKeyNavigationPlugin("#responsive");
		}
		
    }
};

// Properties related to modal having single answer.
com.site.Modal.InfoPopUpModalProperty = 
	[
		{
		    title: "Unfortunately, we're unable to make you an offer while money is still owed.", 
		    id: "liens",
		    content: "Try us back when the car is paid off.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Similar offer found", 
		    id: "vehicleAlreadyExist",
		    content: "",
		    buttonText: "View offer",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Similar listing found", 
		    id: "vehicleAlreadyListed",
		    content: "",
		    buttonText: "View listing",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Duplicate offer found", 
		    id: "vinAlreadyExistAsAccepted",
		    content: "",
		    buttonText: "View offer",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Duplicate offer found", 
		    id: "vinAlreadyExistForDifferentSeller",
		    content: "",
		    buttonText: "Log in",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Duplicate offer found", 
		    id: "publisherVinAlreadyExistAsAccepted",
		    content: "",
		    buttonText: "Okay",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Similar offer found", 
		    id: "publisherVehicleAlreadyExistAsAccepted",
		    content: "",
		    buttonText: "Okay",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Unless the owner can sign the title, we can't move forward with your offer.", 
		    id: "canSign",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Your offer may change if you don't have the title.", 
		    id: "title",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Your offer may change", 
		    id: "salvageTitle",
		    content: "Your offer may change if you have a salvage or rebuilt title.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "We can't make an offer at this time.", 
		    id: "salvageTitleNoOffer",
		    content: "We're unable to make an offer on a car with a salvage or rebuilt title.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Enable cookie", 
		    id: "cookieDisable",
		    content: "Your browser's cookie functionality is turned off. Please turn it on.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Something went haywire. Probably just a fuse.", 
		    id: "systemError",
		    content: "Don't worry, we're all over it.",
		    buttonText: "Try again",
			postCloseActionRequired: true
		},
		{
		    title: "Session expired", 
		    id: "sessionExperied",
		    content: "Your session has expired! Please log in to continue.",
		    buttonText: "Log in",
			postCloseActionRequired: true
		},
		{
		    title: "We can't make an offer at this time.", 
		    id: "noTitleNoOffer",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Wait a second...", 
		    id: "duplicateVIN",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Your offer may change", 
		    id: "zipChange",
		    content: "Changing your car's location may change your offer.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "An error occurred while retrieving your information from Facebook.", 
		    id: "createAccountFacebookError",
		    content: "Please create an account manually.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "An error occurred while retrieving your information from Facebook.", 
		    id: "loginFacebookError",
		    content: "Please log in manually.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Done!", 
		    id: "forgotPasswordEmailSent",
		    content: "Check your inbox for password reset instructions.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Try again", 
		    id: "forgotPasswordEmailNotSent",
		    content: "An error has occurred. Try again.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Password Reset", 
		    id: "resetPassword",
		    content: "Your password has been reset.",
		    buttonText: "Return to login screen",
			postCloseActionRequired: true
		},
		{
		    title: "Link expired", 
		    id: "resetPasswordLinkExperied",
		    content: "Your password reset link has expired.",
		    buttonText: "Receive a new password reset link",
			postCloseActionRequired: true
		},
		{
		    title: "Password Reset failed", 
		    id: "resetPasswordFailed",
		    content: "Sorry, password failed to reset.",
		    buttonText: "Retry",
			postCloseActionRequired: true
		},
		{
		    title: "Congratulations!", 
		    id: "successfulAcceptOffer",
		    content: "You've successfully accepted your offer and the sale process is underway.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Your new offer", 
		    id: "offerChangeOnVehicleUpdate",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Available offers", 
		    id: "initialOffer",
		    content: "",
		    buttonText: "Continue",
			postCloseActionRequired: true
		},
		{
		    title: "Rating already provided.", 
		    id: "ratingAlreadyProvided",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
        {
            title: "VIN doesn't match", 
            id: "invalidVIN",
            content: "",
            buttonText: "Okay",
            postCloseActionRequired: true
        },
		{
		    title: "Dropping off your car",
		    id: "dropOffConfirmation",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Non-drivable", 
		    id: "nonDrivable",
		    content: "With wheels removed, we will not be able to verify that the car drives. The condition has been updated to reflect this.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Non-starting", 
		    id: "nonDrivableNonStart",
		    content: "With the key missing and/or the battery missing or dead, we will not be able to verify that the car starts. The condition has been updated to reflect this.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "The drop-off option is no longer available.", 
		    id: "dropOffRemoved",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Offer changed", 
		    id: "offerChanged",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "New offers available", 
		    id: "newOffersAvailable",
		    content: "Our offers on your vehicle have changed. Review and select a new offer option.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Without a title, we can't move forward with your listing.", 
		    id: "noTitleNoListing",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Unable to verify mileage", 
		    id: "unableToVerifyMileageModal",
		    content: "Selecting \"Unable to verify\" may decrease your offer and should only be selected if you cannot visually confirm the mileage of the vehicle upon inspection of the odometer.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},		
		{
		    title: "We'll need a few photos of your vehicle to complete your listing.", 
		    id: "missingPhotoModal",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},	
		{
		    title: "", 
		    id: "maximumAskingPriceUpdateModal",
		    content: "",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},	
		{
		    title: "Not sure of trim", 
		    id: "notSureTrimModal",
		    content: "By selecting \"Not sure\", we'll make our best guess as to what the trim might be to generate an offer. You'll need to determine the actual trim of your car before accepting your offer and the final amount may change once trim is provided.",
		    buttonText: "Okay",
			postCloseActionRequired: true
		},
		{
		    title: "Front of car", 
		    id: "addPhotosModal",
		    content: "",
		    buttonText: "Browse",
			postCloseActionRequired: true
		},
		{
		    title: "Are you sure?", 
		    id: "deleteVehicleImage",
		    content: "",
		    buttonText: "Yes",
			modalAnswer : "",
			postCloseActionRequired: true
		},		
	];

// Control functions related to modal having single answer.	
com.site.Modal.InfoPopUpModalControl = function (init)
{
	this.setSuccessButtonAction = init.setSuccessButtonAction;
	this.setCancelButtonAction = init.setCancelButtonAction;
	this.modalInfoId = com.site.Modal.InfoPopUpModalProperty;
	this.currentOpenModelId = "";
	this.AttachModalEvents();
};

com.site.Modal.InfoPopUpModalControl.prototype = {
	setCurrentOpenModel: function (value)
    {
        this.currentOpenModelId = value;
    },
    getCurrentOpenModel: function ()
    {
        return this.currentOpenModelId;
    },
	getCurrentOpenModelAnswer: function () {
		for (var index = 0; index < this.modalInfoId.length; index++)
		{
			if (this.modalInfoId[index].id == this.getCurrentOpenModel())
			{
				return this.modalInfoId[index].modalAnswer || "";
			}
		}
	return "";
    },
	setCurrentOpenModelAnswer: function (answer) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                this.modalInfoId[index].modalAnswer = answer;
				break;
            }
        }
    },
	getCurrentOpenModelCloseActionRequired: function () {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                return this.modalInfoId[index].postCloseActionRequired;
            }
        }
        return true;
    },
	setCurrentOpenModelCloseActionRequired: function (answer) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                this.modalInfoId[index].postCloseActionRequired = answer;
				break;
            }
        }
    },
	setModalTitle: function (val) {
        $("#infoPopUpTitle").html(val);
    },
	setModalContent: function (val) {
        $("#infoPopUpBody").html(val);
    },
	setModalButtonText: function (val){
        $("#infoPopUpButton").html(val);
    },
	openModal: function (options) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
			try{
            if (this.modalInfoId[index].id == options.id)
            {
				var content = this.modalInfoId[index].content;
				var title = this.modalInfoId[index].title;
				this.setCurrentOpenModel(this.modalInfoId[index].id);
				this.setCurrentOpenModelCloseActionRequired(true);		// reset on open
				this.setModalButtonText(this.modalInfoId[index].buttonText);
				
				// Confirmation modal for vehicle drop-off.
				if (options.id == "dropOffConfirmation") {
				    content += "Accepting this offer will require you to deliver your car to our drop-off location which is "+ options.distance +" miles away from your vehicle's location."
				}

				// If invalid VIN, show valid decoded vehicle and existing vehicle
				if(options.id == "invalidVIN"){
				    content += "VIN " + options.VIN + " doesn't match a " + options.currentVehicle + " Instead, it's for a " + options.decodedVehicle;
					//this.setCurrentOpenModelAnswer(options.response);
				}
				// If already exist vehicle, show vehicle in content.  
				if(options.id == "vehicleAlreadyExist"){
				   	content += "We noticed that you've already received an offer on a "+ options.vehicle +".";
					this.setCurrentOpenModelAnswer(options.response);
				}
				// If already exist vehicle is listed, show vehicle in content. PED-27545
				if(options.id == "vehicleAlreadyListed"){
				   	content += "We noticed that you've already listed a "+ options.vehicle +".";
					this.setCurrentOpenModelAnswer(options.response);
				}
				if(options.id == "vinAlreadyExistAsAccepted"){
				   	content += "The VIN you provided matches a "+ options.vehicle +" that is already in your account.";					
					this.setCurrentOpenModelAnswer(options.response);
				}
				if(options.id == "vinAlreadyExistForDifferentSeller"){
				    content += "The VIN you provided matches a "+ options.vehicle +" that is already in our system under an existing account. You will need to log in to that account to view its status.";
					this.setCurrentOpenModelAnswer(options.response);
				}
				if(options.id == "publisherVinAlreadyExistAsAccepted"){
				   	content += "The VIN you provided matches a "+ options.vehicle +" that is already in our system under an existing account. Contact <a href='javascript:com.site.Util.openHelpInWindow()'>support</a> for assistance.";					
					this.setCurrentOpenModelAnswer(options.response);
				}
				if(options.id == "publisherVehicleAlreadyExistAsAccepted"){
				   	content += "We noticed that this seller has already listed or accepted an offer on a "+ options.vehicle +". Contact <a href='javascript:com.site.Util.openHelpInWindow()'>support</a> for assistance.";
					this.setCurrentOpenModelAnswer(options.response);
				}				
				if(options.id == "canSign"){
					content = "Visit our "+ options.link +" for answers on document questions.";
				}
				if(options.id == "title"){
					content = "Need help getting a title? See our "+ options.link +".";
				}
				if(options.id == "noTitleNoOffer"){
					content = "Without a title we are unable to make an offer on your car. For more information on obtaining a title, you can visit our " + options.link + ".";
				}
				// If offer changed the show changed offer.
				if(options.id == "offerChangeOnVehicleUpdate"){
					if(options.offer > 0) {
						content += options.offerText;
					}
					else
					{
					    title = "Listing option available";
						content = "While we don't currently have an offer for you to sell your car instantly, you can still list your car for sale and we'll promote it to our buyer network! Set your asking price, upload a few photos, and we'll get to work on getting your car sold.";	
					}
				}				
                
				// If its initial offer show initial offer for normal seller for agent view it will have boolean modal - PED-6983.
				if(options.id == "initialOffer"){
					if(options.offer > 0) {
						content += options.offerText;
						content += "<br /> Select continue to provide condition details and view the final offer amounts.";					
					}
					else
					{
					    title = "No offer available";
					    content += "Unfortunately, we cannot make an offer on the vehicle at this time. If you'd like to be notified when we are able to make an offer, continue on to provide condition details.";
						// For No offer in initial offer push page Change content text.
						if(!!options.buttonText){
							this.setModalButtonText(options.buttonText);
							content = "Unfortunately, we cannot make an offer on the vehicle at this time.";
						}
					}
				}	

				if(options.id == "addPhotosModal"){
					
					title = options.title;
					
					content += "<div class='clearfix add-photos-modal-container' data-type='"+options.type+"'>";
						content += "<div class='col-md-7 text-col'>"+options.text+"</div>";
						content += "<div class='col-md-5 img-col'><div class='add-photos-img-container'><img class='img-responsive' src='"+options.img+"'></div></div>";
					content += "</div>";
				}
				
				// If offer changed the show changed offer
				if(options.id == "offerChanged"){
					if(options.offer > 0) {
					    content += "We said our offers change fast! Yours just changed to: " + options.offerText;
					}
					else
					{
						title = "Listing option available";
						content = "While we don't currently have an offer for you to sell your car instantly, you can still list your car for sale and we'll promote it to our buyer network! Set your asking price, upload a few photos, and we'll get to work on getting your car sold.";
					}
				}
				
				// If offer changed due to removed seller drop off PED-7785
				if(options.id == "dropOffRemoved"){
					if(!!options.offer && options.offer > 0) {
					    content += "Your new offer is " + options.offerText + ".";
					}					
					else if(options.offer === 0)
					{
						content += "Listing option available <br/>";
						content += "While we don't currently have an offer for you to sell your car instantly, you can still list your car for sale and we'll promote it to our buyer network! Set your asking price, upload a few photos, and we'll get to work on getting your car sold.";
					}
					else if(options.offer == "")
					{
						content = "";	
					}
				}
				
				if(options.id == "duplicateVIN"){
					if(options.isSellerOwnClaim) {
						content = "An offer on this vehicle has already been accepted from this account. If you meant to accept an offer on a different vehicle, double check the vehicle details and try again. Otherwise, continue to be brought to the pre-existing offer.";
						content += options.link;
					}
					else {
						content = "It looks like an offer on this vehicle has already been accepted. Double check the vehicle details and try again. If they are correct, you may have already accepted an offer on this vehicle. Log into your account to view its status.";
						content += options.link;
					}
				}
				
				if(options.id == "maximumAskingPriceUpdateModal") {
					if(!!options.offer && options.offer > 0) {
					    title += "Your asking price has been adjusted to the new maximum amount of " + options.offerText + ".";
					}		
				}
								
				if(options.id == "successfulAcceptOffer" && !!options.content){
					content = options.content;
					if(!!options.title){
						title = options.title;
					}
				}
				
                this.setModalTitle(title);
                this.setModalContent(content);
            }
			
			
			}
			catch(e){
				
			}
        }
		
		com.site.Modal.attachAllModalsEvent("infoPopUp");
        $('#infoPopUp').modal('show');
        this.AttachInfoModalCloseEvent();
		// On open of modal keep focus on close to support key navigation PED-10444.
		// Timeout is kept to fix PED-11452
		setTimeout(function() {
			$("#infoPopUp .close").focus();
		},100);
    },
	closeModal: function () {
        $('#infoPopUp').modal('hide');
    },
	getCurrentOpenModelData: function () {
        return {
            id: this.getCurrentOpenModel(),
			modalAnswer : this.getCurrentOpenModelAnswer(),
			postCloseActionRequired : this.getCurrentOpenModelCloseActionRequired()
        };
    },
	AttachInfoModalCloseEvent: function () {
        var self = this;
		$('#infoPopUp').off('hide.bs.modal');
        $('#infoPopUp').on('hide.bs.modal', function (e)
        {
            self.setCancelButtonAction(self.getCurrentOpenModelData);
        });
    },
	AttachModalEvents: function () {
        var self = this;
        var flag = false;

		// Hover state for mobile device
		$('#infoPopUpButton').bind('touchstart touchend', function(e) {
			$(this).toggleClass('buttonTapClass');
		});
		
        $('#infoPopUpButton').on('tap click', function (event)
        {
            if (!flag)
            {
                flag = true;
                setTimeout(function () { flag = false; }, 100);
                // do something
				self.setCurrentOpenModelCloseActionRequired(false);
				self.setSuccessButtonAction(self.getCurrentOpenModelData);
				if(!!self.getCurrentOpenModel()) {
					self.closeModal();
				}
                return false;
            }

            return false;
        });
		
		// Init key navigation for infoPopUp modal.
		if(!jQuery.browser.mobile) {
			com.site.Util.initKeyNavigationPlugin("#infoPopUp");
		}
    }
};

// Properties related to modal having boolean answer.
com.site.Modal.BooleanPopUpModalProperty =
	[
		{
		    title: "An account already exists", 
		    id: "accountAlreadyExist",
		    content: "An account already exists for the email address:",
		    leftButtonText: "Oops, re-enter info",
		    rightButtonText: "Log into account",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Similar offer found", 
		    id: "vehicleAlreadyExistAsAccepted",
		    content: "",
		    leftButtonText: "Yes",
		    rightButtonText: "No",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Already logged in", 
		    id: "alreadyLoginAgentAsSeller",
		    content: "",
		    leftButtonText: "Yes",
		    rightButtonText: "No",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Confirm your mileage", 
		    id: "mileageConfirmation",
		    content: "",
		    leftButtonText: "Yes",
		    rightButtonText: "No",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Your new offer", 
		    id: "noTitleRequirement",
		    content: "",
		    leftButtonText: "Yes",
		    rightButtonText: "No",
			modalAnswer : "",
			postCloseActionRequired: true
		},
		{
		    title: "Available offers", 
		    id: "initialOffer",
		    content: "",
			leftButtonText: "Send as SMS",
		    rightButtonText: "Continue",
			postCloseActionRequired: true
		}
	];
	
// Control functions related to modal having boolean answer.
com.site.Modal.BooleanPopUpModalControl = function (init) {
	this.setLeftButtonAction = init.setLeftButtonAction;
	this.setRightButtonAction = init.setRightButtonAction;
	this.setCancelButtonAction = init.setCancelButtonAction;
	this.modalInfoId = com.site.Modal.BooleanPopUpModalProperty;
	this.currentOpenModelId = "";
	this.AttachModalEvents();
};

com.site.Modal.BooleanPopUpModalControl.prototype = {
	setCurrentOpenModel: function (value){
        this.currentOpenModelId = value;
    },
    getCurrentOpenModel: function () {
        return this.currentOpenModelId;
    },
	getCurrentOpenModelAnswer: function () {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                return this.modalInfoId[index].modalAnswer;
            }
        }
        return "";
    },
	setCurrentOpenModelAnswer: function (answer) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                this.modalInfoId[index].modalAnswer = answer;
				break;
            }
        }
    },
	getCurrentOpenModelCloseActionRequired: function () {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                return this.modalInfoId[index].postCloseActionRequired;
            }
        }
        return true;
    },
	setCurrentOpenModelCloseActionRequired: function (answer) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == this.getCurrentOpenModel())
            {
                this.modalInfoId[index].postCloseActionRequired = answer;
				break;
            }
        }
    },
	setModalTitle: function (val) {
        $("#BooleanPopUpTitle").html(val);
    },
	setModalContent: function (val) {
        $("#BooleanPopUpBody").html(val);
    },
	setModalLeftButtonText: function (val){
        $("#BooleanPopUpLeftButton").html(val);
    },
	setModalRightButtonText: function (val) {
        $("#BooleanPopUpRightButton").html(val);
    },
	openModal: function (options) {
        for (var index = 0; index < this.modalInfoId.length; index++)
        {
            if (this.modalInfoId[index].id == options.id)
            {
				var content = this.modalInfoId[index].content;
				var rightButtonText = this.modalInfoId[index].rightButtonText;
				this.setCurrentOpenModel(this.modalInfoId[index].id);
				this.setCurrentOpenModelAnswer("");						// reset on open
				this.setCurrentOpenModelCloseActionRequired(true);		// reset on open
				
				// If already exist account show email in content. 
				if(options.id == "accountAlreadyExist"){
					content += " " + options.email;
				}			
				// If already exist vehicle, show vehicle in content. 				
				if(options.id == "vehicleAlreadyExistAsAccepted"){
				    content += "We noticed that you've already accepted an offer on a " + options.vehicle + ". Would you like to continue with this new offer on a similar but unique vehicle? If no, we'll bring you to the previous offer.";
					this.setCurrentOpenModelAnswer(options.response);
				}
				// If already logged in as seller show seller name.
				if(options.id == "alreadyLoginAgentAsSeller") {
					content += "Is this offer for " +options.sellerName + "?";
				}	
				// If already logged in as seller show seller name.
				if(options.id == "mileageConfirmation") {
					var milesText = options.ActualMileage > 1 ? " miles" : " mile";
					options.ActualMileage = com.site.Util.add_commas(com.site.Util.removeLeadingZero(options.ActualMileage));
				    content += "The average mileage for a car made in " + options.Year + " is " + options.AvgMileage + " miles. Are you sure the mileage is " + options.ActualMileage + milesText + "?";
				}
                
				if(options.id == "noTitleRequirement"){
					content += options.offerText;
					this.modalInfoId[index].title = options.title;
				}
				
				// If its initial offer show initial offer for agent with two buttons in modal, one to send SMS and other to continue PED-6983.
				if(options.id == "initialOffer"){
					if(options.offer > 0) {
						content += options.offerText;
						content += "<br /> Select continue to provide condition details and view the final offer amounts.";					
					}
					else
					{
					    title = "No offer available";
					    content += "Unfortunately, we cannot make an offer on the vehicle at this time. If you'd like to be notified when we are able to make an offer, continue on to provide condition details.";
					}
				}		
				
                this.setModalTitle(this.modalInfoId[index].title);
                this.setModalContent(content);
				this.setModalLeftButtonText(this.modalInfoId[index].leftButtonText);
				this.setModalRightButtonText(rightButtonText);
            }
			
			
        }
		
		com.site.Modal.attachAllModalsEvent("BooleanPopUp");
        $('#BooleanPopUp').modal('show');
        //this.AttachBooleanModalCloseEvent();
		// On open of modal keep focus on close to support key navigation PED-10444.
		$("#BooleanPopUp .close").focus();
    },
	closeModal: function () {
        $('#BooleanPopUp').modal('hide');
    },
	getCurrentOpenModelData: function () {
        return {
            id: this.getCurrentOpenModel(),
			modalAnswer : this.getCurrentOpenModelAnswer(),
			postCloseActionRequired : this.getCurrentOpenModelCloseActionRequired()
        };
    },
	AttachBooleanModalCloseEvent: function () {
        var self = this;
		$('#BooleanPopUp').off('hide.bs.modal');
        $('#BooleanPopUp').on('hide.bs.modal', function (e)
        {
            self.setCancelButtonAction(self.getCurrentOpenModelData);
        });
    },
	AttachModalEvents: function () {
        var self = this;
        var flag = false;

		// Hover state for mobile device
		$('#BooleanPopUpLeftButton, #BooleanPopUpRightButton').bind('touchstart touchend', function(e) {
			$(this).toggleClass('buttonTapClass');
		});
		
        $('#BooleanPopUpLeftButton').on('tap click', function (event)
        {
            if (!flag)
            {
                flag = true;
                setTimeout(function () { flag = false; }, 100);
                // do something
				self.setCurrentOpenModelCloseActionRequired(false);
				self.setLeftButtonAction(self.getCurrentOpenModelData);
				self.AttachBooleanModalCloseEvent();
				self.closeModal();
                return false;
            }

            return false;
        });
		
		$('#BooleanPopUpRightButton').on('tap click', function (event)
        {
            if (!flag)
            {
                flag = true;
                setTimeout(function () { flag = false; }, 100);
                // do something
				self.setCurrentOpenModelCloseActionRequired(false);
				self.setRightButtonAction(self.getCurrentOpenModelData);
				self.AttachBooleanModalCloseEvent();
				self.closeModal();
                return false;
            }

            return false;
        });

		// Init key navigation for BooleanPopUp modal.
		if(!jQuery.browser.mobile) {
			com.site.Util.initKeyNavigationPlugin("#BooleanPopUp");
		}
    }
};

com.site.Modal.attatchRatingSupport = function() {
    $('.starRating img').on('mouseover', function() {
        var prev = $(this);
        while (prev.length != 0) {
            prev.attr('src', 'Images/AcceptOffer/StarOn.png');
            prev = prev.prev();
        }
    });

    $('.starRating img').on('mouseout', function() {
        var prev = $(this);
        while (prev.length != 0 && !prev.hasClass('filled')) {
            prev.attr('src', 'Images/AcceptOffer/StarOff.png');
            prev = prev.prev();
        }
    });

    $('#peddleRate.starRating img, #declineRating.starRating img').on('click', function () {
        $(this).siblings().removeClass('filled');
        $(this).siblings().attr('src', 'Images/AcceptOffer/StarOff.png');
        var prev = $(this);
        while (prev.length != 0) {
            prev.attr('src', 'Images/AcceptOffer/StarOn.png');
            prev.addClass('filled');
            prev = prev.prev();
        }
    });
};

com.site.Modal.initMessageLengthCount = function(){
	// Initiate rate offer pop-up message field's character remaining function.
	$("#rateOfferMessageTextContainer textarea").show_char_limit(com.site.Config.MaxMessageLength, {
		status_element: '#rateOfferMessageTextContainer .charactersRemainingText'
	});
	// Initiate invite friend pop-up message field's character remaining function.
	$("#inviteFriendMessageTextContainer textarea").show_char_limit(com.site.Config.MaxMessageLength, {
		status_element: '#inviteFriendMessageTextContainer .charactersRemainingText'
	});
};

com.site.Modal.resetMessageLengthCount = function(){
	$("#feedBackOnDecline, #rateOfferMessage, #inviteFriendMessage").val("");
	$("#rateOfferMessageTextContainer textarea, #inviteFriendMessageTextContainer textarea").trigger('showLimit');  // manually trigger
};

com.site.Modal.attachEventOnMessage = function(){
	$("#feedBackOnDecline, #rateOfferMessage, #inviteFriendMessage").bind({
		keypress: function() {
			var _this = this;
			setTimeout(function() {
				com.site.Modal.checkMessageField(_this.id);
			},0,_this);
		},
		keydown: function() {
			var _this = this;
			setTimeout(function() {
				com.site.Modal.checkMessageField(_this.id);
			},0,_this);
		},
		paste:function() {
			var _this = this;
			setTimeout(function() {
				com.site.Modal.checkMessageField(_this.id);
				$("#"+ _this.id +"TextContainer textarea").trigger('showLimit');  // manually trigger on paste
			},50,_this);
		}
	});
};

com.site.Modal.ValidateMessageField = function(textId){
	var message = $("#"+textId).val();
	$("#"+textId).val(com.site.Modal.setValidMessageLength(message));
};

com.site.Modal.checkMessageField = function(textId){
	var message = $("#"+textId).val();
	if(message.length > com.site.Config.MaxMessageLength)
	{
		com.site.Modal.ValidateMessageField(textId);
	}
};

com.site.Modal.setValidMessageLength = function(message){
	if(message.length > com.site.Config.MaxMessageLength)
	{
		message = message.substring(0,com.site.Config.MaxMessageLength);
	}
	return message;
};

com.site.Modal.attachAllModalsEvent = function(id) {
	$('#'+id).on('hidden.bs.modal', function (e) {
		com.site.Modal.checkAndSetScrollablePopup(this.id);
	});
	
	$('#'+id).on('shown.bs.modal', function (e) {
		com.site.Modal.checkAndSetScrollablePopup(this.id);
	});
	
};

$(document).ready(function () {
    //checkAndAddForNativeScrollSupport();
    com.site.Modal.attatchRatingSupport();
	com.site.Modal.initMessageLengthCount();
	com.site.Modal.attachEventOnMessage();
});;

// Create the global symbol "com" if it doesn't exist
// Throw an error if it does exist but is not an object
var com;
if (!com) com = {};
else if (typeof com != "object")
    throw new Error("com already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site) com.site = {}
else if (typeof com.site != "object")
    throw new Error("com.site already exists and is not an object");

// Repeat the creation and type-checking code for the next level
if (!com.site.Menu) com.site.Menu = {}
else if (typeof com.site.Menu != "object")
    throw new Error("com.site.Menu already exists and is not an object");
	
	

com.site.Menu.getPublisherDetail = function(publisherIdFromCookieValue, publisherViewId) {

	var postDataObj = {
        publisherIdFromCookie : publisherIdFromCookieValue,
		publisherId : publisherViewId
    };
	com.site.DataService.getPublisherDetail(postDataObj, com.site.Menu.getPublisherDetailCallback);
};

com.site.Menu.getPublisherDetailCallback = function(response) {
	var publisherDetailData = response;
	if (publisherDetailData.Success == true && publisherDetailData.TrackingPhoneNumber) {
		
		var publisherTrackingPhoneNumber = publisherDetailData.TrackingPhoneNumber;
		publisherTrackingPhoneNumber = publisherTrackingPhoneNumber.substr(publisherTrackingPhoneNumber.length - 10);
		publisherTrackingPhoneNumber = com.site.Util.formatPhoneNumber(publisherTrackingPhoneNumber);
		// Set tracking phone number every where
		com.site.Config.PhoneNumber = publisherTrackingPhoneNumber;
		$(".phoneNumberText").text(publisherTrackingPhoneNumber);
		$(".phoneLink").attr("href","tel:" + publisherTrackingPhoneNumber);
		// Show phone number 
		$(".phoneLink").removeClass("hidden");
		$('.headerPopover').tooltipster('content', $('#HeaderSupportMenu').html());
	}
	else
	{
		// Hide phone number 
		$(".phoneLink").addClass("hidden");
		$('.headerPopover').tooltipster('content', $('#HeaderSupportMenu').html());

	}
	
	// PED-18562 track first touch attribution.
	if (publisherDetailData.Success == true && !!publisherDetailData.PublisherId && !com.site.Util.isVisitorsCookieSet()){
		
		com.site.Util.setVisitorsCookie(publisherDetailData.PublisherId);		
	}
	else if(!com.site.Util.isVisitorsCookieSet()){
		com.site.Util.setVisitorsCookie("peddle");
	}
	
};

com.site.Menu.checkForPubliserIdAvailability = function(publisherIdFromOfferOrClaim){
	var publisherIdFromCookie = com.site.Util.getCookie("Publisher");
	
	// PED-7096 : Reset publisher Id from cookie if admin or offer agent is viewing.
	if($("#publisherViewId").length == 0 && $("#adminUser").val() != ""){
		publisherIdFromCookie = "";  
	}
	
	if(($("#publisherViewId").length != 0 && $("#publisherViewId").val() != "") || !!publisherIdFromCookie || !!publisherIdFromOfferOrClaim) {
		var publisherViewId = $("#publisherViewId").length > 0 ? $("#publisherViewId").val() : "";
		
		// If publisher Id is available from offer or claim then give it preference.
		var pubId = !!publisherIdFromOfferOrClaim ? publisherIdFromOfferOrClaim : publisherViewId;
		
		com.site.Menu.getPublisherDetail(publisherIdFromCookie, pubId);
	}
	else{
		
		// PED-18562 track first touch attribution.
		if(!com.site.Util.isVisitorsCookieSet()){
			com.site.Util.setVisitorsCookie("peddle");
		}
		
		if(!!com.site.Config.isPhoneNumberAvailable && com.site.Config.isPhoneNumberAvailable) {
			// Show phone number 
			$(".phoneLink").removeClass("hidden");
			$('.headerPopover').tooltipster('content', $('#HeaderSupportMenu').html());
		}
	}
};




$(function(){
	$('#menu').show();  // This is to make visible hidden menu after page load.
	$('#menu').mmenu({
		classes: "mm-peddle",
		position:'right',
		zposition:'back',
		searchfield: true
	}).on(
	"open.mm",
		function(){

		}
	).on(
	"close.mm",
		function(){

		}
	);

});

/*Init tooltip for menu */

$(document).ready(function () {

    var triggerType = '';
    if (com.site.Util.isIEMobile()) {
        triggerType = 'click';
    } else {
        triggerType = 'hover';
    }
    $('.headerPopover').tooltipster({
        content: $('#HeaderSupportMenu').html(),
        contentAsHTML: true,
        interactive: true,
        theme: 'my-custom-theme',
        trigger: triggerType,
        offsetY: -5,
		functionReady: function () {
			var flag = false;
			$(".popupMenu li").on("click tap", function () {
				if (!flag) {
					flag = true;
					setTimeout(function () { flag = false; }, 100);
					// do something
					$('.headerPopover').tooltipster('hide');  // After copying hide tool-tip					
				}
			});
        }
    });

    /* Android fix for header menu */
    $('.headerPopoverFix').tooltipster({
        content: "",
        contentAsHTML: false,
        interactive: false,
        trigger: triggerType,
        theme: '111',
		functionReady: function () {
			var flag = false;
			$(".popupMenu li").on("click tap", function () {
				if (!flag) {
					flag = true;
					setTimeout(function () { flag = false; }, 100);
					// do something
					$('.headerPopover').tooltipster('hide');  // After copying hide tool-tip
				}
			});
        }
    });
	
	// popup for post login on hover of user name.
	$('.postLoginUserPopover').tooltipster({
        content: $('#LoggedInAccountMenu').html(),
        contentAsHTML: true,
        interactive: true,
        theme: 'my-custom-theme',
        trigger: triggerType,
        offsetY: -5,
		functionReady: function () {
			
			var flag = false;
			$(".popupMenu li").on("click tap", function () {
				if (!flag) {
					flag = true;
					setTimeout(function () { flag = false; }, 100);
					// do something
					$('.postLoginUserPopover').tooltipster('hide');  // After copying hide tool-tip
				}
			});
        }
    });
	
	// Hover state for mobile device
	$('.panelList.mm-list li a').bind('touchstart touchend', function(e) {
		$(this).toggleClass('mmListHover');
	});
		
});
;
